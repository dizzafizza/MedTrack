var En=Object.defineProperty;var Tn=(s,a,t)=>a in s?En(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var ua=(s,a,t)=>(Tn(s,typeof a!="symbol"?a+"":a,t),t);import{r as q,a as In,b as Fn,g as Ln,R as I}from"./vendor-fdd35676.js";import{i as qt,f as Ie,a as Ut,t as $n,c as qn,b as Ks,s as ha,e as xa,d as st,g as Un,h as as}from"./utils-99daa730.js";import{R as cs,L as ga,C as Dt,X as Ct,Y as St,T as ds,a as Rt,P as Mt,b as Pt,c as zn,B as On,d as _n}from"./charts-863a9ef8.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Ba={exports:{}},ut={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vn=q,Wn=Symbol.for("react.element"),Bn=Symbol.for("react.fragment"),Hn=Object.prototype.hasOwnProperty,Yn=Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gn={key:!0,ref:!0,__self:!0,__source:!0};function Ha(s,a,t){var n,r={},i=null,l=null;t!==void 0&&(i=""+t),a.key!==void 0&&(i=""+a.key),a.ref!==void 0&&(l=a.ref);for(n in a)Hn.call(a,n)&&!Gn.hasOwnProperty(n)&&(r[n]=a[n]);if(s&&s.defaultProps)for(n in a=s.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:Wn,type:s,key:i,ref:l,props:r,_owner:Yn.current}}ut.Fragment=Bn;ut.jsx=Ha;ut.jsxs=Ha;Ba.exports=ut;var e=Ba.exports,zt={},pa=In;zt.createRoot=pa.createRoot,zt.hydrateRoot=pa.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ts(){return Ts=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Ts.apply(this,arguments)}var Ge;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Ge||(Ge={}));const fa="popstate";function Kn(s){s===void 0&&(s={});function a(r,i){let{pathname:l="/",search:o="",hash:c=""}=os(r.location.hash.substr(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),Ot("",{pathname:l,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){let l=r.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let c=r.location.href,d=c.indexOf("#");o=d===-1?c:c.slice(0,d)}return o+"#"+(typeof i=="string"?i:tt(i))}function n(r,i){Zt(r.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return Zn(a,t,n,s)}function re(s,a){if(s===!1||s===null||typeof s>"u")throw new Error(a)}function Zt(s,a){if(!s){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function Jn(){return Math.random().toString(36).substr(2,8)}function ya(s,a){return{usr:s.state,key:s.key,idx:a}}function Ot(s,a,t,n){return t===void 0&&(t=null),Ts({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof a=="string"?os(a):a,{state:t,key:a&&a.key||n||Jn()})}function tt(s){let{pathname:a="/",search:t="",hash:n=""}=s;return t&&t!=="?"&&(a+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(a+=n.charAt(0)==="#"?n:"#"+n),a}function os(s){let a={};if(s){let t=s.indexOf("#");t>=0&&(a.hash=s.substr(t),s=s.substr(0,t));let n=s.indexOf("?");n>=0&&(a.search=s.substr(n),s=s.substr(0,n)),s&&(a.pathname=s)}return a}function Zn(s,a,t,n){n===void 0&&(n={});let{window:r=document.defaultView,v5Compat:i=!1}=n,l=r.history,o=Ge.Pop,c=null,d=m();d==null&&(d=0,l.replaceState(Ts({},l.state,{idx:d}),""));function m(){return(l.state||{idx:null}).idx}function x(){o=Ge.Pop;let v=m(),g=v==null?null:v-d;d=v,c&&c({action:o,location:S.location,delta:g})}function y(v,g){o=Ge.Push;let u=Ot(S.location,v,g);t&&t(u,v),d=m()+1;let f=ya(u,d),b=S.createHref(u);try{l.pushState(f,"",b)}catch(h){if(h instanceof DOMException&&h.name==="DataCloneError")throw h;r.location.assign(b)}i&&c&&c({action:o,location:S.location,delta:1})}function R(v,g){o=Ge.Replace;let u=Ot(S.location,v,g);t&&t(u,v),d=m();let f=ya(u,d),b=S.createHref(u);l.replaceState(f,"",b),i&&c&&c({action:o,location:S.location,delta:0})}function k(v){let g=r.location.origin!=="null"?r.location.origin:r.location.href,u=typeof v=="string"?v:tt(v);return u=u.replace(/ $/,"%20"),re(g,"No window.location.(origin|href) available to create URL for href: "+u),new URL(u,g)}let S={get action(){return o},get location(){return s(r,l)},listen(v){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(fa,x),c=v,()=>{r.removeEventListener(fa,x),c=null}},createHref(v){return a(r,v)},createURL:k,encodeLocation(v){let g=k(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:y,replace:R,go(v){return l.go(v)}};return S}var va;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(va||(va={}));function Qn(s,a,t){return t===void 0&&(t="/"),Xn(s,a,t,!1)}function Xn(s,a,t,n){let r=typeof a=="string"?os(a):a,i=ps(r.pathname||"/",t);if(i==null)return null;let l=Ya(s);ei(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=mi(i);o=ci(l[c],d,n)}return o}function Ya(s,a,t,n){a===void 0&&(a=[]),t===void 0&&(t=[]),n===void 0&&(n="");let r=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(re(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Ke([n,c.relativePath]),m=t.concat(c);i.children&&i.children.length>0&&(re(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Ya(i.children,a,m,d)),!(i.path==null&&!i.index)&&a.push({path:d,score:li(d,i.index),routesMeta:m})};return s.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))r(i,l);else for(let c of Ga(i.path))r(i,l,c)}),a}function Ga(s){let a=s.split("/");if(a.length===0)return[];let[t,...n]=a,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return r?[i,""]:[i];let l=Ga(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),r&&o.push(...l),o.map(c=>s.startsWith("/")&&c===""?"/":c)}function ei(s){s.sort((a,t)=>a.score!==t.score?t.score-a.score:oi(a.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const si=/^:[\w-]+$/,ti=3,ai=2,ni=1,ii=10,ri=-2,ba=s=>s==="*";function li(s,a){let t=s.split("/"),n=t.length;return t.some(ba)&&(n+=ri),a&&(n+=ai),t.filter(r=>!ba(r)).reduce((r,i)=>r+(si.test(i)?ti:i===""?ni:ii),n)}function oi(s,a){return s.length===a.length&&s.slice(0,-1).every((n,r)=>n===a[r])?s[s.length-1]-a[a.length-1]:0}function ci(s,a,t){t===void 0&&(t=!1);let{routesMeta:n}=s,r={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,m=i==="/"?a:a.slice(i.length)||"/",x=at({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},m),y=c.route;if(!x&&d&&t&&!n[n.length-1].route.index&&(x=at({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},m)),!x)return null;Object.assign(r,x.params),l.push({params:r,pathname:Ke([i,x.pathname]),pathnameBase:gi(Ke([i,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(i=Ke([i,x.pathnameBase]))}return l}function at(s,a){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=di(s.path,s.caseSensitive,s.end),r=a.match(t);if(!r)return null;let i=r[0],l=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:n.reduce((d,m,x)=>{let{paramName:y,isOptional:R}=m;if(y==="*"){let S=o[x]||"";l=i.slice(0,i.length-S.length).replace(/(.)\/+$/,"$1")}const k=o[x];return R&&!k?d[y]=void 0:d[y]=(k||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:s}}function di(s,a,t){a===void 0&&(a=!1),t===void 0&&(t=!0),Zt(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let n=[],r="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),r+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":s!==""&&s!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,a?void 0:"i"),n]}function mi(s){try{return s.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Zt(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),s}}function ps(s,a){if(a==="/")return s;if(!s.toLowerCase().startsWith(a.toLowerCase()))return null;let t=a.endsWith("/")?a.length-1:a.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}function ui(s,a){a===void 0&&(a="/");let{pathname:t,search:n="",hash:r=""}=typeof s=="string"?os(s):s;return{pathname:t?t.startsWith("/")?t:hi(t,a):a,search:pi(n),hash:fi(r)}}function hi(s,a){let t=a.replace(/\/+$/,"").split("/");return s.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function At(s,a,t,n){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xi(s){return s.filter((a,t)=>t===0||a.route.path&&a.route.path.length>0)}function Qt(s,a){let t=xi(s);return a?t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function Xt(s,a,t,n){n===void 0&&(n=!1);let r;typeof s=="string"?r=os(s):(r=Ts({},s),re(!r.pathname||!r.pathname.includes("?"),At("?","pathname","search",r)),re(!r.pathname||!r.pathname.includes("#"),At("#","pathname","hash",r)),re(!r.search||!r.search.includes("#"),At("#","search","hash",r)));let i=s===""||r.pathname==="",l=i?"/":r.pathname,o;if(l==null)o=t;else{let x=a.length-1;if(!n&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),x-=1;r.pathname=y.join("/")}o=x>=0?a[x]:"/"}let c=ui(r,o),d=l&&l!=="/"&&l.endsWith("/"),m=(i||l===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||m)&&(c.pathname+="/"),c}const Ke=s=>s.join("/").replace(/\/\/+/g,"/"),gi=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),pi=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,fi=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function yi(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const Ka=["post","put","patch","delete"];new Set(Ka);const vi=["get",...Ka];new Set(vi);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Is(){return Is=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Is.apply(this,arguments)}const ht=q.createContext(null),Ja=q.createContext(null),We=q.createContext(null),xt=q.createContext(null),Xe=q.createContext({outlet:null,matches:[],isDataRoute:!1}),Za=q.createContext(null);function bi(s,a){let{relative:t}=a===void 0?{}:a;js()||re(!1);let{basename:n,navigator:r}=q.useContext(We),{hash:i,pathname:l,search:o}=gt(s,{relative:t}),c=l;return n!=="/"&&(c=l==="/"?n:Ke([n,l])),r.createHref({pathname:c,search:o,hash:i})}function js(){return q.useContext(xt)!=null}function Ns(){return js()||re(!1),q.useContext(xt).location}function Qa(s){q.useContext(We).static||q.useLayoutEffect(s)}function Xa(){let{isDataRoute:s}=q.useContext(Xe);return s?Ti():ji()}function ji(){js()||re(!1);let s=q.useContext(ht),{basename:a,future:t,navigator:n}=q.useContext(We),{matches:r}=q.useContext(Xe),{pathname:i}=Ns(),l=JSON.stringify(Qt(r,t.v7_relativeSplatPath)),o=q.useRef(!1);return Qa(()=>{o.current=!0}),q.useCallback(function(d,m){if(m===void 0&&(m={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let x=Xt(d,JSON.parse(l),i,m.relative==="path");s==null&&a!=="/"&&(x.pathname=x.pathname==="/"?a:Ke([a,x.pathname])),(m.replace?n.replace:n.push)(x,m.state,m)},[a,n,l,i,s])}function gt(s,a){let{relative:t}=a===void 0?{}:a,{future:n}=q.useContext(We),{matches:r}=q.useContext(Xe),{pathname:i}=Ns(),l=JSON.stringify(Qt(r,n.v7_relativeSplatPath));return q.useMemo(()=>Xt(s,JSON.parse(l),i,t==="path"),[s,l,i,t])}function Ni(s,a){return wi(s,a)}function wi(s,a,t,n){js()||re(!1);let{navigator:r}=q.useContext(We),{matches:i}=q.useContext(Xe),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=Ns(),m;if(a){var x;let v=typeof a=="string"?os(a):a;c==="/"||(x=v.pathname)!=null&&x.startsWith(c)||re(!1),m=v}else m=d;let y=m.pathname||"/",R=y;if(c!=="/"){let v=c.replace(/^\//,"").split("/");R="/"+y.replace(/^\//,"").split("/").slice(v.length).join("/")}let k=Qn(s,{pathname:R}),S=Ri(k&&k.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Ke([c,r.encodeLocation?r.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:Ke([c,r.encodeLocation?r.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,t,n);return a&&S?q.createElement(xt.Provider,{value:{location:Is({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Ge.Pop}},S):S}function ki(){let s=Ei(),a=yi(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},a),t?q.createElement("pre",{style:r},t):null,i)}const Di=q.createElement(ki,null);class Ci extends q.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,t){return t.location!==a.location||t.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:t.error,location:t.location,revalidation:a.revalidation||t.revalidation}}componentDidCatch(a,t){console.error("React Router caught the following error during render",a,t)}render(){return this.state.error!==void 0?q.createElement(Xe.Provider,{value:this.props.routeContext},q.createElement(Za.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Si(s){let{routeContext:a,match:t,children:n}=s,r=q.useContext(ht);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),q.createElement(Xe.Provider,{value:a},n)}function Ri(s,a,t,n){var r;if(a===void 0&&(a=[]),t===void 0&&(t=null),n===void 0&&(n=null),s==null){var i;if(!t)return null;if(t.errors)s=t.matches;else if((i=n)!=null&&i.v7_partialHydration&&a.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let l=s,o=(r=t)==null?void 0:r.errors;if(o!=null){let m=l.findIndex(x=>x.route.id&&(o==null?void 0:o[x.route.id])!==void 0);m>=0||re(!1),l=l.slice(0,Math.min(l.length,m+1))}let c=!1,d=-1;if(t&&n&&n.v7_partialHydration)for(let m=0;m<l.length;m++){let x=l[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(d=m),x.route.id){let{loaderData:y,errors:R}=t,k=x.route.loader&&y[x.route.id]===void 0&&(!R||R[x.route.id]===void 0);if(x.route.lazy||k){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((m,x,y)=>{let R,k=!1,S=null,v=null;t&&(R=o&&x.route.id?o[x.route.id]:void 0,S=x.route.errorElement||Di,c&&(d<0&&y===0?(Ii("route-fallback",!1),k=!0,v=null):d===y&&(k=!0,v=x.route.hydrateFallbackElement||null)));let g=a.concat(l.slice(0,y+1)),u=()=>{let f;return R?f=S:k?f=v:x.route.Component?f=q.createElement(x.route.Component,null):x.route.element?f=x.route.element:f=m,q.createElement(Si,{match:x,routeContext:{outlet:m,matches:g,isDataRoute:t!=null},children:f})};return t&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?q.createElement(Ci,{location:t.location,revalidation:t.revalidation,component:S,error:R,children:u(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):u()},null)}var en=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(en||{}),nt=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(nt||{});function Mi(s){let a=q.useContext(ht);return a||re(!1),a}function Pi(s){let a=q.useContext(Ja);return a||re(!1),a}function Ai(s){let a=q.useContext(Xe);return a||re(!1),a}function sn(s){let a=Ai(),t=a.matches[a.matches.length-1];return t.route.id||re(!1),t.route.id}function Ei(){var s;let a=q.useContext(Za),t=Pi(nt.UseRouteError),n=sn(nt.UseRouteError);return a!==void 0?a:(s=t.errors)==null?void 0:s[n]}function Ti(){let{router:s}=Mi(en.UseNavigateStable),a=sn(nt.UseNavigateStable),t=q.useRef(!1);return Qa(()=>{t.current=!0}),q.useCallback(function(r,i){i===void 0&&(i={}),t.current&&(typeof r=="number"?s.navigate(r):s.navigate(r,Is({fromRouteId:a},i)))},[s,a])}const ja={};function Ii(s,a,t){!a&&!ja[s]&&(ja[s]=!0)}function Fi(s,a){s==null||s.v7_startTransition,(s==null?void 0:s.v7_relativeSplatPath)===void 0&&(!a||a.v7_relativeSplatPath),a&&(a.v7_fetcherPersist,a.v7_normalizeFormMethod,a.v7_partialHydration,a.v7_skipActionErrorRevalidation)}function Na(s){let{to:a,replace:t,state:n,relative:r}=s;js()||re(!1);let{future:i,static:l}=q.useContext(We),{matches:o}=q.useContext(Xe),{pathname:c}=Ns(),d=Xa(),m=Xt(a,Qt(o,i.v7_relativeSplatPath),c,r==="path"),x=JSON.stringify(m);return q.useEffect(()=>d(JSON.parse(x),{replace:t,state:n,relative:r}),[d,x,r,t,n]),null}function De(s){re(!1)}function Li(s){let{basename:a="/",children:t=null,location:n,navigationType:r=Ge.Pop,navigator:i,static:l=!1,future:o}=s;js()&&re(!1);let c=a.replace(/^\/*/,"/"),d=q.useMemo(()=>({basename:c,navigator:i,static:l,future:Is({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=os(n));let{pathname:m="/",search:x="",hash:y="",state:R=null,key:k="default"}=n,S=q.useMemo(()=>{let v=ps(m,c);return v==null?null:{location:{pathname:v,search:x,hash:y,state:R,key:k},navigationType:r}},[c,m,x,y,R,k,r]);return S==null?null:q.createElement(We.Provider,{value:d},q.createElement(xt.Provider,{children:t,value:S}))}function $i(s){let{children:a,location:t}=s;return Ni(_t(a),t)}new Promise(()=>{});function _t(s,a){a===void 0&&(a=[]);let t=[];return q.Children.forEach(s,(n,r)=>{if(!q.isValidElement(n))return;let i=[...a,r];if(n.type===q.Fragment){t.push.apply(t,_t(n.props.children,i));return}n.type!==De&&re(!1),!n.props.index||!n.props.children||re(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=_t(n.props.children,i)),t.push(l)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function it(){return it=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},it.apply(this,arguments)}function tn(s,a){if(s==null)return{};var t={},n=Object.keys(s),r,i;for(i=0;i<n.length;i++)r=n[i],!(a.indexOf(r)>=0)&&(t[r]=s[r]);return t}function qi(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function Ui(s,a){return s.button===0&&(!a||a==="_self")&&!qi(s)}const zi=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Oi=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],_i="6";try{window.__reactRouterVersion=_i}catch{}const Vi=q.createContext({isTransitioning:!1}),Wi="startTransition",wa=Fn[Wi];function Bi(s){let{basename:a,children:t,future:n,window:r}=s,i=q.useRef();i.current==null&&(i.current=Kn({window:r,v5Compat:!0}));let l=i.current,[o,c]=q.useState({action:l.action,location:l.location}),{v7_startTransition:d}=n||{},m=q.useCallback(x=>{d&&wa?wa(()=>c(x)):c(x)},[c,d]);return q.useLayoutEffect(()=>l.listen(m),[l,m]),q.useEffect(()=>Fi(n),[n]),q.createElement(Li,{basename:a,children:t,location:o.location,navigationType:o.action,navigator:l,future:n})}const Hi=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Yi=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ns=q.forwardRef(function(a,t){let{onClick:n,relative:r,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:m,viewTransition:x}=a,y=tn(a,zi),{basename:R}=q.useContext(We),k,S=!1;if(typeof d=="string"&&Yi.test(d)&&(k=d,Hi))try{let f=new URL(window.location.href),b=d.startsWith("//")?new URL(f.protocol+d):new URL(d),h=ps(b.pathname,R);b.origin===f.origin&&h!=null?d=h+b.search+b.hash:S=!0}catch{}let v=bi(d,{relative:r}),g=Ji(d,{replace:l,state:o,target:c,preventScrollReset:m,relative:r,viewTransition:x});function u(f){n&&n(f),f.defaultPrevented||g(f)}return q.createElement("a",it({},y,{href:k||v,onClick:S||i?n:u,ref:t,target:c}))}),Gi=q.forwardRef(function(a,t){let{"aria-current":n="page",caseSensitive:r=!1,className:i="",end:l=!1,style:o,to:c,viewTransition:d,children:m}=a,x=tn(a,Oi),y=gt(c,{relative:x.relative}),R=Ns(),k=q.useContext(Ja),{navigator:S,basename:v}=q.useContext(We),g=k!=null&&Zi(y)&&d===!0,u=S.encodeLocation?S.encodeLocation(y).pathname:y.pathname,f=R.pathname,b=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;r||(f=f.toLowerCase(),b=b?b.toLowerCase():null,u=u.toLowerCase()),b&&v&&(b=ps(b,v)||b);const h=u!=="/"&&u.endsWith("/")?u.length-1:u.length;let j=f===u||!l&&f.startsWith(u)&&f.charAt(h)==="/",F=b!=null&&(b===u||!l&&b.startsWith(u)&&b.charAt(u.length)==="/"),P={isActive:j,isPending:F,isTransitioning:g},M=j?n:void 0,D;typeof i=="function"?D=i(P):D=[i,j?"active":null,F?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let T=typeof o=="function"?o(P):o;return q.createElement(ns,it({},x,{"aria-current":M,className:D,ref:t,style:T,to:c,viewTransition:d}),typeof m=="function"?m(P):m)});var Vt;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(Vt||(Vt={}));var ka;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(ka||(ka={}));function Ki(s){let a=q.useContext(ht);return a||re(!1),a}function Ji(s,a){let{target:t,replace:n,state:r,preventScrollReset:i,relative:l,viewTransition:o}=a===void 0?{}:a,c=Xa(),d=Ns(),m=gt(s,{relative:l});return q.useCallback(x=>{if(Ui(x,t)){x.preventDefault();let y=n!==void 0?n:tt(d)===tt(m);c(s,{replace:y,state:r,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,m,n,r,t,s,i,l,o])}function Zi(s,a){a===void 0&&(a={});let t=q.useContext(Vi);t==null&&re(!1);let{basename:n}=Ki(Vt.useViewTransitionState),r=gt(s,{relative:a.relative});if(!t.isTransitioning)return!1;let i=ps(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=ps(t.nextLocation.pathname,n)||t.nextLocation.pathname;return at(r.pathname,l)!=null||at(r.pathname,i)!=null}let Qi={data:""},Xi=s=>typeof window=="object"?((s?s.querySelector("#_goober"):window._goober)||Object.assign((s||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:s||Qi,er=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,sr=/\/\*[^]*?\*\/|  +/g,Da=/\n+/g,He=(s,a)=>{let t="",n="",r="";for(let i in s){let l=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+l+";":n+=i[1]=="f"?He(l,i):i+"{"+He(l,i[1]=="k"?"":a)+"}":typeof l=="object"?n+=He(l,a?a.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=He.p?He.p(i,l):i+":"+l+";")}return t+(a&&r?a+"{"+r+"}":r)+n},Ue={},an=s=>{if(typeof s=="object"){let a="";for(let t in s)a+=t+an(s[t]);return a}return s},tr=(s,a,t,n,r)=>{let i=an(s),l=Ue[i]||(Ue[i]=(c=>{let d=0,m=11;for(;d<c.length;)m=101*m+c.charCodeAt(d++)>>>0;return"go"+m})(i));if(!Ue[l]){let c=i!==s?s:(d=>{let m,x,y=[{}];for(;m=er.exec(d.replace(sr,""));)m[4]?y.shift():m[3]?(x=m[3].replace(Da," ").trim(),y.unshift(y[0][x]=y[0][x]||{})):y[0][m[1]]=m[2].replace(Da," ").trim();return y[0]})(s);Ue[l]=He(r?{["@keyframes "+l]:c}:c,t?"":"."+l)}let o=t&&Ue.g?Ue.g:null;return t&&(Ue.g=Ue[l]),((c,d,m,x)=>{x?d.data=d.data.replace(x,c):d.data.indexOf(c)===-1&&(d.data=m?c+d.data:d.data+c)})(Ue[l],a,n,o),l},ar=(s,a,t)=>s.reduce((n,r,i)=>{let l=a[i];if(l&&l.call){let o=l(t),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=c?"."+c:o&&typeof o=="object"?o.props?"":He(o,""):o===!1?"":o}return n+r+(l??"")},"");function pt(s){let a=this||{},t=s.call?s(a.p):s;return tr(t.unshift?t.raw?ar(t,[].slice.call(arguments,1),a.p):t.reduce((n,r)=>Object.assign(n,r&&r.call?r(a.p):r),{}):t,Xi(a.target),a.g,a.o,a.k)}let nn,Wt,Bt;pt.bind({g:1});let Ve=pt.bind({k:1});function nr(s,a,t,n){He.p=a,nn=s,Wt=t,Bt=n}function es(s,a){let t=this||{};return function(){let n=arguments;function r(i,l){let o=Object.assign({},i),c=o.className||r.className;t.p=Object.assign({theme:Wt&&Wt()},o),t.o=/ *go\d+/.test(c),o.className=pt.apply(t,n)+(c?" "+c:""),a&&(o.ref=l);let d=s;return s[0]&&(d=o.as||s,delete o.as),Bt&&d[0]&&Bt(o),nn(d,o)}return a?a(r):r}}var ir=s=>typeof s=="function",rt=(s,a)=>ir(s)?s(a):s,rr=(()=>{let s=0;return()=>(++s).toString()})(),rn=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let a=matchMedia("(prefers-reduced-motion: reduce)");s=!a||a.matches}return s}})(),lr=20,ea="default",ln=(s,a)=>{let{toastLimit:t}=s.settings;switch(a.type){case 0:return{...s,toasts:[a.toast,...s.toasts].slice(0,t)};case 1:return{...s,toasts:s.toasts.map(l=>l.id===a.toast.id?{...l,...a.toast}:l)};case 2:let{toast:n}=a;return ln(s,{type:s.toasts.find(l=>l.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=a;return{...s,toasts:s.toasts.map(l=>l.id===r||r===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(l=>l.id!==a.toastId)};case 5:return{...s,pausedAt:a.time};case 6:let i=a.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+i}))}}},Qs=[],on={toasts:[],pausedAt:void 0,settings:{toastLimit:lr}},Fe={},cn=(s,a=ea)=>{Fe[a]=ln(Fe[a]||on,s),Qs.forEach(([t,n])=>{t===a&&n(Fe[a])})},dn=s=>Object.keys(Fe).forEach(a=>cn(s,a)),or=s=>Object.keys(Fe).find(a=>Fe[a].toasts.some(t=>t.id===s)),ft=(s=ea)=>a=>{cn(a,s)},cr={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},dr=(s={},a=ea)=>{let[t,n]=q.useState(Fe[a]||on),r=q.useRef(Fe[a]);q.useEffect(()=>(r.current!==Fe[a]&&n(Fe[a]),Qs.push([a,n]),()=>{let l=Qs.findIndex(([o])=>o===a);l>-1&&Qs.splice(l,1)}),[a]);let i=t.toasts.map(l=>{var o,c,d;return{...s,...s[l.type],...l,removeDelay:l.removeDelay||((o=s[l.type])==null?void 0:o.removeDelay)||(s==null?void 0:s.removeDelay),duration:l.duration||((c=s[l.type])==null?void 0:c.duration)||(s==null?void 0:s.duration)||cr[l.type],style:{...s.style,...(d=s[l.type])==null?void 0:d.style,...l.style}}});return{...t,toasts:i}},mr=(s,a="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:a,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:(t==null?void 0:t.id)||rr()}),zs=s=>(a,t)=>{let n=mr(a,s,t);return ft(n.toasterId||or(n.id))({type:2,toast:n}),n.id},xe=(s,a)=>zs("blank")(s,a);xe.error=zs("error");xe.success=zs("success");xe.loading=zs("loading");xe.custom=zs("custom");xe.dismiss=(s,a)=>{let t={type:3,toastId:s};a?ft(a)(t):dn(t)};xe.dismissAll=s=>xe.dismiss(void 0,s);xe.remove=(s,a)=>{let t={type:4,toastId:s};a?ft(a)(t):dn(t)};xe.removeAll=s=>xe.remove(void 0,s);xe.promise=(s,a,t)=>{let n=xe.loading(a.loading,{...t,...t==null?void 0:t.loading});return typeof s=="function"&&(s=s()),s.then(r=>{let i=a.success?rt(a.success,r):void 0;return i?xe.success(i,{id:n,...t,...t==null?void 0:t.success}):xe.dismiss(n),r}).catch(r=>{let i=a.error?rt(a.error,r):void 0;i?xe.error(i,{id:n,...t,...t==null?void 0:t.error}):xe.dismiss(n)}),s};var ur=1e3,hr=(s,a="default")=>{let{toasts:t,pausedAt:n}=dr(s,a),r=q.useRef(new Map).current,i=q.useCallback((x,y=ur)=>{if(r.has(x))return;let R=setTimeout(()=>{r.delete(x),l({type:4,toastId:x})},y);r.set(x,R)},[]);q.useEffect(()=>{if(n)return;let x=Date.now(),y=t.map(R=>{if(R.duration===1/0)return;let k=(R.duration||0)+R.pauseDuration-(x-R.createdAt);if(k<0){R.visible&&xe.dismiss(R.id);return}return setTimeout(()=>xe.dismiss(R.id,a),k)});return()=>{y.forEach(R=>R&&clearTimeout(R))}},[t,n,a]);let l=q.useCallback(ft(a),[a]),o=q.useCallback(()=>{l({type:5,time:Date.now()})},[l]),c=q.useCallback((x,y)=>{l({type:1,toast:{id:x,height:y}})},[l]),d=q.useCallback(()=>{n&&l({type:6,time:Date.now()})},[n,l]),m=q.useCallback((x,y)=>{let{reverseOrder:R=!1,gutter:k=8,defaultPosition:S}=y||{},v=t.filter(f=>(f.position||S)===(x.position||S)&&f.height),g=v.findIndex(f=>f.id===x.id),u=v.filter((f,b)=>b<g&&f.visible).length;return v.filter(f=>f.visible).slice(...R?[u+1]:[0,u]).reduce((f,b)=>f+(b.height||0)+k,0)},[t]);return q.useEffect(()=>{t.forEach(x=>{if(x.dismissed)i(x.id,x.removeDelay);else{let y=r.get(x.id);y&&(clearTimeout(y),r.delete(x.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:c,startPause:o,endPause:d,calculateOffset:m}}},xr=Ve`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,gr=Ve`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,pr=Ve`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,fr=es("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${xr} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${gr} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${pr} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,yr=Ve`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,vr=es("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${yr} 1s linear infinite;
`,br=Ve`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,jr=Ve`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Nr=es("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${br} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${jr} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,wr=es("div")`
  position: absolute;
`,kr=es("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Dr=Ve`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Cr=es("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Dr} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Sr=({toast:s})=>{let{icon:a,type:t,iconTheme:n}=s;return a!==void 0?typeof a=="string"?q.createElement(Cr,null,a):a:t==="blank"?null:q.createElement(kr,null,q.createElement(vr,{...n}),t!=="loading"&&q.createElement(wr,null,t==="error"?q.createElement(fr,{...n}):q.createElement(Nr,{...n})))},Rr=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Mr=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,Pr="0%{opacity:0;} 100%{opacity:1;}",Ar="0%{opacity:1;} 100%{opacity:0;}",Er=es("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Tr=es("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Ir=(s,a)=>{let t=s.includes("top")?1:-1,[n,r]=rn()?[Pr,Ar]:[Rr(t),Mr(t)];return{animation:a?`${Ve(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ve(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Fr=q.memo(({toast:s,position:a,style:t,children:n})=>{let r=s.height?Ir(s.position||a||"top-center",s.visible):{opacity:0},i=q.createElement(Sr,{toast:s}),l=q.createElement(Tr,{...s.ariaProps},rt(s.message,s));return q.createElement(Er,{className:s.className,style:{...r,...t,...s.style}},typeof n=="function"?n({icon:i,message:l}):q.createElement(q.Fragment,null,i,l))});nr(q.createElement);var Lr=({id:s,className:a,style:t,onHeightUpdate:n,children:r})=>{let i=q.useCallback(l=>{if(l){let o=()=>{let c=l.getBoundingClientRect().height;n(s,c)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[s,n]);return q.createElement("div",{ref:i,className:a,style:t},r)},$r=(s,a)=>{let t=s.includes("top"),n=t?{top:0}:{bottom:0},r=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:rn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${a*(t?1:-1)}px)`,...n,...r}},qr=pt`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Js=16,Ur=({reverseOrder:s,position:a="top-center",toastOptions:t,gutter:n,children:r,toasterId:i,containerStyle:l,containerClassName:o})=>{let{toasts:c,handlers:d}=hr(t,i);return q.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Js,left:Js,right:Js,bottom:Js,pointerEvents:"none",...l},className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(m=>{let x=m.position||a,y=d.calculateOffset(m,{reverseOrder:s,gutter:n,defaultPosition:a}),R=$r(x,y);return q.createElement(Lr,{id:m.id,key:m.id,onHeightUpdate:d.updateHeight,className:m.visible?qr:"",style:R},m.type==="custom"?rt(m.message,m):r?r(m):q.createElement(Fr,{toast:m,position:x}))}))},J=xe,zr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Or=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Y=(s,a)=>{const t=q.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:o,...c},d)=>q.createElement("svg",{ref:d,...zr,width:r,height:r,stroke:n,strokeWidth:l?Number(i)*24/Number(r):i,className:`lucide lucide-${Or(s)}`,...c},[...a.map(([m,x])=>q.createElement(m,x)),...(Array.isArray(o)?o:[o])||[]]));return t.displayName=`${s}`,t},we=Y("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),xs=Y("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),X=Y("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),fs=Y("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),rs=Y("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Oe=Y("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),$e=Y("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ys=Y("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),_e=Y("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),sa=Y("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),_r=Y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Vr=Y("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ke=Y("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Et=Y("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),Wr=Y("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Je=Y("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),vs=Y("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Br=Y("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Qe=Y("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Hr=Y("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),mn=Y("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Yr=Y("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),Gr=Y("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Kr=Y("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Jr=Y("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Zr=Y("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),un=Y("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Qr=Y("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),gs=Y("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),ta=Y("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Xr=Y("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Pe=Y("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]),el=Y("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Ae=Y("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),sl=Y("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),aa=Y("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),na=Y("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Fs=Y("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),lt=Y("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),Ce=Y("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),tl=Y("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Ht=Y("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),hn=Y("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),al=Y("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]),nl=Y("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),yt=Y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ls=Y("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Se=Y("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Yt=Y("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ot=Y("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),$s=Y("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ce=Y("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),xn=Y("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Ze(...s){return $n(qn(s))}function ee(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function il(s){return qt(s)}function Zs(s,a){return Ut(s,a)}function te(s,a="MMM dd, yyyy"){if(!s)return"N/A";const t=s instanceof Date?s:new Date(s);return isNaN(t.getTime())?"Invalid Date":Ie(t,a)}function Os(s,a=!1){if(!s)return"N/A";const t=s instanceof Date?s:new Date(s);return isNaN(t.getTime())?"Invalid Time":Ie(t,a?"HH:mm":"h:mm a")}function rl(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}function ll(s){return/^\+?[\d\s\-\(\)]{10,}$/.test(s)}function Ca(){const s=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1"];return s[Math.floor(Math.random()*s.length)]}function Tt(s,a){if(a===0||isNaN(s)||isNaN(a))return 0;const t=Math.round(s/a*100);return isNaN(t)?0:t}function Gt(s){return s>=90?"text-green-600":s>=75?"text-yellow-600":s>=50?"text-orange-600":"text-red-600"}function gn(s,a){return`${s} ${a}`}function ol(s){var i,l;if(!s.useMultiplePills||!s.pillConfigurations||!s.doseConfigurations)return`${s.dosage} ${s.unit}`;const a=((i=s.doseConfigurations)==null?void 0:i.find(o=>o.id===s.defaultDoseConfigurationId))||((l=s.doseConfigurations)==null?void 0:l[0]);if(!a)return`${s.dosage} ${s.unit}`;const t=a.pillComponents.map(o=>{const c=s.pillConfigurations.find(R=>R.id===o.pillConfigurationId);if(!c)return"";const d=o.quantity,m=c.strength,x=c.unit,y=c.color;return d===1?`1 × ${m}${x}${y?` ${y}`:""} pill`:d%1===0?`${d} × ${m}${x}${y?` ${y}`:""} pills`:`${d} × ${m}${x}${y?` ${y}`:""} pill`}).filter(Boolean);if(t.length===0)return`${s.dosage} ${s.unit}`;const n=a.totalDoseAmount,r=a.totalDoseUnit;return t.length===1?`${t[0]} (${n}${r} total)`:`${t.join(" + ")} (${n}${r} total)`}function qs(s){var n,r;if(!s.useMultiplePills||!s.pillConfigurations||!s.doseConfigurations)return`${s.dosage} ${s.unit}`;const a=((n=s.doseConfigurations)==null?void 0:n.find(i=>i.id===s.defaultDoseConfigurationId))||((r=s.doseConfigurations)==null?void 0:r[0]);if(!a)return`${s.dosage} ${s.unit}`;const t=a.pillComponents.reduce((i,l)=>i+l.quantity,0);return t===1?`1 pill (${a.totalDoseAmount}${a.totalDoseUnit})`:t%1===0?`${t} pills (${a.totalDoseAmount}${a.totalDoseUnit})`:`${t} pills (${a.totalDoseAmount}${a.totalDoseUnit})`}function pn(s){var t,n;if(!s.useMultiplePills||!s.pillConfigurations||!s.doseConfigurations)return[];const a=((t=s.doseConfigurations)==null?void 0:t.find(r=>r.id===s.defaultDoseConfigurationId))||((n=s.doseConfigurations)==null?void 0:n[0]);return a?a.pillComponents.map(r=>{const i=s.pillConfigurations.find(l=>l.id===r.pillConfigurationId);return{...r,pillConfig:i,displayText:i?`${r.quantity} × ${i.strength}${i.unit}${i.color?` ${i.color}`:""}`:"Unknown pill"}}).filter(r=>r.pillConfig):[]}function cl(s){return{"as-needed":"As needed","once-daily":"Once daily","twice-daily":"Twice daily","three-times-daily":"3 times daily","four-times-daily":"4 times daily","every-other-day":"Every other day",weekly:"Weekly",monthly:"Monthly",custom:"Custom schedule"}[s]||s}function dl(s,a){if(!a.trim())return s;const t=a.toLowerCase();return s.filter(n=>n.name.toLowerCase().includes(t))}function Xs(s,a,t="text/plain"){const n=new Blob([s],{type:t}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}function Ps(s,a){if(s.length===0)return"";const t=a||Object.keys(s[0]),n=t.join(","),r=s.map(i=>t.map(l=>{const o=i[l];return typeof o=="string"&&(o.includes(",")||o.includes('"'))?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[n,...r].join(`
`)}function Ms(s){return{opioid:"high",benzodiazepine:"high",stimulant:"high","sleep-aid":"moderate","muscle-relaxant":"moderate",antidepressant:"low",anticonvulsant:"low",antipsychotic:"moderate","low-risk":"minimal"}[s]||"low"}function hs(s){const a=s.toLowerCase();return a.includes("oxycodone")||a.includes("morphine")||a.includes("fentanyl")||a.includes("hydrocodone")||a.includes("codeine")||a.includes("tramadol")||a.includes("kratom")?"opioid":a.includes("alprazolam")||a.includes("lorazepam")||a.includes("diazepam")||a.includes("clonazepam")||a.includes("xanax")||a.includes("valium")||a.includes("ativan")||a.includes("klonopin")||a.includes("phenibut")?"benzodiazepine":a.includes("adderall")||a.includes("ritalin")||a.includes("concerta")||a.includes("vyvanse")||a.includes("amphetamine")||a.includes("methylphenidate")||a.includes("modafinil")?"stimulant":a.includes("zolpidem")||a.includes("ambien")||a.includes("lunesta")||a.includes("sonata")||a.includes("eszopiclone")?"sleep-aid":a.includes("cyclobenzaprine")||a.includes("flexeril")||a.includes("baclofen")||a.includes("tizanidine")?"muscle-relaxant":a.includes("sertraline")||a.includes("fluoxetine")||a.includes("escitalopram")||a.includes("venlafaxine")||a.includes("duloxetine")||a.includes("paroxetine")||a.includes("bupropion")||a.includes("mirtazapine")||a.includes("zoloft")||a.includes("prozac")||a.includes("lexapro")||a.includes("effexor")||a.includes("cymbalta")||a.includes("paxil")||a.includes("wellbutrin")||a.includes("remeron")?"antidepressant":a.includes("gabapentin")||a.includes("pregabalin")||a.includes("neurontin")||a.includes("lyrica")?"anticonvulsant":a.includes("quetiapine")||a.includes("seroquel")||a.includes("olanzapine")||a.includes("risperidone")||a.includes("aripiprazole")||a.includes("haloperidol")?"antipsychotic":"low-risk"}function ml(s,a,t){if(!(a!=null&&a.pattern))return{dose:s,phase:"maintenance"};const n=new Date(a.startDate),r=Math.floor((t.getTime()-n.getTime())/(1e3*60*60*24));let i=0;if(a.pattern.forEach(c=>{i+=c.duration}),i===0)return{dose:s,phase:"maintenance"};const l=r%i;let o=0;for(const c of a.pattern){if(l>=o&&l<o+c.duration)return{dose:s*c.dosageMultiplier,phase:c.phase,message:c.customMessage};o+=c.duration}return{dose:s,phase:"maintenance"}}function fn(s,a,t,n){if(!a)return s;if(a.isPaused){const d=a.pausedAt?new Date(a.pausedAt):t;return fn(s,{...a,isPaused:!1},d,n)}const r=new Date(a.startDate),i=new Date(a.endDate),l=Math.floor((t.getTime()-r.getTime())/(1e3*60*60*24)),o=Math.floor((i.getTime()-r.getTime())/(1e3*60*60*24));if(l<0)return a.initialDose;if(l>=o)return a.finalDose;if(a.customSteps&&a.customSteps.length>0){const d=a.customSteps.filter(m=>m.day<=l).sort((m,x)=>x.day-m.day)[0];if(d)return a.initialDose*d.dosageMultiplier}if(a.taperingMethod==="linear"){const d=l/o;return a.initialDose+(a.finalDose-a.initialDose)*d}if(a.taperingMethod==="exponential"){const d=l/o,m=1-Math.pow(1-d,2);return a.initialDose+(a.finalDose-a.initialDose)*m}if(a.customSteps){const d=a.customSteps.filter(m=>m.day<=l).sort((m,x)=>x.day-m.day)[0];if(d)return s*d.dosageMultiplier}const c=s;return n!=null&&n.useMultiplePills&&(n!=null&&n.pillConfigurations)?ul(c,n):c}function ul(s,a){if(!(a!=null&&a.pillConfigurations))return s;const t=a.pillConfigurations.filter(i=>i.isActive);let n=s,r=1/0;t.sort((i,l)=>l.strength-i.strength);for(let i=0;i<t.length;i++){const l=t[i],o=Math.floor(s/l.strength),c=s>=l.strength*(o+.5)?.5:0,d=l.strength*(o+c),m=Math.abs(s-d);m<r&&d<=s*1.1&&(r=m,n=d)}return n}function hl(s,a){if(!(a!=null&&a.pillConfigurations))return{};const t=a.pillConfigurations.filter(i=>i.isActive).sort((i,l)=>l.strength-i.strength),n={};let r=s;t.forEach(i=>{n[i.id]=0});for(const i of t){if(r<=0)break;const l=Math.floor(r/i.strength);l>0&&(n[i.id]+=l,r-=l*i.strength),r>=i.strength*.4&&(n[i.id]+=.5,r-=i.strength*.5)}return n}function xl(s,a){if(!(a!=null&&a.pillConfigurations))return"";const t=[];return Object.entries(s).forEach(([n,r])=>{if(r>0){const i=a.pillConfigurations.find(l=>l.id===n);if(i){const l=(r%1===0,r.toString());t.push(`${l} × ${i.strength}${i.unit} ${i.color||""} pill${r!==1?"s":""}`)}}}),t.join(" + ")||"No pills"}function gl(s,a,t){const n={"adherence-reminder":"gentle-reminder","dependency-warning":"factual-warning",motivation:"positive-reinforcement",celebration:"positive-reinforcement","risk-alert":"empathetic-support"},i={"adherence-reminder":{title:"Gentle Reminder",message:`Hi there! It's time for your ${a}. Taking your medication consistently helps maintain your health and well-being. You've got this! 💪`},"dependency-warning":{title:"Health Check-In",message:`We noticed some changes in your ${a} usage pattern. It's important to stick to your prescribed schedule. If you're experiencing increased symptoms, please consult your healthcare provider rather than adjusting the dose yourself.`},motivation:{title:"You're Doing Great!",message:`Your consistency with ${a} is impressive! Every dose you take as prescribed is an investment in your health. Keep up the excellent work! 🌟`},celebration:{title:"Milestone Achieved! 🎉",message:`Congratulations! You've maintained excellent adherence with ${a} this week. Your dedication to your health is inspiring and making a real difference!`},"risk-alert":{title:"Supportive Check-In",message:`We care about your well-being. If you're finding it challenging to stick to your ${a} schedule, remember that this is normal and you're not alone. Consider reaching out to your healthcare provider for support.`}}[s];return t!=null&&t.adherenceStreak&&(i.message+=` You're on a ${t.adherenceStreak}-day streak!`),{...i,approach:n[s]}}function pl(s,a){const n={"once-daily":1,"twice-daily":2,"three-times-daily":3,"four-times-daily":4,"as-needed":0}[s.frequency]||0;if(n===0)return{remaining:0,total:0,completed:a.some(c=>c.medicationId===s.id&&c.adherence==="taken")};const r=a.filter(o=>o.medicationId===s.id&&o.adherence==="taken").length,i=Math.max(0,n-r),l=r>=n;return{remaining:i,total:n,completed:l}}function Sa(s,a,t,n){return n==="as-needed"?t?"Taken today":"As needed":t?"All doses complete":s===a?`${a} dose${a>1?"s":""} today`:`${s} of ${a} remaining`}function fl(s,a,t=30){const n=a.startDate?new Date(a.startDate):a.createdAt?new Date(a.createdAt):null,r=14;if(n&&(Date.now()-n.getTime())/864e5<r)return{riskScore:0,riskFactors:["Recently started medication - monitoring phase"],recommendations:["Continue taking as prescribed","Monitor for any side effects or concerns","Follow up with healthcare provider as scheduled"]};const i=s.filter(S=>{const v=new Date(S.timestamp);return(Date.now()-v.getTime())/(1e3*60*60*24)<=t&&S.medicationId===a.id});let l=0;const o=[],c=[];let m={opioid:40,benzodiazepine:35,stimulant:30,"sleep-aid":20,"muscle-relaxant":15,antidepressant:5,anticonvulsant:5,"low-risk":0}[a.dependencyRiskCategory]||0;if(n){const S=(Date.now()-n.getTime())/864e5;if(S<30){const v=Math.max(.3,S/30);m*=v,o.push(`Medication started ${Math.round(S)} days ago - risk assessment adjusting`)}}if(l+=m,i.length>=5){const S=i.map(g=>g.dosageTaken),v=parseFloat(a.dosage);S.some(g=>g>v*1.5)&&(l+=25,o.push("Doses exceeding prescribed amount detected"),c.push("Contact healthcare provider about dose concerns"))}else i.length>0&&o.push("Limited usage data - continuing to monitor patterns");const y={"once-daily":1,"twice-daily":2,"three-times-daily":3,"four-times-daily":4}[a.frequency]||1,R=i.reduce((S,v)=>{const g=new Date(v.timestamp).toDateString();return S[g]=(S[g]||0)+1,S},{}),k=Object.keys(R).length;if(k>=3){const S=Object.values(R).filter(v=>v>y*1.5);S.length>0&&S.length/k>.3&&(l+=20,o.push("Taking medication more frequently than prescribed"),c.push("Review dosing schedule with healthcare provider"))}return a.pillsRemaining!==void 0&&a.totalPills&&(a.totalPills-a.pillsRemaining)/(y*(t/30))>1.3&&(l+=15,o.push("Using medication faster than expected"),c.push("Monitor usage patterns carefully")),l=Math.min(l,100),n&&(Date.now()-n.getTime())/(1e3*60*60*24)<30?l<30?(c.push("Continue current medication routine and monitor for any changes"),c.push("Follow up with healthcare provider as scheduled")):(c.push("Discuss any concerns with healthcare provider at next appointment"),c.push("Monitor usage patterns carefully during adjustment period")):l<20?c.push("Continue current medication routine"):l<50?c.push("Monitor usage patterns and discuss with healthcare provider"):(c.push("Immediate consultation with healthcare provider recommended"),c.push("Consider dependency assessment")),{riskScore:l,riskFactors:o,recommendations:c}}function yl(s,a,t=30){const n=[];s.filter(o=>{const d=new Date(o.timestamp).getDay();return(d===0||d===6)&&o.adherence==="missed"}).length>2&&n.push({type:"weekend-gaps",detectedDate:new Date,confidence:.8,description:"Tendency to miss doses on weekends",recommendedAction:"Set weekend-specific reminders"});const l=s.filter(o=>o.adherence==="taken").map(o=>{const c=new Date(o.timestamp);return c.getHours()*60+c.getMinutes()});if(l.length>7){const o=l.reduce((d,m)=>d+m,0)/l.length;l.reduce((d,m)=>d+Math.pow(m-o,2),0)/l.length>3600&&n.push({type:"dose-timing-drift",detectedDate:new Date,confidence:.7,description:"Inconsistent dosing times detected",recommendedAction:"Consider setting consistent daily reminders"})}return n}const vl=[{name:"Dashboard",href:"/dashboard",icon:Hr},{name:"Medications",href:"/medications",icon:Pe},{name:"Inventory",href:"/inventory",icon:gs},{name:"Calendar",href:"/calendar",icon:$e},{name:"Analytics",href:"/analytics",icon:fs},{name:"Settings",href:"/settings",icon:Fs}],bl=[{name:"Reminders",href:"/reminders",icon:rs},{name:"Reports",href:"/reports",icon:vs},{name:"Health Profile",href:"/profile",icon:Qe}];function jl({isOpen:s,onClose:a}){const t=({item:n,onClick:r})=>{const i=`sidebar-${n.name.toLowerCase().replace(/\s+/g,"-")}`;return e.jsxs(Gi,{to:n.href,onClick:r,"data-testid":i,className:({isActive:l})=>Ze("flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors",l?"bg-primary-100 text-primary-700 border-r-2 border-primary-600":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"),children:[e.jsx(n.icon,{className:"mr-3 h-5 w-5 flex-shrink-0"}),n.name]})};return e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:"fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden",onClick:a}),e.jsx("div",{className:Ze("fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform lg:translate-x-0 lg:static lg:inset-0",s?"translate-x-0":"-translate-x-full"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3","data-testid":"header-logo",children:[e.jsx("div",{className:"h-8 w-8 bg-primary-600 rounded-lg flex items-center justify-center",children:e.jsx(Pe,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"MedTrack"})]}),e.jsx("button",{onClick:a,className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:e.jsx(ce,{className:"h-5 w-5"})})]}),e.jsxs("nav",{className:"flex-1 px-4 py-6 space-y-1",children:[e.jsx("div",{className:"space-y-1",children:vl.map(n=>e.jsx(t,{item:n,onClick:()=>s&&a()},n.name))}),e.jsxs("div",{className:"pt-6",children:[e.jsx("h3",{className:"px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Tools"}),e.jsx("div",{className:"mt-2 space-y-1",children:bl.map(n=>e.jsx(t,{item:n,onClick:()=>s&&a()},n.name))})]})]}),e.jsx("div",{className:"border-t border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center space-x-3","data-testid":"footer-help",children:[e.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Qe,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Stay healthy"}),e.jsx("p",{className:"text-xs text-gray-400","data-testid":"footer-privacy",children:"Track your progress"})]})]})})]})})]})}const Ra=s=>{let a;const t=new Set,n=(m,x)=>{const y=typeof m=="function"?m(a):m;if(!Object.is(y,a)){const R=a;a=x??(typeof y!="object"||y===null)?y:Object.assign({},a,y),t.forEach(k=>k(a,R))}},r=()=>a,c={setState:n,getState:r,getInitialState:()=>d,subscribe:m=>(t.add(m),()=>t.delete(m)),destroy:()=>{t.clear()}},d=a=s(n,r,c);return c},Nl=s=>s?Ra(s):Ra;var yn={exports:{}},vn={},bn={exports:{}},jn={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bs=q;function wl(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var kl=typeof Object.is=="function"?Object.is:wl,Dl=bs.useState,Cl=bs.useEffect,Sl=bs.useLayoutEffect,Rl=bs.useDebugValue;function Ml(s,a){var t=a(),n=Dl({inst:{value:t,getSnapshot:a}}),r=n[0].inst,i=n[1];return Sl(function(){r.value=t,r.getSnapshot=a,It(r)&&i({inst:r})},[s,t,a]),Cl(function(){return It(r)&&i({inst:r}),s(function(){It(r)&&i({inst:r})})},[s]),Rl(t),t}function It(s){var a=s.getSnapshot;s=s.value;try{var t=a();return!kl(s,t)}catch{return!0}}function Pl(s,a){return a()}var Al=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Pl:Ml;jn.useSyncExternalStore=bs.useSyncExternalStore!==void 0?bs.useSyncExternalStore:Al;bn.exports=jn;var El=bn.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt=q,Tl=El;function Il(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Fl=typeof Object.is=="function"?Object.is:Il,Ll=Tl.useSyncExternalStore,$l=vt.useRef,ql=vt.useEffect,Ul=vt.useMemo,zl=vt.useDebugValue;vn.useSyncExternalStoreWithSelector=function(s,a,t,n,r){var i=$l(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=Ul(function(){function c(R){if(!d){if(d=!0,m=R,R=n(R),r!==void 0&&l.hasValue){var k=l.value;if(r(k,R))return x=k}return x=R}if(k=x,Fl(m,R))return k;var S=n(R);return r!==void 0&&r(k,S)?(m=R,k):(m=R,x=S)}var d=!1,m,x,y=t===void 0?null:t;return[function(){return c(a())},y===null?void 0:function(){return c(y())}]},[a,t,n,r]);var o=Ll(s,i[0],i[1]);return ql(function(){l.hasValue=!0,l.value=o},[o]),zl(o),o};yn.exports=vn;var Ol=yn.exports;const _l=Ln(Ol),{useDebugValue:Vl}=I,{useSyncExternalStoreWithSelector:Wl}=_l;const Bl=s=>s;function Hl(s,a=Bl,t){const n=Wl(s.subscribe,s.getState,s.getServerState||s.getInitialState,a,t);return Vl(n),n}const Ma=s=>{const a=typeof s=="function"?Nl(s):s,t=(n,r)=>Hl(a,n,r);return Object.assign(t,a),t},Yl=s=>s?Ma(s):Ma;function Nn(s,a){let t;try{t=s()}catch{return}return{getItem:r=>{var i;const l=c=>c===null?null:JSON.parse(c,a==null?void 0:a.reviver),o=(i=t.getItem(r))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,a==null?void 0:a.replacer)),removeItem:r=>t.removeItem(r)}}const Us=s=>a=>{try{const t=s(a);return t instanceof Promise?t:{then(n){return Us(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return Us(n)(t)}}}},Gl=(s,a)=>(t,n,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,g)=>({...g,...v}),...a},l=!1;const o=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return s((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},n,r);const m=Us(i.serialize),x=()=>{const v=i.partialize({...n()});let g;const u=m({state:v,version:i.version}).then(f=>d.setItem(i.name,f)).catch(f=>{g=f});if(g)throw g;return u},y=r.setState;r.setState=(v,g)=>{y(v,g),x()};const R=s((...v)=>{t(...v),x()},n,r);let k;const S=()=>{var v;if(!d)return;l=!1,o.forEach(u=>u(n()));const g=((v=i.onRehydrateStorage)==null?void 0:v.call(i,n()))||void 0;return Us(d.getItem.bind(d))(i.name).then(u=>{if(u)return i.deserialize(u)}).then(u=>{if(u)if(typeof u.version=="number"&&u.version!==i.version){if(i.migrate)return i.migrate(u.state,u.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return u.state}).then(u=>{var f;return k=i.merge(u,(f=n())!=null?f:R),t(k,!0),x()}).then(()=>{g==null||g(k,void 0),l=!0,c.forEach(u=>u(k))}).catch(u=>{g==null||g(void 0,u)})};return r.persist={setOptions:v=>{i={...i,...v},v.getStorage&&(d=v.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>S(),hasHydrated:()=>l,onHydrate:v=>(o.add(v),()=>{o.delete(v)}),onFinishHydration:v=>(c.add(v),()=>{c.delete(v)})},S(),k||R},Kl=(s,a)=>(t,n,r)=>{let i={storage:Nn(()=>localStorage),partialize:S=>S,version:0,merge:(S,v)=>({...v,...S}),...a},l=!1;const o=new Set,c=new Set;let d=i.storage;if(!d)return s((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...S)},n,r);const m=()=>{const S=i.partialize({...n()});return d.setItem(i.name,{state:S,version:i.version})},x=r.setState;r.setState=(S,v)=>{x(S,v),m()};const y=s((...S)=>{t(...S),m()},n,r);r.getInitialState=()=>y;let R;const k=()=>{var S,v;if(!d)return;l=!1,o.forEach(u=>{var f;return u((f=n())!=null?f:y)});const g=((v=i.onRehydrateStorage)==null?void 0:v.call(i,(S=n())!=null?S:y))||void 0;return Us(d.getItem.bind(d))(i.name).then(u=>{if(u)if(typeof u.version=="number"&&u.version!==i.version){if(i.migrate)return[!0,i.migrate(u.state,u.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,u.state];return[!1,void 0]}).then(u=>{var f;const[b,h]=u;if(R=i.merge(h,(f=n())!=null?f:y),t(R,!0),b)return m()}).then(()=>{g==null||g(R,void 0),R=n(),l=!0,c.forEach(u=>u(R))}).catch(u=>{g==null||g(void 0,u)})};return r.persist={setOptions:S=>{i={...i,...S},S.storage&&(d=S.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>k(),hasHydrated:()=>l,onHydrate:S=>(o.add(S),()=>{o.delete(S)}),onFinishHydration:S=>(c.add(S),()=>{c.delete(S)})},i.skipHydration||k(),R||y},Jl=(s,a)=>"getStorage"in a||"serialize"in a||"deserialize"in a?Gl(s,a):Kl(s,a),Zl=Jl;class ls{static initializePrevention(a){const t=a.dependencyRiskCategory,n=this.RISK_TIMELINES[t]||this.RISK_TIMELINES["low-risk"];return{medicationId:a.id,isEnabled:!0,riskLevel:this.calculateInitialRiskLevel(a),dependenceType:this.getDependenceType(t),usagePatterns:[],toleranceIndicators:[],withdrawalHistory:[],recommendedMaxDuration:n.maxSafeDuration,currentDuration:0,taperingRecommended:!1,taperingUrgency:"none",alerts:[],interventions:[],educationalResources:this.getEducationalResources(t),doctorReviewRequired:!1,reviewFrequency:n.reviewFrequency}}static assessCurrentRisk(a,t){const n=a.dependencePrevention||this.initializePrevention(a),r=this.calculateCurrentDuration(a.startDate),i=a.dependencyRiskCategory;this.RISK_TIMELINES[i]||this.RISK_TIMELINES["low-risk"],n.currentDuration=r,n.riskLevel=this.calculateRiskLevel(a,t,r);const l=this.assessTaperingNeed(a,t,r);n.taperingRecommended=l.recommended,n.taperingUrgency=l.urgency;const o=this.generateRiskAlerts(a,t,r);return n.alerts=[...n.alerts,...o],n.doctorReviewRequired=this.shouldReviewWithDoctor(a,t,r),n}static calculateInitialRiskLevel(a){const t=a.dependencyRiskCategory;return{opioid:"very-high",benzodiazepine:"high",stimulant:"high","sleep-aid":"moderate","muscle-relaxant":"moderate",antidepressant:"low",anticonvulsant:"low",antipsychotic:"low","low-risk":"low"}[t]||"low"}static getDependenceType(a){switch(a){case"opioid":case"benzodiazepine":case"sleep-aid":return"both";case"stimulant":return"psychological";case"antidepressant":case"anticonvulsant":return"physical";default:return"none"}}static calculateCurrentDuration(a){const t=new Date,n=new Date(a);return Math.floor((t.getTime()-n.getTime())/(1e3*60*60*24))}static calculateRiskLevel(a,t,n){let r=0;const i=a.dependencyRiskCategory,l=this.RISK_TIMELINES[i]||this.RISK_TIMELINES["low-risk"];if(n>l.urgentDuration?r+=40:n>l.warningDuration?r+=25:n>l.maxSafeDuration&&(r+=15),t.length>0){const o=t.slice(-14);this.detectDoseEscalation(o).isEscalating&&(r+=20),o.filter(k=>k.selfAdjustment).length/o.length>.3&&(r+=15);const x=o.filter(k=>k.cravingLevel!==void 0).reduce((k,S)=>k+(S.cravingLevel||0),0)/o.length;x>7?r+=25:x>5&&(r+=15);const y=o.filter(k=>k.anxietyBeforeDose!==void 0).reduce((k,S)=>k+(S.anxietyBeforeDose||0),0)/o.length;y>7?r+=20:y>5&&(r+=10),this.detectEffectivenessDecline(o).isDeclineDetected&&(r+=15)}return r>=60?"very-high":r>=40?"high":r>=20?"moderate":"low"}static detectDoseEscalation(a){if(a.length<5)return{isEscalating:!1,rate:0};const t=a.map(c=>c.doseTaken),n=t.slice(0,Math.floor(t.length/2)),r=t.slice(Math.floor(t.length/2)),i=n.reduce((c,d)=>c+d,0)/n.length,o=(r.reduce((c,d)=>c+d,0)/r.length-i)/i;return{isEscalating:o>.1,rate:o}}static detectEffectivenessDecline(a){const t=a.filter(c=>c.effectivenessRating!==void 0).map(c=>c.effectivenessRating);if(t.length<5)return{isDeclineDetected:!1,rate:0};const n=t.slice(0,Math.floor(t.length/2)),r=t.slice(Math.floor(t.length/2)),i=n.reduce((c,d)=>c+d,0)/n.length,l=r.reduce((c,d)=>c+d,0)/r.length,o=(i-l)/i;return{isDeclineDetected:o>.15,rate:o}}static assessTaperingNeed(a,t,n){const r=a.dependencyRiskCategory,i=this.RISK_TIMELINES[r]||this.RISK_TIMELINES["low-risk"];if(r==="antidepressant"&&n<180)return{recommended:!1,urgency:"none"};if(n>i.urgentDuration)return{recommended:!0,urgency:"urgent"};if(n>i.warningDuration)return{recommended:!0,urgency:"recommended"};if(n>i.maxSafeDuration)return{recommended:!0,urgency:"consider"};if(t.length>0){const l=t.slice(-7),o=this.detectDoseEscalation(l);if(o.isEscalating&&o.rate>.25)return{recommended:!0,urgency:"recommended"}}return{recommended:!1,urgency:"none"}}static generateRiskAlerts(a,t,n){const r=[],i=a.dependencyRiskCategory,l=this.RISK_TIMELINES[i]||this.RISK_TIMELINES["low-risk"],o=new Date;if(n===l.maxSafeDuration&&r.push({id:ee(),type:"early-warning",priority:"medium",message:`You've been taking ${a.name} for ${n} days. Consider discussing with your doctor about treatment goals.`,trigger:"duration-milestone",timestamp:o,acknowledged:!1}),n===l.warningDuration&&r.push({id:ee(),type:"intervention-needed",priority:"high",message:`${a.name} has been taken for ${n} days. Review with your healthcare provider is recommended.`,trigger:"extended-duration",timestamp:o,acknowledged:!1}),n>=l.urgentDuration&&r.push({id:ee(),type:"urgent-medical",priority:"critical",message:`Long-term use of ${a.name} (${n} days). Urgent medical review and tapering plan needed.`,trigger:"long-term-use",timestamp:o,acknowledged:!1}),t.length>0){const c=t.slice(-7);this.detectDoseEscalation(c).isEscalating&&r.push({id:ee(),type:"intervention-needed",priority:"high",message:`Dose escalation pattern detected for ${a.name}. This may indicate developing tolerance.`,trigger:"dose-escalation",timestamp:o,acknowledged:!1}),c.filter(x=>x.cravingLevel!==void 0&&x.cravingLevel>7).length>=3&&r.push({id:ee(),type:"intervention-needed",priority:"high",message:`High craving levels reported for ${a.name}. Consider discussing dependence prevention with your doctor.`,trigger:"high-cravings",timestamp:o,acknowledged:!1})}return r}static shouldReviewWithDoctor(a,t,n){const r=a.dependencyRiskCategory,i=this.RISK_TIMELINES[r]||this.RISK_TIMELINES["low-risk"],l=a.dependencePrevention;if(l!=null&&l.lastDoctorReview){if(Math.floor((new Date().getTime()-new Date(l.lastDoctorReview).getTime())/864e5)>=i.reviewFrequency)return!0}else if(n>=i.reviewFrequency)return!0;if(n>i.warningDuration)return!0;if(t.length>0){const o=t.slice(-14),c=this.detectDoseEscalation(o);if(c.isEscalating&&c.rate>.2)return!0}return!1}static getEducationalResources(a){return{benzodiazepine:["Understanding benzodiazepine dependence and withdrawal","Safe tapering strategies for benzodiazepines","Alternative treatments for anxiety and sleep","Cognitive behavioral therapy for anxiety disorders"],opioid:["Understanding opioid dependence and tolerance","Pain management alternatives to opioids","Safe opioid tapering protocols","Naloxone (Narcan) administration and safety"],stimulant:["ADHD medication management and monitoring","Recognizing stimulant abuse and dependence","Behavioral interventions for ADHD","Managing stimulant side effects"],"sleep-aid":["Sleep hygiene and non-medication approaches","Understanding sleep medication dependence","Cognitive behavioral therapy for insomnia","Safe discontinuation of sleep medications"],antidepressant:["Understanding antidepressant discontinuation syndrome","Safe tapering of antidepressant medications","Depression relapse prevention strategies","Therapy options for depression and anxiety"]}[a]||["Safe medication use and monitoring","When to consult your healthcare provider","Understanding medication dependence vs. addiction","Building healthy coping strategies"]}static generateTaperingRecommendation(a){const t=a.dependencyRiskCategory,n=parseFloat(a.dosage);return t==="low-risk"||!this.requiresTapering(t)?{recommended:!1,warnings:["Tapering may not be necessary for this medication type"],monitoring:["Monitor for any unusual symptoms if discontinuing"]}:{recommended:!0,schedule:this.generateTaperingSchedule(t,n,a.unit),warnings:this.getTaperingWarnings(t),monitoring:this.getTaperingMonitoring(t)}}static requiresTapering(a){return["benzodiazepine","opioid","sleep-aid","antidepressant","anticonvulsant"].includes(a)}static generateTaperingSchedule(a,t,n){const r={benzodiazepine:{totalDuration:8,reductionRate:12.5,stabilizationWeeks:[2,4,6]},opioid:{totalDuration:4,reductionRate:25,stabilizationWeeks:[2]},"sleep-aid":{totalDuration:6,reductionRate:15,stabilizationWeeks:[2,4]},antidepressant:{totalDuration:12,reductionRate:8.3,stabilizationWeeks:[4,8]}},i=r[a]||r.benzodiazepine,l=[];let o=t;for(let c=1;c<=i.totalDuration;c++)i.stabilizationWeeks.includes(c)?l.push({week:c,dose:o,notes:"Stabilization week - maintain current dose"}):(o=o*(1-i.reductionRate/100),l.push({week:c,dose:Math.round(o*100)/100,notes:`Reduce to ${Math.round(o*100)/100}${n}`}));return{totalDuration:i.totalDuration,reductionRate:i.reductionRate,steps:l}}static getTaperingWarnings(a){return{benzodiazepine:["Never stop abruptly - can cause dangerous withdrawal symptoms","Seizures are a risk with rapid discontinuation","Withdrawal can be life-threatening - medical supervision required"],opioid:["Withdrawal can be very uncomfortable but not life-threatening","Consider medication-assisted treatment options","Monitor for depression and suicidal thoughts"],antidepressant:["Discontinuation syndrome can mimic depression relapse","Brain zaps and dizziness are common withdrawal symptoms","Monitor closely for depression relapse"]}[a]||["Consult healthcare provider before making changes"]}static getTaperingMonitoring(a){return{benzodiazepine:["Daily mood and anxiety levels","Sleep quality and patterns","Any seizure activity","Blood pressure and heart rate"],opioid:["Pain levels and management","Mood and mental health","Sleep and appetite","Withdrawal symptom severity"],antidepressant:["Depression and anxiety symptoms","Suicidal thoughts or behaviors","Sleep and energy levels","Social and work functioning"]}[a]||["General wellbeing and symptom monitoring"]}}ua(ls,"RISK_TIMELINES",{benzodiazepine:{maxSafeDuration:14,warningDuration:21,urgentDuration:30,reviewFrequency:7},opioid:{maxSafeDuration:7,warningDuration:14,urgentDuration:21,reviewFrequency:3},"sleep-aid":{maxSafeDuration:14,warningDuration:28,urgentDuration:42,reviewFrequency:7},antidepressant:{maxSafeDuration:180,warningDuration:365,urgentDuration:730,reviewFrequency:30},stimulant:{maxSafeDuration:30,warningDuration:90,urgentDuration:180,reviewFrequency:14},"low-risk":{maxSafeDuration:90,warningDuration:180,urgentDuration:365,reviewFrequency:30}});const Kt=[{name:"Oxycodone",brandNames:["OxyContin","Percocet","Roxicodone"],category:"prescription",dependencyRiskCategory:"opioid",riskLevel:"high",commonDosages:["5","10","15","20","30"],commonUnits:["mg"],commonFrequencies:["every-4-hours","every-6-hours","twice-daily"],description:"Strong opioid pain medication for moderate to severe pain",commonSideEffects:["drowsiness","constipation","nausea","dizziness","respiratory depression"],commonInteractions:["alcohol","benzodiazepines","muscle relaxants","sleep aids"],withdrawalRisk:"severe",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:8,reductionPercent:10,notes:"Use hyperbolic tapering: 10% reduction of current dose every 1-2 weeks. Monitor for withdrawal symptoms. Medical supervision essential."},psychologicalSupport:{adherenceFactors:["pain management goals","withdrawal fear","tolerance concerns"],motivationalMessages:["Taking your medication as prescribed helps manage pain safely","Consistent dosing prevents withdrawal while managing pain","You're taking an important step in your pain management journey"],riskTriggers:["dose escalation","early refills","frequent breakthrough pain"]}},{name:"Morphine",brandNames:["MS Contin","Kadian","Avinza"],category:"prescription",dependencyRiskCategory:"opioid",riskLevel:"high",commonDosages:["15","30","60","100"],commonUnits:["mg"],commonFrequencies:["twice-daily","every-12-hours"],description:"Strong opioid for severe pain management",commonSideEffects:["constipation","drowsiness","nausea","confusion"],withdrawalRisk:"severe",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:12,reductionPercent:10,notes:"Very slow hyperbolic tapering required. Consider switching to longer-acting formulation first. 10% of current dose every 2 weeks."}},{name:"Tramadol",brandNames:["Ultram","ConZip"],category:"prescription",dependencyRiskCategory:"opioid",riskLevel:"moderate",commonDosages:["50","100"],commonUnits:["mg"],commonFrequencies:["every-6-hours","every-8-hours"],description:"Atypical opioid for moderate pain",withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:2,reductionPercent:50,notes:"Can cause seizures if stopped abruptly. Gradual reduction recommended."}},{name:"Alprazolam",brandNames:["Xanax","Niravam"],category:"prescription",dependencyRiskCategory:"benzodiazepine",riskLevel:"high",commonDosages:["0.25","0.5","1","2"],commonUnits:["mg"],commonFrequencies:["as-needed","twice-daily","three-times-daily"],description:"Short-acting benzodiazepine for anxiety and panic disorders",commonSideEffects:["drowsiness","memory problems","confusion","coordination problems"],commonInteractions:["alcohol","opioids","muscle relaxants","antihistamines"],withdrawalRisk:"severe",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:16,reductionPercent:10,notes:"Extremely slow hyperbolic taper required following Ashton Manual principles. Consider switching to diazepam first. 10% of current dose every 2-3 weeks. Medical supervision essential."},psychologicalSupport:{adherenceFactors:["anxiety management","withdrawal fear","rebound anxiety"],motivationalMessages:["Taking your anxiety medication consistently helps maintain emotional balance","Gradual, consistent dosing prevents rebound anxiety","You're managing your anxiety responsibly"],riskTriggers:["dose increases","taking extra doses","rebound anxiety","tolerance"]}},{name:"Lorazepam",brandNames:["Ativan"],category:"prescription",dependencyRiskCategory:"benzodiazepine",riskLevel:"high",commonDosages:["0.5","1","2"],commonUnits:["mg"],commonFrequencies:["as-needed","twice-daily"],description:"Intermediate-acting benzodiazepine for anxiety",withdrawalRisk:"severe",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:12,reductionPercent:10,notes:"Gradual hyperbolic reduction essential. Risk of seizures if stopped abruptly. 10% of current dose every 2 weeks."}},{name:"Clonazepam",brandNames:["Klonopin"],category:"prescription",dependencyRiskCategory:"benzodiazepine",riskLevel:"high",commonDosages:["0.5","1","2"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Long-acting benzodiazepine for anxiety and seizures",withdrawalRisk:"severe",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:20,reductionPercent:10,notes:"Very long hyperbolic taper due to long half-life and high potency. 10% of current dose every 3-4 weeks. Monitor for seizure risk."}},{name:"Amphetamine/Dextroamphetamine",brandNames:["Adderall","Adderall XR"],category:"prescription",dependencyRiskCategory:"stimulant",riskLevel:"high",commonDosages:["5","10","15","20","25","30"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Stimulant medication for ADHD",commonSideEffects:["decreased appetite","insomnia","mood changes","increased heart rate"],withdrawalRisk:"moderate",taperingRequired:!1,psychologicalSupport:{adherenceFactors:["ADHD symptom management","academic/work performance","side effect tolerance"],motivationalMessages:["Your ADHD medication helps you stay focused and organized","Consistent dosing maintains stable symptom control","You're taking charge of your ADHD management"],riskTriggers:["dose increases for performance","taking extra doses","using for energy"]}},{name:"Methylphenidate",brandNames:["Ritalin","Concerta","Metadate"],category:"prescription",dependencyRiskCategory:"stimulant",riskLevel:"high",commonDosages:["5","10","18","27","36","54"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Stimulant medication for ADHD",withdrawalRisk:"moderate",taperingRequired:!1},{name:"Zolpidem",brandNames:["Ambien","Edluar"],category:"prescription",dependencyRiskCategory:"sleep-aid",riskLevel:"moderate",commonDosages:["5","10"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Non-benzodiazepine sleep medication",commonSideEffects:["drowsiness","dizziness","memory problems","complex behaviors"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:2,reductionPercent:25,notes:"Gradual reduction to prevent rebound insomnia. May cause temporary sleep disturbance."}},{name:"Eszopiclone",brandNames:["Lunesta"],category:"prescription",dependencyRiskCategory:"sleep-aid",riskLevel:"moderate",commonDosages:["1","2","3"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Non-benzodiazepine sleep medication",withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:2,reductionPercent:33,notes:"Reduce gradually to minimize rebound insomnia."}},{name:"Sertraline",brandNames:["Zoloft"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"low",commonDosages:["25","50","100","150","200"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"SSRI antidepressant for depression and anxiety",commonSideEffects:["nausea","headache","sexual side effects","sleep changes"],withdrawalRisk:"low",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:4,reductionPercent:25,notes:"Gradual reduction to prevent discontinuation syndrome."},psychologicalSupport:{adherenceFactors:["mood stability","symptom return fear","side effect management"],motivationalMessages:["Your antidepressant helps maintain emotional balance","Consistent use supports long-term mental health","You're investing in your mental wellness"],riskTriggers:["mood episodes","missing doses frequently","stopping abruptly"]}},{name:"Fluoxetine",brandNames:["Prozac"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"low",commonDosages:["10","20","40"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"SSRI antidepressant with long half-life",withdrawalRisk:"low",taperingRequired:!1,taperingRecommendations:{method:"linear",durationWeeks:2,reductionPercent:50,notes:"Long half-life makes withdrawal less likely. Still recommend gradual reduction."}},{name:"Escitalopram",brandNames:["Lexapro"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"low",commonDosages:["5","10","20"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"SSRI antidepressant for depression and anxiety",withdrawalRisk:"low",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:3,reductionPercent:33,notes:"Monitor for discontinuation symptoms."}},{name:"Ibuprofen",brandNames:["Advil","Motrin"],category:"over-the-counter",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["200","400","600","800"],commonUnits:["mg"],commonFrequencies:["every-6-hours","every-8-hours"],description:"NSAID for pain and inflammation",commonSideEffects:["stomach upset","kidney issues","increased bleeding risk"],commonInteractions:["blood thinners","ACE inhibitors","lithium"],withdrawalRisk:"none",taperingRequired:!1},{name:"Acetaminophen",brandNames:["Tylenol"],category:"over-the-counter",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["325","500","650"],commonUnits:["mg"],commonFrequencies:["every-4-hours","every-6-hours"],description:"Pain reliever and fever reducer",commonSideEffects:["liver damage with overdose"],withdrawalRisk:"none",taperingRequired:!1},{name:"Diphenhydramine",brandNames:["Benadryl"],category:"over-the-counter",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["12.5","25","50"],commonUnits:["mg"],commonFrequencies:["every-6-hours","once-daily"],description:"Antihistamine for allergies and sleep",commonSideEffects:["drowsiness","dry mouth","confusion in elderly"],withdrawalRisk:"none",taperingRequired:!1},{name:"Vitamin D3",brandNames:["Cholecalciferol"],category:"vitamin",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["400","800","1000","2000","4000","5000","10000"],commonUnits:["iu"],commonFrequencies:["once-daily"],description:"Essential vitamin for bone health and immune function",commonSideEffects:["nausea","vomiting","kidney stones with excess"],withdrawalRisk:"none",taperingRequired:!1,psychologicalSupport:{adherenceFactors:["bone health goals","mood support","immune health"],motivationalMessages:["Your Vitamin D supports strong bones and immune health","Daily supplementation helps maintain optimal levels","You're taking a proactive step for your long-term health"],riskTriggers:[]}},{name:"Vitamin B12",brandNames:["Cyanocobalamin","Methylcobalamin"],category:"vitamin",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["100","250","500","1000","2500"],commonUnits:["mcg"],commonFrequencies:["once-daily"],description:"Essential vitamin for nerve function and energy metabolism",withdrawalRisk:"none",taperingRequired:!1},{name:"Vitamin C",brandNames:["Ascorbic Acid"],category:"vitamin",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Antioxidant vitamin for immune support",withdrawalRisk:"none",taperingRequired:!1},{name:"Multivitamin",category:"vitamin",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["1"],commonUnits:["tablets"],commonFrequencies:["once-daily"],description:"Comprehensive vitamin and mineral supplement",withdrawalRisk:"none",taperingRequired:!1},{name:"Magnesium",brandNames:["Magnesium Oxide","Magnesium Glycinate","Magnesium Citrate"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["200","400","500"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Essential mineral for muscle and nerve function",commonSideEffects:["diarrhea","stomach upset"],withdrawalRisk:"none",taperingRequired:!1},{name:"Calcium",brandNames:["Calcium Carbonate","Calcium Citrate"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","600","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Essential mineral for bone health",commonSideEffects:["constipation","kidney stones"],withdrawalRisk:"none",taperingRequired:!1},{name:"Iron",brandNames:["Ferrous Sulfate","Ferrous Gluconate"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["18","25","65"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Essential mineral for blood health",commonSideEffects:["constipation","stomach upset","dark stools"],withdrawalRisk:"none",taperingRequired:!1},{name:"Zinc",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["8","15","30","50"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Essential mineral for immune function",commonSideEffects:["nausea","stomach upset"],withdrawalRisk:"none",taperingRequired:!1},{name:"Fish Oil",brandNames:["Omega-3","EPA/DHA"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000","1200"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Omega-3 fatty acids for heart and brain health",commonSideEffects:["fishy aftertaste","stomach upset"],withdrawalRisk:"none",taperingRequired:!1},{name:"Flaxseed Oil",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["1000","1300"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Plant-based omega-3 fatty acids",withdrawalRisk:"none",taperingRequired:!1},{name:"Probiotics",brandNames:["Lactobacillus","Bifidobacterium"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["1","5","10","50"],commonUnits:["billion CFU"],commonFrequencies:["once-daily"],description:"Beneficial bacteria for digestive health",commonSideEffects:["gas","bloating"],withdrawalRisk:"none",taperingRequired:!1},{name:"St. John's Wort",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"low",commonDosages:["300","450","600"],commonUnits:["mg"],commonFrequencies:["once-daily","three-times-daily"],description:"Herbal supplement traditionally used for mood support",commonSideEffects:["photosensitivity","drug interactions"],commonInteractions:["antidepressants","birth control","blood thinners"],withdrawalRisk:"low",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:2,reductionPercent:50,notes:"Gradual reduction recommended to prevent mood changes."},psychologicalSupport:{adherenceFactors:["mood support","natural approach preference"],motivationalMessages:["Your herbal supplement supports natural mood balance","Consistent use helps maintain steady herbal benefits"],riskTriggers:["mood changes","drug interactions"]}},{name:"Valerian Root",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"low",commonDosages:["300","450","600"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Herbal supplement for sleep and relaxation",commonSideEffects:["drowsiness","headache","stomach upset"],withdrawalRisk:"low",taperingRequired:!1,taperingRecommendations:{method:"linear",durationWeeks:1,reductionPercent:50,notes:"May cause rebound insomnia if stopped abruptly."}},{name:"Ginkgo Biloba",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["40","60","120","240"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Herbal supplement for cognitive support",commonSideEffects:["headache","dizziness","stomach upset"],commonInteractions:["blood thinners","seizure medications"],withdrawalRisk:"none",taperingRequired:!1},{name:"Ginseng",brandNames:["American Ginseng","Asian Ginseng","Panax Ginseng"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["100","200","400"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Herbal supplement for energy and immune support",commonSideEffects:["insomnia","headache","digestive upset"],withdrawalRisk:"none",taperingRequired:!1},{name:"Echinacea",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","400","500"],commonUnits:["mg"],commonFrequencies:["three-times-daily"],description:"Herbal supplement for immune support",commonSideEffects:["nausea","dizziness","allergic reactions"],withdrawalRisk:"none",taperingRequired:!1},{name:"Turmeric/Curcumin",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","750","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Anti-inflammatory herbal supplement",commonSideEffects:["stomach upset","increased bleeding risk"],commonInteractions:["blood thinners","diabetes medications"],withdrawalRisk:"none",taperingRequired:!1},{name:"Ashwagandha",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","300","500","600"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Adaptogenic herb for stress support",commonSideEffects:["drowsiness","stomach upset","diarrhea"],withdrawalRisk:"none",taperingRequired:!1},{name:"Rhodiola Rosea",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["200","300","400"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Adaptogenic herb for stress and fatigue",commonSideEffects:["dizziness","headache","insomnia"],withdrawalRisk:"none",taperingRequired:!1},{name:"Milk Thistle",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["175","200","250"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Herbal supplement for liver support",commonSideEffects:["nausea","diarrhea","bloating"],withdrawalRisk:"none",taperingRequired:!1},{name:"Saw Palmetto",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["160","320"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Herbal supplement for prostate health",commonSideEffects:["stomach upset","headache","dizziness"],withdrawalRisk:"none",taperingRequired:!1},{name:"Kratom",brandNames:["Mitragyna speciosa"],category:"herbal",dependencyRiskCategory:"opioid",riskLevel:"high",commonDosages:["1","2","3","4","5","6","7","8"],commonUnits:["g"],commonFrequencies:["twice-daily","three-times-daily","as-needed"],description:"Plant-based substance with opioid-like effects; legal status varies by location",commonSideEffects:["nausea","constipation","dizziness","drowsiness","dependence","tolerance"],commonInteractions:["opioids","alcohol","benzodiazepines","MAO inhibitors"],withdrawalRisk:"high",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:8,reductionPercent:10,notes:"Can cause significant withdrawal symptoms including anxiety, muscle aches, and cravings. Use hyperbolic taper: 10% of current dose every 1-2 weeks. Medical supervision recommended."},psychologicalSupport:{adherenceFactors:["withdrawal avoidance","pain management","mood regulation"],motivationalMessages:["Managing kratom use responsibly helps prevent dependence","Gradual reduction is safer than abrupt cessation","Consider discussing alternatives with a healthcare provider"],riskTriggers:["dose escalation","multiple daily doses","using for mood regulation"]}},{name:"Kava",brandNames:["Piper methysticum","Kava Kava"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"moderate",commonDosages:["50","100","200","300"],commonUnits:["mg"],commonFrequencies:["once-daily","as-needed"],description:"Pacific Island plant used for anxiety and relaxation",commonSideEffects:["liver toxicity","skin changes","drowsiness","nausea"],commonInteractions:["alcohol","hepatotoxic drugs","benzodiazepines"],withdrawalRisk:"low",taperingRequired:!1,psychologicalSupport:{adherenceFactors:["anxiety management","sleep support","natural preference"],motivationalMessages:["Monitor liver function while using kava","Natural anxiety support can be effective when used safely"],riskTriggers:["liver symptoms","skin changes","combining with alcohol"]}},{name:"Passionflower",brandNames:["Passiflora incarnata"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500","750"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Herbal supplement for anxiety and sleep support",commonSideEffects:["drowsiness","dizziness","confusion"],withdrawalRisk:"none",taperingRequired:!1},{name:"Lemon Balm",brandNames:["Melissa officinalis"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","500","600"],commonUnits:["mg"],commonFrequencies:["twice-daily","three-times-daily"],description:"Calming herb for stress and sleep",commonSideEffects:["drowsiness","nausea"],withdrawalRisk:"none",taperingRequired:!1},{name:"Chamomile",brandNames:["Matricaria chamomilla"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["220","350","400"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Gentle herb for relaxation and digestive support",commonSideEffects:["allergic reactions","drowsiness"],withdrawalRisk:"none",taperingRequired:!1},{name:"Skullcap",brandNames:["Scutellaria lateriflora"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","400","500"],commonUnits:["mg"],commonFrequencies:["twice-daily","three-times-daily"],description:"Nervine herb for anxiety and nervous tension",commonSideEffects:["drowsiness","giddiness"],withdrawalRisk:"none",taperingRequired:!1},{name:"Blue Lotus",brandNames:["Nymphaea caerulea"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","as-needed"],description:"Traditional herb for relaxation and dream enhancement",commonSideEffects:["drowsiness","vivid dreams"],withdrawalRisk:"none",taperingRequired:!1},{name:"Wild Dagga",brandNames:["Leonotis leonurus"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","as-needed"],description:"African herb with mild psychoactive properties",commonSideEffects:["mild euphoria","relaxation"],withdrawalRisk:"none",taperingRequired:!1},{name:"L-Theanine",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["100","200","400"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Amino acid for relaxation and focus",commonSideEffects:["headache","dizziness"],withdrawalRisk:"none",taperingRequired:!1},{name:"5-HTP",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"low",commonDosages:["50","100","200"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Amino acid precursor to serotonin",commonSideEffects:["nausea","drowsiness","muscle pain"],commonInteractions:["antidepressants","carbidopa"],withdrawalRisk:"low",taperingRequired:!1},{name:"GABA",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500","750"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Neurotransmitter supplement for relaxation",commonSideEffects:["drowsiness","tingling sensation"],withdrawalRisk:"none",taperingRequired:!1},{name:"Phenibut",category:"herbal",dependencyRiskCategory:"benzodiazepine",riskLevel:"high",commonDosages:["250","500","750","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"GABA-B agonist with anxiolytic and nootropic effects; high addiction potential",commonSideEffects:["sedation","tolerance","dependence","withdrawal"],withdrawalRisk:"severe",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:12,reductionPercent:10,notes:"Extremely dangerous withdrawal similar to benzodiazepines. Medical supervision essential. Can cause seizures if stopped abruptly. Use hyperbolic taper: 10% of current dose every 2-3 weeks."},psychologicalSupport:{adherenceFactors:["anxiety management","withdrawal fear","tolerance issues"],motivationalMessages:["Tapering phenibut safely requires patience and medical support","Gradual reduction prevents dangerous withdrawal symptoms"],riskTriggers:["dose escalation","daily use","tolerance development"]}},{name:"CBD",brandNames:["Cannabidiol"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["5","10","15","20","25","50"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Non-psychoactive cannabinoid for anxiety, pain, and inflammation",commonSideEffects:["fatigue","diarrhea","appetite changes"],commonInteractions:["blood thinners","seizure medications"],withdrawalRisk:"none",taperingRequired:!1},{name:"Lion's Mane",brandNames:["Hericium erinaceus"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000","1500"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Medicinal mushroom for cognitive support and nerve health",commonSideEffects:["skin rash","nausea"],withdrawalRisk:"none",taperingRequired:!1},{name:"Reishi",brandNames:["Ganoderma lucidum"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000","1500"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Adaptogenic mushroom for stress and immune support",commonSideEffects:["dizziness","skin rash","upset stomach"],withdrawalRisk:"none",taperingRequired:!1},{name:"Cordyceps",brandNames:["Cordyceps sinensis","Cordyceps militaris"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Medicinal mushroom for energy and athletic performance",commonSideEffects:["nausea","diarrhea"],withdrawalRisk:"none",taperingRequired:!1},{name:"Bacopa Monnieri",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","600","900"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Ayurvedic herb for memory and cognitive enhancement",commonSideEffects:["nausea","cramping","bloating","fatigue"],withdrawalRisk:"none",taperingRequired:!1},{name:"Gotu Kola",brandNames:["Centella asiatica"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500","1000"],commonUnits:["mg"],commonFrequencies:["twice-daily"],description:"Traditional herb for cognitive function and circulation",commonSideEffects:["headache","stomach upset","dizziness"],withdrawalRisk:"none",taperingRequired:!1},{name:"Mucuna Pruriens",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"low",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"L-DOPA containing bean for mood and motor function",commonSideEffects:["nausea","bloating","insomnia"],commonInteractions:["MAO inhibitors","antipsychotics"],withdrawalRisk:"low",taperingRequired:!1},{name:"Gabapentin",brandNames:["Neurontin"],category:"prescription",dependencyRiskCategory:"anticonvulsant",riskLevel:"moderate",commonDosages:["100","300","400","600","800"],commonUnits:["mg"],commonFrequencies:["three-times-daily"],description:"Anticonvulsant for neuropathic pain and seizures",commonSideEffects:["dizziness","fatigue","weight gain","coordination problems"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:6,reductionPercent:10,notes:"Reduce gradually using hyperbolic taper to prevent withdrawal seizures and rebound symptoms. 10% of current dose every 1-2 weeks."}},{name:"Pregabalin",brandNames:["Lyrica"],category:"prescription",dependencyRiskCategory:"anticonvulsant",riskLevel:"moderate",commonDosages:["25","50","75","100","150","225","300"],commonUnits:["mg"],commonFrequencies:["twice-daily","three-times-daily"],description:"Anticonvulsant for neuropathic pain and anxiety",commonSideEffects:["dizziness","drowsiness","weight gain","blurred vision"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:2,reductionPercent:25,notes:"Gradual reduction recommended to prevent withdrawal symptoms."}},{name:"Venlafaxine",brandNames:["Effexor","Effexor XR"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"moderate",commonDosages:["37.5","75","150","225"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"SNRI antidepressant for depression and anxiety",commonSideEffects:["nausea","dizziness","insomnia","sweating"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:12,reductionPercent:10,notes:"Known for severe discontinuation syndrome. Hyperbolic taper essential: 10% of current dose every 2-3 weeks. Consider tapering strips if available."}},{name:"Duloxetine",brandNames:["Cymbalta"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"moderate",commonDosages:["20","30","40","60"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"SNRI antidepressant for depression and pain",commonSideEffects:["nausea","dry mouth","constipation","fatigue"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:8,reductionPercent:10,notes:"Discontinuation syndrome common. Hyperbolic taper advised: 10% of current dose every 2 weeks."}},{name:"Paroxetine",brandNames:["Paxil","Pexeva"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"moderate",commonDosages:["10","20","30","40"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"SSRI antidepressant with short half-life",commonSideEffects:["nausea","drowsiness","sexual dysfunction","weight gain"],withdrawalRisk:"high",taperingRequired:!0,taperingRecommendations:{method:"hyperbolic",durationWeeks:16,reductionPercent:5,notes:"Notorious for severe withdrawal. Extremely slow hyperbolic taper required due to short half-life. 5% of current dose every 2-3 weeks. Consider switching to fluoxetine first."}},{name:"Melatonin",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["0.5","1","3","5","10"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Natural hormone for sleep regulation",commonSideEffects:["daytime drowsiness","headache","dizziness"],withdrawalRisk:"none",taperingRequired:!1,psychologicalSupport:{adherenceFactors:["sleep quality","natural sleep aid preference"],motivationalMessages:["Your melatonin supports natural sleep cycles","Consistent timing helps regulate your sleep-wake cycle"],riskTriggers:[]}},{name:"CoQ10",brandNames:["Coenzyme Q10","Ubiquinone"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["30","60","100","200"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Antioxidant supplement for cellular energy",commonSideEffects:["stomach upset","loss of appetite"],withdrawalRisk:"none",taperingRequired:!1},{name:"Glucosamine",brandNames:["Glucosamine Sulfate","Glucosamine HCl"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","750","1000","1500"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Joint health supplement",commonSideEffects:["nausea","heartburn","diarrhea"],withdrawalRisk:"none",taperingRequired:!1},{name:"Chondroitin",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["400","600","800","1200"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Joint health supplement often combined with glucosamine",commonSideEffects:["nausea","stomach pain","constipation"],withdrawalRisk:"none",taperingRequired:!1},{name:"Modafinil",brandNames:["Provigil"],category:"prescription",dependencyRiskCategory:"stimulant",riskLevel:"moderate",commonDosages:["100","200"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Wakefulness-promoting agent for narcolepsy and shift work",commonSideEffects:["headache","nausea","nervousness","insomnia"],withdrawalRisk:"low",taperingRequired:!1},{name:"Piracetam",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["800","1200","1600"],commonUnits:["mg"],commonFrequencies:["twice-daily","three-times-daily"],description:"Original nootropic compound for cognitive enhancement",commonSideEffects:["nervousness","insomnia","depression"],withdrawalRisk:"none",taperingRequired:!1},{name:"Alpha-GPC",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","600"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Choline compound for cognitive function and acetylcholine",commonSideEffects:["heartburn","headache","insomnia"],withdrawalRisk:"none",taperingRequired:!1},{name:"Huperzine A",category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["50","100","200"],commonUnits:["mcg"],commonFrequencies:["once-daily"],description:"Alkaloid from Chinese club moss for memory enhancement",commonSideEffects:["nausea","diarrhea","vomiting"],withdrawalRisk:"none",taperingRequired:!1},{name:"Phosphatidylserine",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["100","200","300"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Phospholipid for brain health and cognitive function",commonSideEffects:["insomnia","stomach upset"],withdrawalRisk:"none",taperingRequired:!1},{name:"Holy Basil",brandNames:["Ocimum sanctum","Tulsi"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","500","1000"],commonUnits:["mg"],commonFrequencies:["twice-daily"],description:"Sacred herb for stress reduction and immune support",commonSideEffects:["blood sugar changes","bleeding risk"],withdrawalRisk:"none",taperingRequired:!1},{name:"Schisandra",brandNames:["Schisandra chinensis"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Traditional Chinese herb for liver health and adaptation",commonSideEffects:["heartburn","stomach upset","decreased appetite"],withdrawalRisk:"none",taperingRequired:!1},{name:"Eleuthero",brandNames:["Eleutherococcus senticosus","Siberian Ginseng"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["300","400","500"],commonUnits:["mg"],commonFrequencies:["twice-daily"],description:"Adaptogenic herb for energy and stress resistance",commonSideEffects:["insomnia","irritability","melancholy"],withdrawalRisk:"none",taperingRequired:!1},{name:"He Shou Wu",brandNames:["Polygonum multiflorum","Fo-Ti"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"low",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Traditional Chinese herb for longevity and hair health",commonSideEffects:["liver toxicity","diarrhea","nausea"],commonInteractions:["hepatotoxic drugs"],withdrawalRisk:"none",taperingRequired:!1},{name:"Bupropion",brandNames:["Wellbutrin","Zyban"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"low",commonDosages:["75","100","150","300"],commonUnits:["mg"],commonFrequencies:["twice-daily"],description:"Atypical antidepressant and smoking cessation aid",commonSideEffects:["dry mouth","insomnia","headache","nausea"],withdrawalRisk:"low",taperingRequired:!1},{name:"Mirtazapine",brandNames:["Remeron"],category:"prescription",dependencyRiskCategory:"antidepressant",riskLevel:"low",commonDosages:["15","30","45"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Tetracyclic antidepressant with sedating properties",commonSideEffects:["sedation","weight gain","increased appetite"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:3,reductionPercent:33,notes:"Gradual reduction recommended to prevent rebound insomnia and flu-like symptoms."}},{name:"Quetiapine",brandNames:["Seroquel"],category:"prescription",dependencyRiskCategory:"low-risk",riskLevel:"moderate",commonDosages:["25","50","100","200","300","400"],commonUnits:["mg"],commonFrequencies:["once-daily","twice-daily"],description:"Atypical antipsychotic for schizophrenia and bipolar disorder",commonSideEffects:["sedation","weight gain","metabolic changes"],withdrawalRisk:"moderate",taperingRequired:!0,taperingRecommendations:{method:"linear",durationWeeks:6,reductionPercent:25,notes:"Slow taper required to prevent rebound psychosis and withdrawal symptoms."}},{name:"Damiana",brandNames:["Turnera diffusa"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["400","800"],commonUnits:["mg"],commonFrequencies:["once-daily","as-needed"],description:"Traditional herb for mood and sexual health",commonSideEffects:["mild euphoria","relaxation"],withdrawalRisk:"none",taperingRequired:!1},{name:"Calea Zacatechichi",brandNames:["Dream Herb"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Traditional Mexican herb for dream enhancement",commonSideEffects:["vivid dreams","nausea","bitter taste"],withdrawalRisk:"none",taperingRequired:!1},{name:"Mulungu",brandNames:["Erythrina mulungu"],category:"herbal",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Brazilian tree bark for anxiety and sleep",commonSideEffects:["sedation","muscle relaxation"],withdrawalRisk:"none",taperingRequired:!1},{name:"NAD+",brandNames:["Nicotinamide Adenine Dinucleotide"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Cellular energy coenzyme for longevity and metabolism",commonSideEffects:["nausea","fatigue","headache"],withdrawalRisk:"none",taperingRequired:!1},{name:"NMN",brandNames:["Nicotinamide Mononucleotide"],category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500","1000"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"NAD+ precursor for cellular health and aging",commonSideEffects:["nausea","flushing"],withdrawalRisk:"none",taperingRequired:!1},{name:"Resveratrol",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["100","250","500"],commonUnits:["mg"],commonFrequencies:["once-daily"],description:"Polyphenol antioxidant for longevity and cardiovascular health",commonSideEffects:["nausea","diarrhea","skin rash"],withdrawalRisk:"none",taperingRequired:!1},{name:"Quercetin",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["250","500","1000"],commonUnits:["mg"],commonFrequencies:["twice-daily"],description:"Flavonoid with anti-inflammatory and antioxidant properties",commonSideEffects:["headache","nausea"],withdrawalRisk:"none",taperingRequired:!1},{name:"Berberine",category:"supplement",dependencyRiskCategory:"low-risk",riskLevel:"minimal",commonDosages:["500","1000"],commonUnits:["mg"],commonFrequencies:["twice-daily"],description:"Plant alkaloid for blood sugar and metabolic health",commonSideEffects:["diarrhea","constipation","gas"],commonInteractions:["diabetes medications","blood thinners"],withdrawalRisk:"none",taperingRequired:!1}];function Ql(s){if(!s.trim())return Kt;const a=s.toLowerCase();return Kt.filter(t=>{var n,r,i;return t.name.toLowerCase().includes(a)||((n=t.genericName)==null?void 0:n.toLowerCase().includes(a))||((r=t.brandNames)==null?void 0:r.some(l=>l.toLowerCase().includes(a)))||((i=t.description)==null?void 0:i.toLowerCase().includes(a))})}function _s(s){const a=s.toLowerCase();return Kt.find(t=>{var n,r;return t.name.toLowerCase()===a||((n=t.genericName)==null?void 0:n.toLowerCase())===a||((r=t.brandNames)==null?void 0:r.some(i=>i.toLowerCase()===a))})}function wn(s,a,t){const n=_s(s);if(!(n!=null&&n.taperingRequired)||!n.taperingRecommendations)return null;const r=n.taperingRecommendations,i=r.durationWeeks*7,l=[];if(r.method==="linear"){const d=a*(r.reductionPercent/100)/r.durationWeeks;for(let m=1;m<=r.durationWeeks;m++){const x=Math.max(0,a-d*m);l.push({day:m*7,dose:Math.round(x*100)/100,notes:`Week ${m}: Reduce to ${Math.round(x*100)/100} ${t}`})}}else if(r.method==="exponential")for(let d=1;d<=r.durationWeeks;d++){const m=d/r.durationWeeks,x=1-Math.pow(1-m,2),y=a*(1-x*(r.reductionPercent/100));l.push({day:d*7,dose:Math.round(y*100)/100,notes:`Week ${d}: Reduce to ${Math.round(y*100)/100} ${t}`})}else if(r.method==="hyperbolic"){let d=a;const m=r.reductionPercent/100,x=n.dependencyRiskCategory==="benzodiazepine"?.5:1,y=Math.ceil(r.durationWeeks*x);for(let R=1;R<=y;R++){d=d*(1-m);const k=Math.round(R/x*7);if(l.push({day:k,dose:Math.round(d*1e3)/1e3,notes:`Step ${R} (Day ${k}): Reduce to ${Math.round(d*1e3)/1e3} ${t} (${r.reductionPercent}% reduction from previous)`}),d<.001)break}l.length>0&&l[l.length-1].dose>.001&&l.push({day:l[l.length-1].day+7,dose:0,notes:"Final step: Complete discontinuation"})}const o=["Consult with your healthcare provider before starting any tapering schedule","Monitor for withdrawal symptoms and adjust pace if necessary","Never stop abruptly if experiencing severe withdrawal symptoms"],c=[];return n.dependencyRiskCategory==="benzodiazepine"&&c.push("Risk of seizures - medical supervision essential","Consider switching to longer-acting benzodiazepine first","Be prepared to pause or slow the taper if withdrawal symptoms are severe"),n.dependencyRiskCategory==="opioid"&&c.push("Monitor for pain flares and have backup pain management plan","Watch for signs of psychological distress during taper"),n.dependencyRiskCategory==="antidepressant"&&c.push("Monitor mood carefully during taper","Consider postponing taper during times of high stress","Discontinuation syndrome can mimic flu-like symptoms"),{medicationName:n.name,method:r.method,totalDuration:i,steps:l,warnings:[...o,...c,...r.notes?[r.notes]:[]],riskLevel:n.withdrawalRisk,canPause:!0,flexibilityNotes:"This schedule can be paused or slowed at any point if withdrawal symptoms become problematic. Patient comfort and safety should always take priority over adherence to timeline."}}function kn(s,a,t,n){const r=_s(s);if(!(r!=null&&r.taperingRequired)||!r.taperingRecommendations)return null;const i=new Date(n.startDate),o=Math.floor((new Date().getTime()-i.getTime())/(1e3*60*60*24*30)),c={...r.taperingRecommendations};let d=c.durationWeeks,m=c.reductionPercent,x=c.method;o>=12?(d=Math.ceil(d*1.5),m=Math.max(5,m*.7)):o>=6?(d=Math.ceil(d*1.3),m=Math.max(5,m*.8)):o>=3&&(d=Math.ceil(d*1.1));const y=r.commonDosages.length>0?r.commonDosages.reduce((R,k)=>R+parseFloat(k),0)/r.commonDosages.length:a;return a>y*1.5&&(d=Math.ceil(d*1.2),m=Math.max(5,m*.9)),r.dependencyRiskCategory==="benzodiazepine"?(x="hyperbolic",o>=6&&(d=Math.ceil(d*1.3),m=Math.min(m,10))):r.dependencyRiskCategory==="antidepressant"&&(r.name.toLowerCase().includes("paroxetine")||r.name.toLowerCase().includes("venlafaxine"))&&(x="hyperbolic",m=Math.min(m,5)),{originalPlan:c,adjustedPlan:{method:x,durationWeeks:d,reductionPercent:m,notes:c.notes},adjustmentReasons:[o>=12?`Extended taper recommended: You've been taking ${s} for ${o} months`:o>=6?`Slower taper suggested: ${o} months of use requires more gradual reduction`:o>=3?`Moderately slower taper: ${o} months of use`:null,a>y*1.5?`Higher dose detected: ${a}${t} is above average, slower taper recommended`:null,r.dependencyRiskCategory==="benzodiazepine"?"Benzodiazepine detected: Extra-slow hyperbolic taper essential for safety":null,r.withdrawalRisk==="severe"?"High withdrawal risk: Extended timeline prioritizes safety":null].filter(Boolean),monthsOnMedication:o,riskFactors:{longTermUse:o>=6,highDose:a>y*1.5,highRiskMedication:r.withdrawalRisk==="severe",benzodiazepine:r.dependencyRiskCategory==="benzodiazepine"}}}function Pa(s,a,t,n,r){const i=kn(s,a,t,n);if(!i)return null;const l={method:(r==null?void 0:r.preferredMethod)||i.adjustedPlan.method,durationWeeks:(r==null?void 0:r.preferredDuration)||i.adjustedPlan.durationWeeks,reductionPercent:(r==null?void 0:r.preferredReduction)||i.adjustedPlan.reductionPercent,notes:i.adjustedPlan.notes},o=wn(s,a,t);return o?{...o,method:l.method,intelligentRecommendations:i,customizationUsed:!!r,includeStabilizationPeriods:(r==null?void 0:r.includeStabilizationPeriods)||!1}:null}function Xl(s,a){const t=_s(s);if(!t)return 7;let r={mild:3,moderate:7,severe:14}[a];return t.dependencyRiskCategory==="benzodiazepine"?r*=2:t.dependencyRiskCategory==="antidepressant"&&(r*=1.5),Math.min(r,30)}function eo(s,a=10){return Ql(s).slice(0,a).map(n=>({name:n.name,category:n.category,riskLevel:n.riskLevel,description:n.description||""}))}const so={id:ee(),name:"",preferences:{theme:"system",notifications:{push:!0,sound:!0,vibration:!0,reminderAdvance:15},privacy:{shareData:!1,analytics:!0,anonymousReporting:{enabled:!1,consentGiven:!1,dataTypesAllowed:[],privacyLevel:"minimal",granularControls:{includeAdherence:!1,includeSideEffects:!1,includeMedicationPatterns:!1,includeRiskAssessments:!1,allowTemporalAnalysis:!1,allowDemographicAnalysis:!1}}},display:{timeFormat:"12h",dateFormat:"MM/DD/YYYY",defaultView:"dashboard"}},createdAt:new Date,updatedAt:new Date},ae=Yl()(Zl((s,a)=>({medications:[],logs:[],reminders:[],userProfile:null,isLoading:!1,error:null,smartMessages:[],cyclicDosingPatterns:[],taperingSchedules:[],psychologicalInterventions:[],adherencePatterns:[],dependencyRiskAssessments:[],addMedication:t=>{const n=hs(t.name),r=Ms(n),i={...t,id:ee(),riskLevel:r,dependencyRiskCategory:n,createdAt:new Date,updatedAt:new Date};s(l=>({medications:[...l.medications,i]})),(r==="high"||r==="moderate")&&setTimeout(()=>{a().updateRiskAssessment(i.id)},100)},updateMedication:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t?{...i,...n,updatedAt:new Date}:i)}))},deleteMedication:t=>{s(n=>({medications:n.medications.filter(r=>r.id!==t),logs:n.logs.filter(r=>r.medicationId!==t),reminders:n.reminders.filter(r=>r.medicationId!==t)}))},toggleMedicationActive:t=>{s(n=>({medications:n.medications.map(r=>r.id===t?{...r,isActive:!r.isActive,updatedAt:new Date}:r)}))},logMedication:(t,n,r,i)=>{var c,d;const l=a().medications.find(m=>m.id===t);if(!l)return;const o={id:ee(),medicationId:t,timestamp:new Date,dosageTaken:n||parseFloat(l.dosage),unit:l.unit,notes:r,sideEffectsReported:i,adherence:"taken",createdAt:new Date};if(s(m=>({logs:[...m.logs,o]})),l.useMultiplePills&&l.pillInventory&&l.pillInventory.length>0){const m=((c=l.doseConfigurations)==null?void 0:c.find(x=>x.id===l.defaultDoseConfigurationId))||((d=l.doseConfigurations)==null?void 0:d[0]);if(m){const y=m.pillComponents.map(R=>({pillConfigurationId:R.pillConfigurationId,quantityTaken:R.quantity,timestamp:new Date})).map(R=>({pillConfigurationId:R.pillConfigurationId,currentCount:-R.quantityTaken}));a().updatePillInventory(t,y)}}},updateLog:(t,n)=>{s(r=>({logs:r.logs.map(i=>i.id===t?{...i,...n}:i)}))},deleteLog:t=>{s(n=>({logs:n.logs.filter(r=>r.id!==t)}))},markMedicationTaken:(t,n)=>{a().logMedication(t,n)},markMedicationMissed:t=>{const n=a().medications.find(i=>i.id===t);if(!n)return;const r={id:ee(),medicationId:t,timestamp:new Date,dosageTaken:0,unit:n.unit,adherence:"missed",createdAt:new Date};s(i=>({logs:[...i.logs,r]}))},addReminder:t=>{const n={...t,id:ee(),createdAt:new Date,updatedAt:new Date};s(r=>({reminders:[...r.reminders,n]}))},updateReminder:(t,n)=>{s(r=>({reminders:r.reminders.map(i=>i.id===t?{...i,...n,updatedAt:new Date}:i)}))},deleteReminder:t=>{s(n=>({reminders:n.reminders.filter(r=>r.id!==t)}))},toggleReminderActive:t=>{s(n=>({reminders:n.reminders.map(r=>r.id===t?{...r,isActive:!r.isActive,updatedAt:new Date}:r)}))},snoozeReminder:(t,n)=>{const r=new Date;r.setMinutes(r.getMinutes()+n),s(i=>({reminders:i.reminders.map(l=>l.id===t?{...l,snoozeUntil:r,updatedAt:new Date}:l)}))},updateProfile:t=>{s(n=>({userProfile:n.userProfile?{...n.userProfile,...t,updatedAt:new Date}:{...so,...t}}))},createProfile:t=>{const n={...t,id:ee(),createdAt:new Date,updatedAt:new Date};s({userProfile:n})},getMedicationAdherence:(t,n)=>{const r=a().logs.filter(l=>{const o=new Date(l.timestamp),c=Math.floor((Date.now()-o.getTime())/(1e3*60*60*24));return l.medicationId===t&&c<=n});if(r.length===0)return 0;const i=r.filter(l=>l.adherence==="taken");return Math.round(i.length/r.length*100)},getTodaysReminders:()=>{const t=a().medications,n=a().reminders,r=new Date().getDay(),l=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][r];return n.filter(o=>{const c=t.find(d=>d.id===o.medicationId);return o.isActive&&(c==null?void 0:c.isActive)&&o.days.includes(l)&&(!o.snoozeUntil||o.snoozeUntil<=new Date)}).map(o=>({...o,medication:t.find(c=>c.id===o.medicationId)})).sort((o,c)=>o.time.localeCompare(c.time))},getTodaysLogs:()=>a().logs.filter(t=>il(new Date(t.timestamp))),getMissedDoses:t=>a().logs.filter(r=>{const i=new Date(r.timestamp),l=Math.floor((Date.now()-i.getTime())/(1e3*60*60*24));return r.adherence==="missed"&&l<=t}).sort((r,i)=>new Date(i.timestamp).getTime()-new Date(r.timestamp).getTime()),getUpcomingRefills:()=>a().medications.filter(t=>!t.pillsRemaining||!t.totalPills||!t.refillReminder?!1:t.pillsRemaining/t.totalPills*100<=20),clearAllData:()=>{s({medications:[],logs:[],reminders:[],userProfile:null,error:null,smartMessages:[],cyclicDosingPatterns:[],taperingSchedules:[],psychologicalInterventions:[],adherencePatterns:[],dependencyRiskAssessments:[]})},importData:t=>{s(n=>({medications:t.medications||n.medications,logs:t.logs||n.logs,reminders:t.reminders||n.reminders,userProfile:t.userProfile||n.userProfile}))},exportData:()=>{const t=a();return{medications:t.medications,logs:t.logs,reminders:t.reminders,userProfile:t.userProfile,version:"1.0.0",lastSyncDate:new Date}},setLoading:t=>{s({isLoading:t})},setError:t=>{s({error:t})},exportDataWithOptions:async t=>{var i,l,o;const n=a();let r={};if(t.dateRange){const{start:c,end:d}=t.dateRange;r.logs=n.logs.filter(m=>{const x=new Date(m.timestamp);return x>=c&&x<=d})}else r.logs=n.logs;return t.includeMedications&&(r.medications=n.medications),t.includeReminders&&(r.reminders=n.reminders),t.includeProfile&&t.includePersonalInfo&&(r.userProfile=n.userProfile),t.includeAdvancedFeatures&&(r.smartMessages=n.smartMessages,r.cyclicDosingPatterns=n.cyclicDosingPatterns,r.taperingSchedules=n.taperingSchedules,r.psychologicalInterventions=n.psychologicalInterventions,r.adherencePatterns=n.adherencePatterns,r.dependencyRiskAssessments=n.dependencyRiskAssessments),r.exportMetadata={version:"2.0.0",exportDate:new Date,exportOptions:t,totalRecords:{medications:((i=r.medications)==null?void 0:i.length)||0,logs:((l=r.logs)==null?void 0:l.length)||0,reminders:((o=r.reminders)==null?void 0:o.length)||0,hasProfile:!!r.userProfile}},JSON.stringify(r,null,2)},importDataWithValidation:async t=>{const n=a().validateImportData(t);if(!n.isValid)return{success:!1,errors:n.errors,warnings:n.warnings};try{return a().backupData(),s(r=>{const i={...r};if(t.medications){const l=new Set(r.medications.map(c=>c.name)),o=t.medications.filter(c=>!l.has(c.name));i.medications=[...r.medications,...o.map(c=>({...c,id:ee(),createdAt:new Date,updatedAt:new Date}))]}return t.logs&&(i.logs=[...r.logs,...t.logs.map(l=>({...l,id:ee(),timestamp:new Date(l.timestamp),createdAt:new Date}))]),t.reminders&&(i.reminders=[...r.reminders,...t.reminders.map(l=>({...l,id:ee(),createdAt:new Date,updatedAt:new Date}))]),t.userProfile&&!r.userProfile&&(i.userProfile={...t.userProfile,id:ee(),createdAt:new Date,updatedAt:new Date}),i}),{success:!0,errors:[],warnings:n.warnings}}catch(r){return{success:!1,errors:[`Import failed: ${r instanceof Error?r.message:"Unknown error"}`],warnings:[]}}},validateImportData:t=>{var i;const n=[],r=[];return!t||typeof t!="object"?(n.push("Invalid data format: must be a valid JSON object"),{isValid:!1,errors:n,warnings:r}):(t.medications&&(Array.isArray(t.medications)?t.medications.forEach((l,o)=>{(!l.name||typeof l.name!="string")&&n.push(`Medication ${o+1}: name is required and must be a string`),(!l.dosage||typeof l.dosage!="string")&&n.push(`Medication ${o+1}: dosage is required and must be a string`),(!l.unit||typeof l.unit!="string")&&n.push(`Medication ${o+1}: unit is required and must be a string`),(!l.frequency||typeof l.frequency!="string")&&n.push(`Medication ${o+1}: frequency is required and must be a string`)}):n.push("Medications must be an array")),t.logs&&(Array.isArray(t.logs)?t.logs.forEach((l,o)=>{if((!l.medicationId||typeof l.medicationId!="string")&&n.push(`Log ${o+1}: medicationId is required and must be a string`),!l.timestamp)n.push(`Log ${o+1}: timestamp is required`);else{const c=new Date(l.timestamp);isNaN(c.getTime())&&n.push(`Log ${o+1}: invalid timestamp format`)}l.adherence&&!["taken","missed","skipped","partial"].includes(l.adherence)&&r.push(`Log ${o+1}: unknown adherence status '${l.adherence}'`)}):n.push("Logs must be an array")),t.reminders&&(Array.isArray(t.reminders)?t.reminders.forEach((l,o)=>{(!l.medicationId||typeof l.medicationId!="string")&&n.push(`Reminder ${o+1}: medicationId is required and must be a string`),(!l.time||typeof l.time!="string")&&n.push(`Reminder ${o+1}: time is required and must be a string`),(!l.days||!Array.isArray(l.days))&&n.push(`Reminder ${o+1}: days is required and must be an array`)}):n.push("Reminders must be an array")),(i=t.exportMetadata)!=null&&i.version&&t.exportMetadata.version!=="2.0.0"&&r.push(`Import data was exported with version ${t.exportMetadata.version}, some features may not be compatible`),{isValid:n.length===0,errors:n,warnings:r})},exportToCSV:(t,n)=>{const r=a();switch(t){case"medications":return Ps(r.medications.map(o=>({name:o.name,dosage:o.dosage,unit:o.unit,frequency:o.frequency,category:o.category,isActive:o.isActive,startDate:te(new Date(o.startDate)),riskLevel:o.riskLevel,prescribedBy:o.prescribedBy||"",pharmacy:o.pharmacy||"",notes:o.notes||""})));case"logs":let i=r.logs;return n&&(i=i.filter(o=>{const c=new Date(o.timestamp);return c>=n.start&&c<=n.end})),Ps(i.map(o=>{var d;const c=r.medications.find(m=>m.id===o.medicationId);return{date:te(new Date(o.timestamp)),time:Os(new Date(o.timestamp)),medication:(c==null?void 0:c.name)||"Unknown",dosageTaken:o.dosageTaken,unit:o.unit,adherence:o.adherence,notes:o.notes||"",sideEffects:((d=o.sideEffectsReported)==null?void 0:d.join("; "))||""}}));case"reminders":return Ps(r.reminders.map(o=>{const c=r.medications.find(d=>d.id===o.medicationId);return{medication:(c==null?void 0:c.name)||"Unknown",time:o.time,days:o.days.join(", "),isActive:o.isActive,customMessage:o.customMessage||"",notificationSound:o.notificationSound||!1}}));case"all":const l={medications:r.medications,logs:n?r.logs.filter(o=>{const c=new Date(o.timestamp);return c>=n.start&&c<=n.end}):r.logs,reminders:r.reminders,userProfile:r.userProfile,summary:{totalMedications:r.medications.length,activeMedications:r.medications.filter(o=>o.isActive).length,totalLogs:r.logs.length,totalReminders:r.reminders.length,exportDate:new Date}};return JSON.stringify(l,null,2);default:return""}},exportToPDF:async t=>await a().exportDataWithOptions(t),backupData:()=>{const t=a(),n={medications:t.medications,logs:t.logs,reminders:t.reminders,userProfile:t.userProfile,smartMessages:t.smartMessages,cyclicDosingPatterns:t.cyclicDosingPatterns,taperingSchedules:t.taperingSchedules,psychologicalInterventions:t.psychologicalInterventions,adherencePatterns:t.adherencePatterns,dependencyRiskAssessments:t.dependencyRiskAssessments,backupDate:new Date};localStorage.setItem(`medtrack-backup-${Date.now()}`,JSON.stringify(n));const r=Object.keys(localStorage).filter(i=>i.startsWith("medtrack-backup-"));r.length>5&&r.sort().slice(0,-5).forEach(i=>localStorage.removeItem(i))},restoreData:async t=>{try{const n=a().validateImportData(t);return n.isValid?(s({medications:t.medications||[],logs:t.logs||[],reminders:t.reminders||[],userProfile:t.userProfile||null,smartMessages:t.smartMessages||[],cyclicDosingPatterns:t.cyclicDosingPatterns||[],taperingSchedules:t.taperingSchedules||[],psychologicalInterventions:t.psychologicalInterventions||[],adherencePatterns:t.adherencePatterns||[],dependencyRiskAssessments:t.dependencyRiskAssessments||[]}),{success:!0,errors:[]}):{success:!1,errors:["Invalid backup data format",...n.errors]}}catch(n){return{success:!1,errors:[`Restore failed: ${n instanceof Error?n.message:"Unknown error"}`]}}},addSmartMessage:t=>{const n={...t,id:ee()};s(r=>({smartMessages:[...r.smartMessages,n]}))},markMessageAsRead:t=>{s(n=>({smartMessages:n.smartMessages.filter(r=>r.id!==t)}))},dismissMessage:t=>{s(n=>({smartMessages:n.smartMessages.filter(r=>r.id!==t)}))},generateContextualMessage:(t,n)=>{const{medications:r,logs:i}=a(),l=r.find(d=>d.id===t);if(!l)return;const o={adherenceStreak:i.filter(d=>d.medicationId===t&&d.adherence==="taken").length},c=gl(n,l.name,o);a().addSmartMessage({medicationId:t,type:n,priority:l.riskLevel==="high"?"high":"medium",title:c.title,message:c.message,psychologicalApproach:c.approach,scheduledTime:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3)})},addCyclicDosingPattern:t=>{const n={...t,id:ee()};s(r=>({cyclicDosingPatterns:[...r.cyclicDosingPatterns,n]}))},updateCyclicDosingPattern:(t,n)=>{s(r=>({cyclicDosingPatterns:r.cyclicDosingPatterns.map(i=>i.id===t?{...i,...n}:i)}))},deleteCyclicDosingPattern:t=>{s(n=>({cyclicDosingPatterns:n.cyclicDosingPatterns.filter(r=>r.id!==t)}))},getCurrentDose:t=>{var c;const{medications:n,cyclicDosingPatterns:r}=a(),i=n.find(d=>d.id===t);if(!i)return{dose:0,phase:"maintenance"};let l=parseFloat(i.dosage);if(i.useMultiplePills&&i.doseConfigurations){const d=i.doseConfigurations.find(m=>m.id===i.defaultDoseConfigurationId)||i.doseConfigurations[0];d&&(l=d.totalDoseAmount)}(c=i.tapering)!=null&&c.isActive&&(l=fn(l,i.tapering,new Date,i));const o=r.find(d=>{var m;return d.isActive&&((m=i.cyclicDosing)==null?void 0:m.id)===d.id});return ml(l,o,new Date)},addTaperingSchedule:t=>{const n={...t,id:ee()};s(r=>({taperingSchedules:[...r.taperingSchedules,n]}))},updateTaperingSchedule:(t,n)=>{s(r=>({taperingSchedules:r.taperingSchedules.map(i=>i.id===t?{...i,...n}:i)}))},deleteTaperingSchedule:t=>{s(n=>({taperingSchedules:n.taperingSchedules.filter(r=>r.id!==t)}))},pauseTaperingSchedule:(t,n="moderate")=>{s(r=>({medications:r.medications.map(i=>{if(i.id===t&&i.tapering&&!i.tapering.isPaused){const l=Xl(i.name,n);return{...i,tapering:{...i.tapering,isPaused:!0,pausedAt:new Date,suggestedResumeDays:l}}}return i})}))},resumeTaperingSchedule:t=>{s(n=>({medications:n.medications.map(r=>{if(r.id===t&&r.tapering&&r.tapering.isPaused){const i=r.tapering.pausedAt?Math.floor((new Date().getTime()-new Date(r.tapering.pausedAt).getTime())/864e5):0,l=new Date(r.tapering.endDate);return l.setDate(l.getDate()+i),{...r,tapering:{...r.tapering,isPaused:!1,pausedAt:void 0,endDate:l,suggestedResumeDays:void 0}}}return r})}))},adjustTaperingSchedule:(t,n)=>{s(r=>({medications:r.medications.map(i=>{if(i.id===t&&i.tapering){const l={...i.tapering};if(n.extendDurationWeeks){const o=n.extendDurationWeeks*7,c=new Date(l.endDate);c.setDate(c.getDate()+o),l.endDate=c}return n.changeMethod&&(l.taperingMethod=n.changeMethod),{...i,tapering:l}}return i})}))},assessDependencyRisk:t=>{const{medications:n,logs:r}=a(),i=n.find(c=>c.id===t);if(!i)return{medicationId:t,riskScore:0,riskFactors:[],lastAssessment:new Date,recommendedActions:[],escalationRequired:!1};const l=fl(r,i);return{medicationId:t,riskScore:l.riskScore,riskFactors:l.riskFactors.map(c=>({factor:"dose-escalation",weight:1,description:c,firstDetected:new Date,currentSeverity:"medium"})),lastAssessment:new Date,recommendedActions:l.recommendations,escalationRequired:l.riskScore>50}},updateRiskAssessment:t=>{const n=a().assessDependencyRisk(t);s(r=>({dependencyRiskAssessments:[...r.dependencyRiskAssessments.filter(i=>i.medicationId!==t),n]})),n.escalationRequired&&a().generateContextualMessage(t,"risk-alert")},getHighRiskMedications:()=>a().medications.filter(t=>t.riskLevel==="high"||t.riskLevel==="moderate"),analyzeAdherencePatterns:t=>{const{medications:n}=a();if(!n.find(o=>o.id===t))return{medicationId:t,weeklyAdherence:[],monthlyTrend:"stable",riskScore:0,concerningBehaviors:[],positivePatterns:[]};const i=a().getMedicationAdherence(t,7);return{medicationId:t,weeklyAdherence:[i],monthlyTrend:i>80?"stable":"declining",riskScore:100-i,concerningBehaviors:i<70?["Low adherence detected"]:[],positivePatterns:i>90?["Excellent adherence"]:[]}},detectBehaviorPattern:t=>{const{medications:n,logs:r}=a();if(!n.find(o=>o.id===t))return;yl(r).forEach(o=>{o.type==="weekend-gaps"?a().generateContextualMessage(t,"adherence-reminder"):o.type==="dose-timing-drift"&&a().generateContextualMessage(t,"motivation")})},triggerPsychologicalIntervention:(t,n,r)=>{const i={id:ee(),medicationId:t,type:n,trigger:r,message:"",timestamp:new Date};s(l=>({psychologicalInterventions:[...l.psychologicalInterventions,i]})),a().generateContextualMessage(t,n)},getSmartInsights:()=>{const{medications:t}=a(),n=[],r=t.filter(o=>o.riskLevel==="high");r.length>0&&n.push({type:"risk-alert",title:"High-Risk Medications Detected",description:`You have ${r.length} high-risk medication(s) that require careful monitoring.`,priority:"high",medications:r.map(o=>o.name)});const i=t.map(o=>a().getMedicationAdherence(o.id,7)),l=i.reduce((o,c)=>o+c,0)/i.length;return l<70?n.push({type:"adherence-concern",title:"Adherence Below Target",description:`Your average adherence is ${Math.round(l)}%. Consider setting more reminders.`,priority:"medium"}):l>90&&n.push({type:"celebration",title:"Excellent Adherence!",description:`Your adherence is ${Math.round(l)}%. Keep up the great work!`,priority:"low"}),n},getPsychologicalProfile:t=>{const n=a().medications.find(r=>r.id===t);return(n==null?void 0:n.psychologicalProfile)||null},getAdherenceScore:(t,n=30)=>a().getMedicationAdherence(t,n),addPillConfiguration:(t,n)=>{const r={...n,id:ee()};s(i=>({medications:i.medications.map(l=>l.id===t?{...l,pillConfigurations:[...l.pillConfigurations||[],r],updatedAt:new Date}:l)}))},updatePillConfiguration:(t,n,r)=>{s(i=>({medications:i.medications.map(l=>l.id===t?{...l,pillConfigurations:(l.pillConfigurations||[]).map(o=>o.id===n?{...o,...r}:o),updatedAt:new Date}:l)}))},deletePillConfiguration:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t?{...i,pillConfigurations:(i.pillConfigurations||[]).filter(l=>l.id!==n),updatedAt:new Date}:i)}))},addDoseConfiguration:(t,n)=>{const r={...n,id:ee()};s(i=>({medications:i.medications.map(l=>l.id===t?{...l,doseConfigurations:[...l.doseConfigurations||[],r],defaultDoseConfigurationId:l.defaultDoseConfigurationId||r.id,updatedAt:new Date}:l)}))},updateDoseConfiguration:(t,n,r)=>{s(i=>({medications:i.medications.map(l=>l.id===t?{...l,doseConfigurations:(l.doseConfigurations||[]).map(o=>o.id===n?{...o,...r}:o),updatedAt:new Date}:l)}))},deleteDoseConfiguration:(t,n)=>{s(r=>({medications:r.medications.map(i=>{var l;if(i.id===t){const o=(i.doseConfigurations||[]).filter(c=>c.id!==n);return{...i,doseConfigurations:o,defaultDoseConfigurationId:i.defaultDoseConfigurationId===n?((l=o[0])==null?void 0:l.id)||void 0:i.defaultDoseConfigurationId,updatedAt:new Date}}return i})}))},setDefaultDoseConfiguration:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t?{...i,defaultDoseConfigurationId:n,updatedAt:new Date}:i)}))},logMultiplePillDose:(t,n,r,i)=>{const l=a().medications.find(R=>R.id===t);if(!l)return;const o=n.reduce((R,k)=>R+k.quantityExpected,0),c=n.reduce((R,k)=>R+k.quantityTaken,0),d=o>0?c/o*100:0,m=d>0&&d<100,x={totalExpectedPills:o,totalTakenPills:c,partialDose:m,adherencePercentage:d},y={id:ee(),medicationId:t,timestamp:new Date,dosageTaken:c,unit:l.unit,notes:r,sideEffectsReported:i,adherence:d>=100?"taken":m?"partial":"missed",createdAt:new Date,pillsLogged:n,adherenceDetails:x,useMultiplePills:!0};if(s(R=>({logs:[...R.logs,y]})),l.pillInventory){const R=n.map(k=>({pillConfigurationId:k.pillConfigurationId,currentCount:-k.quantityTaken}));a().updatePillInventory(t,R)}},logDoseConfiguration:(t,n,r,i,l)=>{a().logMultiplePillDose(t,r,i,l);const o=a().logs,c=o[o.length-1];c&&c.medicationId===t&&a().updateLog(c.id,{doseConfigurationId:n})},calculateTotalDoseFromPills:(t,n)=>{const r=a().medications.find(c=>c.id===t);if(!(r!=null&&r.pillConfigurations)||!(r!=null&&r.doseConfigurations))return null;let i;if(n?i=r.doseConfigurations.find(c=>c.id===n):i=r.doseConfigurations.find(c=>c.id===r.defaultDoseConfigurationId)||r.doseConfigurations[0],!i)return null;let l=0,o=null;for(const c of i.pillComponents){const d=r.pillConfigurations.find(m=>m.id===c.pillConfigurationId);d&&(l+=d.strength*c.quantity,o=o||d.unit)}return o?{amount:l,unit:o}:null},updatePillInventory:(t,n)=>{s(r=>({medications:r.medications.map(i=>{if(i.id===t){const o=[...i.pillInventory||[]];return n.forEach(c=>{const d=o.findIndex(m=>m.pillConfigurationId===c.pillConfigurationId);d>=0?o[d]={...o[d],...c,currentCount:Math.max(0,o[d].currentCount+(c.currentCount||0)),lastUpdated:new Date}:c.currentCount!==void 0&&o.push({pillConfigurationId:c.pillConfigurationId,currentCount:Math.max(0,c.currentCount),lastUpdated:new Date,...c})}),{...i,pillInventory:o,updatedAt:new Date}}return i})}))},addSideEffectReport:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t?{...i,sideEffectReports:[...i.sideEffectReports||[],{...n,id:ee(),medicationId:t,timestamp:new Date}],enhancedMonitoring:!0}:i)}))},updateSideEffectReport:(t,n,r)=>{s(i=>({medications:i.medications.map(l=>{var o;return l.id===t?{...l,sideEffectReports:(o=l.sideEffectReports)==null?void 0:o.map(c=>c.id===n?{...c,...r}:c)}:l})}))},initializeDependencePrevention:t=>{const n=a().medications.find(i=>i.id===t);if(!n)return;const r=ls.initializePrevention(n);s(i=>({medications:i.medications.map(l=>l.id===t?{...l,dependencePrevention:r,enhancedMonitoring:!0}:l)}))},updateDependenceAssessment:t=>{const n=a(),r=n.medications.find(o=>o.id===t);if(!r||!r.dependencePrevention)return;const i=n.logs.filter(o=>o.medicationId===t).slice(-30).map(o=>({date:new Date(o.timestamp),doseTaken:parseFloat(o.dosageTaken||r.dosage),prescribedDose:parseFloat(r.dosage),selfAdjustment:!1,timesBetweenDoses:24/(r.timesPerDay||1),effectivenessRating:7})),l=ls.assessCurrentRisk(r,i);s(o=>({medications:o.medications.map(c=>c.id===t?{...c,dependencePrevention:l}:c)}))},recordUsagePattern:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t&&i.dependencePrevention?{...i,dependencePrevention:{...i.dependencePrevention,usagePatterns:[...i.dependencePrevention.usagePatterns,{...n,date:new Date}].slice(-50)}}:i)})),a().updateDependenceAssessment(t)},acknowledgeDependenceAlert:(t,n,r)=>{s(i=>({medications:i.medications.map(l=>l.id===t&&l.dependencePrevention?{...l,dependencePrevention:{...l.dependencePrevention,alerts:l.dependencePrevention.alerts.map(o=>o.id===n?{...o,acknowledged:!0,actionTaken:r}:o)}}:l)}))},addDependenceIntervention:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t&&i.dependencePrevention?{...i,dependencePrevention:{...i.dependencePrevention,interventions:[...i.dependencePrevention.interventions,{...n,id:ee(),timestamp:new Date}]}}:i)}))},updateDoctorReview:(t,n)=>{s(r=>({medications:r.medications.map(i=>i.id===t&&i.dependencePrevention?{...i,dependencePrevention:{...i.dependencePrevention,lastDoctorReview:n,doctorReviewRequired:!1}}:i)}))},getDependenceInsights:t=>{const n=a().medications.find(r=>r.id===t);return n?ls.generateTaperingRecommendation(n):null},enableMultiplePills:t=>{s(n=>({medications:n.medications.map(r=>{if(r.id!==t)return r;const i=r.pillConfigurations||[{id:ee(),strength:parseFloat(r.dosage)||1,unit:r.unit,isActive:!0,color:r.color,shape:"round",markings:""}],l=r.doseConfigurations||[{id:ee(),name:"Default Dose",description:`Standard dose of ${r.dosage} ${r.unit}`,pillComponents:[{pillConfigurationId:i[0].id,quantity:1}],totalDoseAmount:parseFloat(r.dosage)||1,totalDoseUnit:r.unit,isDefault:!0}],o=r.pillInventory||i.map(c=>({pillConfigurationId:c.id,currentCount:r.pillsRemaining||30,lastUpdated:new Date}));return{...r,useMultiplePills:!0,pillConfigurations:i,doseConfigurations:l,defaultDoseConfigurationId:l[0].id,pillInventory:o,updatedAt:new Date}})}))}}),{name:"medtrack-storage",storage:Nn(()=>localStorage),version:1}));function to({onMenuClick:s}){const{getTodaysReminders:a,userProfile:t}=ae(),[n,r]=I.useState(new Date);I.useEffect(()=>{const o=setInterval(()=>{r(new Date)},6e4);return()=>clearInterval(o)},[]);const l=a().filter(o=>{const c=new Date,[d,m]=o.time.split(":").map(Number);return c.setHours(d,m,0,0),c>n});return e.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:s,className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 touch-target",children:e.jsx(Jr,{className:"h-5 w-5"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsxs("h1",{className:"text-xl font-semibold text-gray-900","data-testid":"header-logo",children:["Good ",n.getHours()<12?"morning":n.getHours()<18?"afternoon":"evening",(t==null?void 0:t.name)&&`, ${t.name.split(" ")[0]}`]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[Os(n)," • ",n.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]})]}),e.jsx("div",{className:"hidden md:flex flex-1 max-w-md mx-8",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search medications...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent","data-testid":"search-button"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"relative",children:e.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-full touch-target","data-testid":"header-notifications",children:[e.jsx(rs,{className:"h-5 w-5"}),l.length>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-white font-medium",children:l.length>9?"9+":l.length})})]})}),e.jsx("div",{className:"relative",children:e.jsxs("button",{className:"flex items-center space-x-2 p-2 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-lg touch-target","data-testid":"header-settings",children:[e.jsx("div",{className:"h-8 w-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(ot,{className:"h-4 w-4 text-primary-600"})}),(t==null?void 0:t.name)&&e.jsx("span",{className:"hidden sm:block text-sm font-medium text-gray-700",children:t.name})]})})]})]})}function ao({children:s}){const[a,t]=I.useState(!1);return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(jl,{isOpen:a,onClose:()=>t(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(to,{onMenuClick:()=>t(!0)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 lg:p-6 mobile-scroll mobile-safe-area",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:s})})]})]})}function no({medication:s,onAction:a}){var k,S;const{logMultiplePillDose:t}=ae(),[n,r]=I.useState({}),[i,l]=I.useState(!1),o=I.useMemo(()=>{if(!s.useMultiplePills||!s.pillConfigurations||!s.doseConfigurations)return[];const v=pn(s);return console.log(`🔍 MultiplePillQuickLog getPillComponents for ${s.name}:`,v),v},[s.useMultiplePills,s.pillConfigurations,s.doseConfigurations,s.defaultDoseConfigurationId]),c=I.useMemo(()=>o.length===0?"no-pills":o.map(v=>v.pillConfigurationId).sort().join("-"),[s.id,s.defaultDoseConfigurationId]);I.useEffect(()=>{if(o.length===0)return;const v={};o.forEach(g=>{v[g.pillConfigurationId]=0}),r(v)},[c]);const d=(v,g)=>{r(u=>({...u,[v]:Math.max(0,(u[v]||0)+g)}))},m=async()=>{var v;l(!0);try{const g=o.map(h=>({pillConfigurationId:h.pillConfigurationId,quantityTaken:n[h.pillConfigurationId]||0,quantityExpected:h.quantity,timeTaken:new Date}));console.log("🔄 Logging multiple pill dose:",s.name,{pillLogs:g,pillComponents:o,pillsTaken:n,inventoryCount:((v=s.pillInventory)==null?void 0:v.length)||0}),t(s.id,g);const u=o.reduce((h,j)=>h+j.quantity,0),f=Object.values(n).reduce((h,j)=>h+j,0);f===u?(J.success(`✅ All pills logged for ${s.name}!`,{icon:"💊"}),a==null||a("taken")):f>0?(J.success(`📝 Partial dose logged for ${s.name}`,{icon:"⚠️"}),a==null||a("partial")):(J(`⏭️ Skipped ${s.name}`,{icon:"💭"}),a==null||a("skipped"));const b={};o.forEach(h=>{b[h.pillConfigurationId]=0}),r(b)}catch(g){console.error("❌ Failed to log multiple pill dose:",g),J.error("Failed to log pills")}finally{l(!1)}},x=()=>{const v={};o.forEach(g=>{v[g.pillConfigurationId]=g.quantity}),r(v)},y=()=>Object.values(n).reduce((v,g)=>v+g,0),R=()=>o.reduce((v,g)=>v+g.quantity,0);return console.log(`🔍 MultiplePillQuickLog validation for ${s.name}:`,{useMultiplePills:s.useMultiplePills,hasPillConfigs:!!s.pillConfigurations,hasDoseConfigs:!!s.doseConfigurations,pillConfigsLength:((k=s.pillConfigurations)==null?void 0:k.length)||0,doseConfigsLength:((S=s.doseConfigurations)==null?void 0:S.length)||0,pillComponentsLength:o.length,pillComponents:o}),!s.useMultiplePills||!s.pillConfigurations||!s.doseConfigurations||s.pillConfigurations.length===0||s.doseConfigurations.length===0||o.length===0?(console.log(`❌ MultiplePillQuickLog: Invalid configuration for ${s.name}, returning null`),null):e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:s.color}}),e.jsx("h3",{className:"font-medium text-gray-900",children:s.name})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[y(),"/",R()," pills"]})]}),e.jsx("div",{className:"space-y-3",children:o.map(v=>{const g=n[v.pillConfigurationId]||0,u=v.quantity,f=v.pillConfig;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:f.color||s.color}}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[f.strength,f.unit," ",f.color," pill"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Need: ",u," ",u===1?"pill":"pills"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d(v.pillConfigurationId,-.5),disabled:g<=0,className:"w-8 h-8 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-gray-600 text-sm font-medium",children:"−"}),e.jsx("div",{className:"w-12 text-center",children:e.jsx("span",{className:`text-sm font-medium ${g===u?"text-green-600":g>u?"text-orange-600":"text-gray-900"}`,children:g})}),e.jsx("button",{onClick:()=>d(v.pillConfigurationId,.5),className:"w-8 h-8 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-gray-600 text-sm font-medium",children:"+"}),g!==u&&e.jsxs("button",{onClick:()=>r(b=>({...b,[v.pillConfigurationId]:u})),className:"ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:["Set ",u]})]})]},v.pillConfigurationId)})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:x,className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{children:"Take All Pills"})]}),e.jsxs("button",{onClick:m,disabled:i||y()===0,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{children:"Log"})]}),e.jsxs("button",{onClick:()=>{const v={};o.forEach(g=>{v[g.pillConfigurationId]=0}),r(v)},className:"border border-gray-300 text-gray-700 px-4 py-2 rounded-lg text-sm hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Reset"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(y()/R()*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,y()/R()*100)}%`}})})]}),e.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded p-2",children:["💡 ",e.jsx("strong",{children:"Tip:"}),' Use + and − buttons to count half pills (0.5). Click "Take All Pills" to set everything at once.']})]})}function Aa({medication:s,reminder:a,onAction:t}){var W;const{markMedicationTaken:n,markMedicationMissed:r,getCurrentDose:i,generateContextualMessage:l,addSmartMessage:o,logMedication:c}=ae(),[d,m]=I.useState(!1),[x,y]=I.useState(""),[R,k]=I.useState(!1),[S,v]=I.useState(""),[g,u]=I.useState(!1),[f,b]=I.useState(!1),[h,j]=I.useState(""),F=i(s.id),P=F.phase!=="maintenance"?F.dose:parseFloat(s.dosage),M=H=>{var ne;const K=P,Z=(H-K)/K*100,Q=[];let le="info";return(ne=s.tapering)!=null&&ne.isActive&&(Z>20?(Q.push(`⚠️ You're taking ${Math.round(Z)}% more than your tapering schedule.`),Q.push("💭 Taking more during tapering can disrupt your withdrawal plan and make it harder to reduce later."),Q.push("🏥 Consider contacting your healthcare provider before taking this higher dose."),le="critical"):Z<-20?(Q.push(`⚠️ You're taking ${Math.round(Math.abs(Z))}% less than scheduled.`),Q.push("💭 Sudden dose reductions can trigger withdrawal symptoms."),Q.push("🏥 Stick to your tapering plan for your safety and comfort."),le="critical"):Math.abs(Z)>10&&(Q.push(`ℹ️ This is ${Math.round(Math.abs(Z))}% ${Z>0?"higher":"lower"} than planned.`),Q.push("💭 Small deviations are sometimes okay, but consistency helps your body adjust."),le="warning")),s.riskLevel==="high"&&(Math.abs(Z)>50?(Q.push("🚨 Significant dose change for a high-risk medication."),Q.push("💭 This medication requires careful monitoring. Large changes can be dangerous."),Q.push("🏥 Please consult your healthcare provider before taking this dose."),le="critical"):Math.abs(Z)>25&&(Q.push("⚠️ Notable dose change for a monitored medication."),Q.push("💭 Be mindful of how this change affects you."),le="warning")),s.maxDailyDose&&H>s.maxDailyDose&&(Q.push(`🛑 This exceeds your maximum daily dose limit (${s.maxDailyDose} ${s.unit}).`),Q.push("💭 Taking more than prescribed can be dangerous and may cause serious side effects."),Q.push("🏥 Contact your healthcare provider immediately if you feel you need more medication."),le="critical"),Z>0&&s.frequency==="as-needed"?Q.push("💙 Remember: Taking PRN medications is about finding balance, not avoiding all discomfort."):Z>30&&(Q.push("💚 Consider: Are you taking more because you're having a difficult day? That's human and understandable."),Q.push("🤝 There are other coping strategies that might help alongside your medication.")),{warnings:Q,severity:le}},D=()=>{var K,Z;const H=s.useMultiplePills&&s.pillConfigurations&&s.doseConfigurations&&s.pillConfigurations.length>0&&s.doseConfigurations.length>0;return console.log(`🔍 QuickMedicationLog ${s.name}:`,{useMultiplePills:s.useMultiplePills,hasConfigs:H,pillConfigs:((K=s.pillConfigurations)==null?void 0:K.length)||0,doseConfigs:((Z=s.doseConfigurations)==null?void 0:Z.length)||0,fullMedication:s}),H},T=async H=>{var K;u(!0);try{const Z=H||P;console.log("🔄 Logging medication:",s.name,{dosage:Z,useMultiplePills:s.useMultiplePills,hasPillInventory:!!((K=s.pillInventory)!=null&&K.length)}),n(s.id,Z),l(s.id,"celebration"),J.success(`✅ ${s.name} logged successfully!`,{icon:"💊",duration:3e3});const Q=new Date;o({medicationId:s.id,type:"celebration",priority:"low",title:"Great Job!",message:`You took your ${s.name} on time. Consistency builds healthy habits! 🌟`,psychologicalApproach:"positive-reinforcement",scheduledTime:Q,expiresAt:new Date(Q.getTime()+2*60*60*1e3)}),t==null||t("taken")}catch(Z){console.error("❌ Failed to log medication:",Z),J.error("Failed to log medication")}finally{u(!1),m(!1),y("")}},N=async()=>{u(!0);try{r(s.id),(s.riskLevel==="high"||s.riskLevel==="moderate")&&l(s.id,"adherence-reminder"),J(`⏭️ ${s.name} marked as skipped`,{icon:"⚠️",duration:4e3});const H=new Date;o({medicationId:s.id,type:"adherence-reminder",priority:s.riskLevel==="high"?"high":"medium",title:"Gentle Reminder",message:`It's okay to miss occasionally, but try to stay consistent with your ${s.name}. Your health journey matters! 💙`,psychologicalApproach:"empathetic-support",scheduledTime:H,expiresAt:new Date(H.getTime()+6*60*60*1e3)}),t==null||t("skipped")}catch{J.error("Failed to log skip")}finally{u(!1),k(!1),v("")}},C=()=>{if(!x||isNaN(parseFloat(x))){J.error("Please enter a valid dosage");return}const H=parseFloat(x),K=M(H);if(K.warnings.length>0){j(K.warnings.join(`

`)),b(!0);return}T(H)},p=()=>{const H=parseFloat(x);c(s.id,H,`Custom dose: ${H} ${s.unit} (expected: ${P} ${s.unit})`,[]),M(H).severity==="critical"&&o({medicationId:s.id,type:"risk-alert",priority:"urgent",title:"Dose Deviation Detected",message:`You took a different dose than planned for ${s.name}. This has been logged for your healthcare provider's review.`,psychologicalApproach:"empathetic-support",scheduledTime:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3)}),J.success(`✅ ${s.name} (${H} ${s.unit}) logged!`,{icon:"💊",duration:3e3}),t==null||t("taken"),m(!1),b(!1),y(""),j("")},E=()=>s.category==="vitamin"||s.category==="supplement"?e.jsx(Qe,{className:"h-4 w-4 text-green-500"}):s.riskLevel==="high"?e.jsx(xs,{className:"h-4 w-4 text-red-500"}):s.category==="herbal"?e.jsx(xn,{className:"h-4 w-4 text-purple-500"}):e.jsx(hn,{className:"h-4 w-4 text-blue-500"}),U=()=>s.category==="vitamin"||s.category==="supplement"?"Nourishing your body! 🌱":s.category==="herbal"?"Natural wellness choice! 🌿":s.riskLevel==="high"?"Important for your health 💊":"Taking care of yourself! ✨";return D()?(console.log(`✅ Using MultiplePillQuickLog for ${s.name}`),e.jsx(no,{medication:s,onAction:t})):(console.log(`✅ Using regular QuickMedicationLog for ${s.name}`),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mt-1 flex-shrink-0",style:{backgroundColor:s.color}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.name}),E()]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:D()?qs(s):gn(P.toString(),s.unit)}),D()&&e.jsx("div",{className:"mt-2 space-y-1",children:pn(s).map((H,K)=>e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:H.pillConfig.color||s.color}}),e.jsx("span",{children:H.displayText})]},K))}),F.phase!=="maintenance"&&e.jsxs("p",{className:"text-xs text-blue-600 font-medium mt-1",children:["Current: ",F.dose," ",s.unit," (",F.phase,")"]}),a&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx(ke,{className:"h-3 w-3 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Due: ",a.time]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:U()})]})]})}),e.jsxs("div",{className:"space-y-3",children:[!d&&!R&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>T(),disabled:g,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{children:D()?`Take ${qs(s).split("(")[0].trim()}`:`Take ${P} ${s.unit}`})]}),e.jsx("button",{onClick:()=>m(!0),className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-colors",title:"Different dosage",children:"±"}),e.jsxs("button",{onClick:()=>k(!0),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-colors flex items-center space-x-1",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Skip"})]})]}),d&&!f&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Custom Dosage (",s.unit,")"]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Expected: ",P," ",s.unit,((W=s.tapering)==null?void 0:W.isActive)&&e.jsx("span",{className:"text-purple-600 font-medium",children:" (Tapering Schedule)"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"number",step:"0.1",value:x,onChange:H=>y(H.target.value),placeholder:P.toString(),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0}),e.jsx("button",{onClick:C,disabled:g||!x,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"Check Dose"}),e.jsx("button",{onClick:()=>{m(!1),y("")},className:"border border-gray-300 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-50 transition-colors",children:"Cancel"})]})]}),f&&e.jsxs("div",{className:"space-y-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(xs,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Dose Safety Check"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700 whitespace-pre-line",children:h})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:p,className:"flex-1 bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"I Understand - Log This Dose"}),e.jsx("button",{onClick:()=>{b(!1),j("")},className:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-50 transition-colors",children:"Cancel & Revise"})]}),e.jsxs("div",{className:"text-xs text-gray-600 bg-white p-2 rounded border",children:["💡 ",e.jsx("strong",{children:"Remember:"})," Your healthcare provider can help adjust your medication plan if you're consistently needing different doses."]})]}),R&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Why are you skipping? (Optional)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:S,onChange:H=>v(H.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select a reason"}),e.jsx("option",{value:"forgot",children:"Forgot to take it"}),e.jsx("option",{value:"side-effects",children:"Experiencing side effects"}),e.jsx("option",{value:"no-access",children:"Don't have medication with me"}),e.jsx("option",{value:"feeling-better",children:"Feeling better"}),e.jsx("option",{value:"doctor-advice",children:"Doctor advised to skip"}),e.jsx("option",{value:"interaction",children:"Potential drug interaction"}),e.jsx("option",{value:"other",children:"Other reason"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:N,disabled:g,className:"flex-1 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"Skip This Dose"}),e.jsx("button",{onClick:()=>{k(!1),v("")},className:"border border-gray-300 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})]}),s.riskLevel==="high"&&e.jsx("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-700",children:["💙 ",e.jsx("strong",{children:"You're doing great!"})," Staying consistent with this medication is important for your health and well-being."]})}),(s.category==="vitamin"||s.category==="supplement")&&e.jsx("div",{className:"mt-3 p-2 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-green-700",children:["🌟 ",e.jsx("strong",{children:"Investing in your wellness!"})," Every supplement you take is a step towards better health."]})})]}))}function io(){const{getTodaysReminders:s,getTodaysLogs:a,medications:t,smartMessages:n}=ae(),r=s(),i=a(),l=t.filter(g=>g.isActive);I.useEffect(()=>{console.log("🔍 TodaysMedications Debug:",{totalMedications:t.length,activeMedications:l.length,todaysReminders:r.length,medicationsWithoutReminders:o.length,totalForToday:x(),medications:l.map(g=>({id:g.id,name:g.name,isActive:g.isActive,useMultiplePills:g.useMultiplePills,hasConfigs:!!(g.pillConfigurations&&g.doseConfigurations)}))})},[t.length,l.length,r.length]);const o=l.filter(g=>!r.some(u=>u.medicationId===g.id)),c=new Set(i.map(g=>g.medicationId)),d=n.filter(g=>g.priority==="urgent"||g.priority==="high"),m=()=>{const g=new Date().getHours();return g<12?"Good morning! ☀️":g<17?"Good afternoon! 🌤️":"Good evening! 🌙"},x=()=>r.length+o.length,y=()=>r.filter(g=>c.has(g.medicationId)).length+o.filter(g=>c.has(g.id)).length,R=g=>pl(g,i),k=()=>{const g=x();return g===0?0:Math.round(y()/g*100)},v=(()=>{const g=k(),u=y(),f=x();return g===100?{message:"🎉 Perfect! You've completed all your medications for today!",color:"text-green-600 bg-green-50 border-green-200"}:g>=75?{message:`🌟 Great progress! ${u}/${f} completed. You're doing amazing!`,color:"text-blue-600 bg-blue-50 border-blue-200"}:g>=50?{message:`💪 Keep going! ${u}/${f} completed. You've got this!`,color:"text-orange-600 bg-orange-50 border-orange-200"}:u>0?{message:`✨ Good start! ${u}/${f} completed. Every step counts!`,color:"text-purple-600 bg-purple-50 border-purple-200"}:{message:`${m()} Ready to start your wellness routine?`,color:"text-gray-600 bg-gray-50 border-gray-200"}})();return x()===0?e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx($e,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No medications for today"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Enjoy your medication-free day!"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Today's Medications"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[y(),"/",x()]}),e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${k()}%`}})})]})]}),e.jsx("div",{className:`p-3 rounded-lg border ${v.color}`,children:e.jsx("p",{className:"text-sm font-medium",children:v.message})})]}),d.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(X,{className:"h-5 w-5 text-red-600"}),e.jsx("h3",{className:"font-medium text-red-900",children:"Important Alerts"})]}),e.jsx("div",{className:"space-y-2",children:d.map(g=>e.jsxs("div",{className:"bg-white p-3 rounded border border-red-200",children:[e.jsx("h4",{className:"font-medium text-red-900 text-sm",children:g.title}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:g.message})]},g.id))})]}),r.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center space-x-2",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Scheduled for Today"})]}),r.map(g=>{const u=R(g.medication),f=Sa(u.remaining,u.total,u.completed,g.medication.frequency);return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-2 right-2 z-10 flex flex-col items-end space-y-1",children:u.completed?e.jsxs("div",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center space-x-1",children:[e.jsx(ys,{className:"h-3 w-3"}),e.jsx("span",{children:"All Complete"})]}):u.remaining>0&&u.total>0?e.jsx("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:f}):null}),e.jsx("div",{className:u.completed?"opacity-60":"",children:e.jsx(Aa,{medication:g.medication,reminder:{time:g.time,id:g.id},onAction:b=>{}})})]},g.id)})]}),o.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"As Needed / No Reminders Set"})]}),o.map(g=>{const u=R(g),f=Sa(u.remaining,u.total,u.completed,g.frequency);return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-2 right-2 z-10 flex flex-col items-end space-y-1",children:u.completed?e.jsxs("div",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center space-x-1",children:[e.jsx(ys,{className:"h-3 w-3"}),e.jsx("span",{children:g.frequency==="as-needed"?"Taken Today":"All Complete"})]}):u.remaining>0&&u.total>0?e.jsx("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:f}):g.frequency==="as-needed"?e.jsx("div",{className:"bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full",children:"As needed"}):null}),e.jsx("div",{className:u.completed?"opacity-60":"",children:e.jsx(Aa,{medication:g,onAction:b=>{}})})]},g.id)})]}),t.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"💡 Adherence Insight"}),e.jsx("p",{className:"text-sm text-gray-700",children:k()>=80?"Your consistency is excellent! This level of adherence supports optimal treatment outcomes.":k()>=60?"Good adherence! Try setting more reminders to reach your health goals even better.":"Remember, consistency is key to getting the most benefit from your medications. Consider setting up more reminders."})]})]})}function ro(){const s=ae.getState(),a=s.medications.find(t=>t.name==="Kratom");if(!a){console.error("❌ Kratom medication not found");return}if(console.log("🔍 Current Kratom data:",a),a.useMultiplePills&&a.pillConfigurations&&a.pillConfigurations.length>0){const t=a.pillConfigurations[0],n={id:ee(),name:"Standard Dose",description:`5 pills of ${t.strength}${t.unit} each`,pillComponents:[{pillConfigurationId:t.id,quantity:5}],totalDoseAmount:2500,unit:"mg",isActive:!0};return s.updateMedication(a.id,{doseConfigurations:[n],defaultDoseConfigurationId:n.id}),console.log("✅ Fixed Kratom data structure!"),console.log("🔄 Refresh the page to see the changes"),!0}else return console.error("❌ Kratom doesn't have proper pill configurations"),!1}window.fixKratomData=ro;function lo({medication:s,isOpen:a,onClose:t}){var N;const{updateMedication:n,addSmartMessage:r}=ae(),[i,l]=I.useState({}),[o,c]=I.useState(""),[d,m]=I.useState(5),[x,y]=I.useState(""),[R,k]=I.useState(!1),S={benzodiazepine:["Anxiety","Panic attacks","Insomnia","Tremor","Sweating","Nausea","Headache","Muscle tension","Concentration problems","Memory issues","Irritability","Light sensitivity"],opioid:["Muscle aches","Runny nose","Nausea","Vomiting","Diarrhea","Insomnia","Restlessness","Anxiety","Depression","Cravings","Hot/cold flashes","Fatigue"],antidepressant:["Brain zaps","Dizziness","Nausea","Headache","Fatigue","Irritability","Anxiety","Vivid dreams","Flu-like symptoms","Emotional lability","Confusion"],stimulant:["Fatigue","Depression","Increased appetite","Sleep problems","Anxiety","Concentration problems","Cravings","Mood swings","Lack of motivation"],"sleep-aid":["Rebound insomnia","Anxiety","Panic attacks","Sweating","Tremor","Nausea","Confusion","Memory problems","Muscle tension","Nightmares"]},v=s.dependencyRiskCategory,g=S[v]||S.benzodiazepine,u=(N=s.dependencePrevention)==null?void 0:N.withdrawalHistory.find(C=>!C.endDate),f=u!=null&&u.startDate?Math.floor((Date.now()-new Date(u.startDate).getTime())/(1e3*60*60*24)):0;I.useEffect(()=>{if(a){const C=new Date().toDateString(),p={};u!=null&&u.symptoms&&u.symptoms.forEach(E=>{new Date(E.peak).toDateString()===C&&(p[E.symptom]=E.severity)}),l(p)}},[a,u]);const b=(C,p)=>{l(E=>({...E,[C]:p}))},h=()=>{o.trim()&&!i[o.trim()]&&(l(C=>({...C,[o.trim()]:1})),c(""))},j=C=>{l(p=>{const E={...p};return delete E[C],E})},F=C=>{if(!(u!=null&&u.symptoms))return"stable";const p=u.symptoms.filter(W=>W.symptom===C).sort((W,H)=>new Date(W.peak).getTime()-new Date(H.peak).getTime()).slice(-3);if(p.length<2)return"stable";const E=p[p.length-1].severity,U=p[p.length-2].severity;return E>U+1?"worsening":E<U-1?"improving":"stable"},P=C=>{switch(C){case"improving":return e.jsx(Ls,{className:"h-3 w-3 text-green-500"});case"worsening":return e.jsx(Se,{className:"h-3 w-3 text-red-500"});default:return e.jsx(un,{className:"h-3 w-3 text-gray-400"})}},M=C=>C<=2?"text-green-600 bg-green-100":C<=4?"text-yellow-600 bg-yellow-100":C<=7?"text-orange-600 bg-orange-100":"text-red-600 bg-red-100",D=C=>C<=2?"text-red-600":C<=4?"text-orange-600":C<=6?"text-yellow-600":C<=8?"text-blue-600":"text-green-600",T=async()=>{k(!0);try{const C=new Date,p=Object.entries(i).map(([E,U])=>({symptom:E,severity:U,duration:24,peak:C,managementStrategies:[],resolved:U===0}));if(u&&s.dependencePrevention){const E={...u,symptoms:[...u.symptoms.filter(K=>new Date(K.peak).toDateString()!==C.toDateString()),...p]},U=s.dependencePrevention.withdrawalHistory.map(K=>K.id===u.id?E:K);n(s.id,{dependencePrevention:{...s.dependencePrevention,withdrawalHistory:U}});const H=Object.values(i).reduce((K,Z)=>K+Z,0)/Object.keys(i).length;H>6?r({medicationId:s.id,type:"risk-alert",priority:"high",title:"Withdrawal Symptoms Tracked",message:"Your symptoms today seem intense. Remember, this is temporary and you're doing great. Consider contacting your healthcare provider if symptoms become unbearable.",psychologicalApproach:"empathetic-support",scheduledTime:C,expiresAt:new Date(C.getTime()+12*60*60*1e3)}):H>3?r({medicationId:s.id,type:"motivation",priority:"medium",title:"Managing Withdrawal Well",message:"You're tracking your symptoms - that's self-awareness and strength. Each day is progress toward feeling better.",psychologicalApproach:"positive-reinforcement",scheduledTime:C,expiresAt:new Date(C.getTime()+8*60*60*1e3)}):r({medicationId:s.id,type:"celebration",priority:"low",title:"Feeling Better!",message:"Your symptoms are mild today - that's wonderful progress! You're showing real resilience.",psychologicalApproach:"positive-reinforcement",scheduledTime:C,expiresAt:new Date(C.getTime()+6*60*60*1e3)}),J.success("Withdrawal symptoms logged successfully"),t()}}catch{J.error("Failed to log symptoms")}finally{k(!1)}};return!a||!u?null:e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(we,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Daily Withdrawal Check-in"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.name," • Day ",f]})]})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overall Mood Today (1-10)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:d,onChange:C=>m(parseInt(C.target.value)),className:"flex-1"}),e.jsxs("span",{className:`text-lg font-semibold ${D(d)}`,children:[d,"/10"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Very Low"}),e.jsx("span",{children:"Excellent"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Common Withdrawal Symptoms"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:g.map(C=>{const p=i[C]||0,E=F(C);return e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:C}),P(E)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p>0&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${M(p)}`,children:[p,"/10"]}),e.jsx("button",{onClick:()=>j(C),className:"text-gray-400 hover:text-red-500",children:e.jsx(ce,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"None"}),e.jsx("input",{type:"range",min:"0",max:"10",value:p,onChange:U=>b(C,parseInt(U.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Severe"})]})]},C)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Add Custom Symptom"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:o,onChange:C=>c(C.target.value),placeholder:"Enter a symptom you're experiencing",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),e.jsx("button",{onClick:h,disabled:!o.trim()||i[o.trim()],className:"bg-orange-600 hover:bg-orange-700 disabled:opacity-50 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:e.jsx(Ae,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (Optional)"}),e.jsx("textarea",{value:x,onChange:C=>y(C.target.value),placeholder:"How are you feeling overall? Any coping strategies that helped today?",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500",rows:3})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-800 mb-2",children:"🌟 You're Doing Great!"}),e.jsx("p",{className:"text-sm text-green-700",children:"Tracking your symptoms shows self-awareness and commitment to your recovery. Each day you monitor your progress is a step toward feeling better. Remember, withdrawal symptoms are temporary, but your strength is lasting."})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:T,disabled:R||Object.keys(i).length===0,className:"px-6 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-md hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Saving...":"Log Symptoms"})]})})]})})}function oo(){const{medications:s,logs:a,getTodaysReminders:t,getTodaysLogs:n,getMissedDoses:r,getUpcomingRefills:i,getMedicationAdherence:l,markMedicationTaken:o,markMedicationMissed:c,smartMessages:d,getSmartInsights:m,getHighRiskMedications:x,markMessageAsRead:y,getCurrentDose:R,addSmartMessage:k}=ae(),S=t(),v=n(),g=r(7),u=i(),f=s.filter(p=>p.isActive),b=m();x();const h=d.filter(p=>p.priority==="high"||p.priority==="urgent"),j=f.filter(p=>{var E;return(E=p.tapering)==null?void 0:E.isActive}),F=f.filter(p=>{var E;return(E=p.dependencePrevention)==null?void 0:E.withdrawalHistory.some(U=>!U.endDate)});f.filter(p=>{var E;return(E=p.cyclicDosing)==null?void 0:E.isActive});const P=f.filter(p=>p.frequency==="as-needed"),D=(()=>{const p=[],E=new Set;return v.forEach(U=>{var ne,G,ve;if(E.has(U.id))return;E.add(U.id);const W=s.find(oe=>oe.id===U.medicationId);if(!W||a.filter(oe=>oe.medicationId===U.medicationId&&oe.adherence==="taken").length<=1)return;const K=R(W.id);let Z=U.dosageTaken;if(W.useMultiplePills&&U.pillLogs&&U.pillLogs.length>0)Z=U.pillLogs.reduce((oe,fe)=>{var Ee;const qe=(Ee=W.pillConfigurations)==null?void 0:Ee.find(Be=>Be.id===fe.pillConfigurationId);return oe+(qe?qe.strength*fe.quantityTaken:0)},0);else if(W.useMultiplePills&&U.dosageTaken){const oe=((ne=W.doseConfigurations)==null?void 0:ne.find(fe=>fe.id===W.defaultDoseConfigurationId))||((G=W.doseConfigurations)==null?void 0:G[0]);oe&&Math.abs(U.dosageTaken-oe.totalDoseAmount)<.1&&(Z=U.dosageTaken)}if(K.dose<=0||Z<=0)return;const Q=(Z-K.dose)/K.dose*100,le=Math.abs(Q);le<15||((ve=W.tapering)!=null&&ve.isActive&&(Q>25?p.push({id:U.id,medication:W.name,message:`You took ${Math.round(Q)}% more than your tapering schedule. This can disrupt your withdrawal plan.`,severity:"critical"}):Q<-25&&p.push({id:U.id,medication:W.name,message:`You took ${Math.round(Math.abs(Q))}% less than scheduled. Sudden reductions can cause withdrawal symptoms.`,severity:"critical"})),W.riskLevel==="high"&&le>30&&a.filter(fe=>fe.medicationId===W.id&&fe.id!==U.id&&new Date(fe.timestamp).getTime()>Date.now()-2592e5).length>0&&p.push({id:U.id,medication:W.name,message:`Significant dose variation pattern detected (${Math.round(le)}% deviation). This high-risk medication requires careful monitoring.`,severity:"warning"}))}),p})(),[T,N]=I.useState(null);I.useEffect(()=>{console.log("🔍 Dashboard Data Check:",{totalMedications:s.length,activeMedications:f.length,allMedications:s.map(p=>({id:p.id,name:p.name,isActive:p.isActive,dosage:p.dosage,unit:p.unit}))})},[s.length]);const C=[{name:"Active Medications",value:f.length,icon:Pe,color:"bg-blue-500",href:"/medications"},{name:"Today's Reminders",value:S.length,icon:ke,color:"bg-green-500",href:"/calendar"},{name:"Taken Today",value:v.filter(p=>p.adherence==="taken").length,icon:_e,color:"bg-green-500",href:"/analytics"},{name:"Tapering Plans",value:j.length,icon:Se,color:"bg-purple-500",href:"/medications",description:"Active withdrawal schedules"},{name:"PRN/As-Needed",value:P.length,icon:xn,color:"bg-orange-500",href:"/medications",description:"Flexible dosing medications"},{name:"Dose Warnings",value:D.length,icon:X,color:D.some(p=>p.severity==="critical")?"bg-red-500":"bg-yellow-500",href:"/analytics",description:"Psychological safety alerts"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Overview of your medications and health tracking"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs(ns,{to:"/medications",className:"btn-primary inline-flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Medication"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:C.map(p=>e.jsx(ns,{to:p.href,className:"card hover:shadow-md transition-shadow cursor-pointer",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`${p.color} rounded-md p-3`,children:e.jsx(p.icon,{className:"h-6 w-6 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:p.name}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:p.value}),p.description&&e.jsx("dd",{className:"text-xs text-gray-400 mt-1",children:p.description})]})})]})})},p.name))}),h.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(Zr,{className:"h-5 w-5 text-blue-500 mr-2"}),"Smart Health Insights"]}),e.jsx("span",{className:"badge badge-primary",children:h.length})]})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-3",children:[h.slice(0,3).map(p=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${p.priority==="urgent"?"border-red-500 bg-red-50":p.priority==="high"?"border-orange-500 bg-orange-50":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[p.type==="risk-alert"&&e.jsx(lt,{className:"h-4 w-4 text-red-500"}),p.type==="celebration"&&e.jsx(Ht,{className:"h-4 w-4 text-yellow-500"}),p.type==="motivation"&&e.jsx(Se,{className:"h-4 w-4 text-green-500"}),e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:p.title})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:p.message})]}),e.jsx("button",{onClick:()=>y(p.id),className:"ml-4 text-xs text-gray-400 hover:text-gray-600",children:"Dismiss"})]})},p.id)),h.length>3&&e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-500",children:[h.length-3," more insights available"]})})]})})]}),D.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(Oe,{className:"h-5 w-5 text-red-500 mr-2"}),"Psychological Safety Alerts"]}),e.jsx("span",{className:`badge ${D.some(p=>p.severity==="critical")?"badge-danger":"badge-warning"}`,children:D.length})]})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-3",children:D.map(p=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${p.severity==="critical"?"border-red-500 bg-red-50":"border-yellow-500 bg-yellow-50"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:`h-4 w-4 ${p.severity==="critical"?"text-red-500":"text-yellow-500"}`}),e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:p.medication})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:p.message}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[e.jsx("strong",{children:"Remember:"})," Consistent dosing is important for your mental and physical well-being, especially during tapering."]})]})})},p.id))})})]}),j.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(Se,{className:"h-5 w-5 text-purple-600 mr-2"}),"Tapering Progress"]}),e.jsx("span",{className:"badge badge-primary",children:j.length})]})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-4",children:j.map(p=>{var K,Z;const E=R(p.id),U=parseFloat(p.dosage),W=(U-E.dose)/U*100,H=(K=p.tapering)!=null&&K.startDate?Math.floor((Date.now()-new Date(p.tapering.startDate).getTime())/(1e3*60*60*24)):0;return e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:p.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[E.dose," ",p.unit," (down from ",U," ",p.unit,")"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-purple-600",children:[Math.round(W),"% reduced"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Day ",H]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(W,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[e.jsxs("span",{children:["Original: ",U," ",p.unit]}),e.jsxs("span",{children:["Target: 0 ",p.unit]})]}),((Z=p.tapering)==null?void 0:Z.isPaused)&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800",children:"⏸️ Tapering paused - Resume when ready or contact your healthcare provider"})]},p.id)})})})]}),F.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(we,{className:"h-5 w-5 text-orange-600 mr-2"}),"Active Withdrawal Monitoring"]}),e.jsx("span",{className:"badge badge-warning",children:F.length})]})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-4",children:F.map(p=>{var W;const E=(W=p.dependencePrevention)==null?void 0:W.withdrawalHistory.find(H=>!H.endDate),U=E!=null&&E.startDate?Math.floor((Date.now()-new Date(E.startDate).getTime())/(1e3*60*60*24)):0;return e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:p.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Withdrawal monitoring • Day ",U]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-sm font-medium ${(E==null?void 0:E.severity)==="severe"?"text-red-600":(E==null?void 0:E.severity)==="moderate"?"text-orange-600":"text-green-600"}`,children:[(E==null?void 0:E.severity)||"mild"," symptoms"]})})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Symptoms tracked: ",(E==null?void 0:E.symptoms.length)||0]}),e.jsx("button",{onClick:()=>N(p),className:"w-full mt-2 text-sm bg-orange-100 hover:bg-orange-200 text-orange-800 px-3 py-2 rounded transition-colors",children:"Log Today's Symptoms"})]},p.id)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(io,{})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Active Medications"}),e.jsx(ns,{to:"/medications",className:"text-sm text-primary-600 hover:text-primary-700",children:"Manage all"})]})}),e.jsx("div",{className:"card-content",children:f.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Pe,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No medications yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add your first medication to get started."}),e.jsx("div",{className:"mt-4",children:e.jsx(ns,{to:"/medications",className:"btn-primary",children:"Add Medication"})})]}):e.jsxs("div",{className:"space-y-3",children:[f.slice(0,5).map(p=>{const E=l(p.id,7);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[p.useMultiplePills?qs(p):`${p.dosage} ${p.unit}`," • ",p.frequency.replace("-"," ")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-medium ${Gt(E)}`,children:[E,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"adherence"})]})]},p.id)}),f.length>5&&e.jsx("div",{className:"text-center",children:e.jsxs(ns,{to:"/medications",className:"text-sm text-primary-600 hover:text-primary-700",children:["View ",f.length-5," more medications"]})})]})})]})]}),(u.length>0||g.length>0||b.length>0)&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(X,{className:"h-5 w-5 text-yellow-500 mr-2"}),"Alerts & Notifications"]})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-4",children:[u.length>0&&e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(X,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Refill Reminders"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:e.jsx("ul",{className:"list-disc list-inside space-y-1",children:u.map(p=>e.jsxs("li",{children:[p.name," - ",p.pillsRemaining," pills remaining"]},p.id))})})]})]})}),g.length>0&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx($s,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Recent Missed Doses"}),e.jsxs("p",{className:"mt-1 text-sm text-red-700",children:["You've missed ",g.length," doses this week.",e.jsx(ns,{to:"/analytics",className:"font-medium underline ml-1",children:"View details"})]})]})]})}),b.map((p,E)=>e.jsx("div",{className:`p-4 rounded-lg border ${p.priority==="high"?"border-red-200 bg-red-50":p.priority==="medium"?"border-yellow-200 bg-yellow-50":"border-blue-200 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start",children:[p.type==="risk-alert"&&e.jsx(lt,{className:"h-5 w-5 text-red-600 mt-0.5"}),p.type==="adherence-concern"&&e.jsx(X,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),p.type==="celebration"&&e.jsx(Ht,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:`text-sm font-medium ${p.priority==="high"?"text-red-800":p.priority==="medium"?"text-yellow-800":"text-blue-800"}`,children:p.title}),e.jsx("p",{className:`mt-1 text-sm ${p.priority==="high"?"text-red-700":p.priority==="medium"?"text-yellow-700":"text-blue-700"}`,children:p.description}),p.medications&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[e.jsx("strong",{children:"Medications:"})," ",p.medications.join(", ")]})]})]})},E))]})})]}),T&&e.jsx(lo,{medication:T,isOpen:!!T,onClose:()=>N(null)})]})}var Vs=s=>s.type==="checkbox",is=s=>s instanceof Date,be=s=>s==null;const Dn=s=>typeof s=="object";var de=s=>!be(s)&&!Array.isArray(s)&&Dn(s)&&!is(s),co=s=>de(s)&&s.target?Vs(s.target)?s.target.checked:s.target.value:s,mo=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,uo=(s,a)=>s.has(mo(a)),ho=s=>{const a=s.constructor&&s.constructor.prototype;return de(a)&&a.hasOwnProperty("isPrototypeOf")},ia=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ge(s){let a;const t=Array.isArray(s),n=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)a=new Date(s);else if(!(ia&&(s instanceof Blob||n))&&(t||de(s)))if(a=t?[]:Object.create(Object.getPrototypeOf(s)),!t&&!ho(s))a=s;else for(const r in s)s.hasOwnProperty(r)&&(a[r]=ge(s[r]));else return s;return a}var bt=s=>/^\w*$/.test(s),ue=s=>s===void 0,ra=s=>Array.isArray(s)?s.filter(Boolean):[],la=s=>ra(s.replace(/["|']|\]/g,"").split(/\.|\[/)),V=(s,a,t)=>{if(!a||!de(s))return t;const n=(bt(a)?[a]:la(a)).reduce((r,i)=>be(r)?r:r[i],s);return ue(n)||n===s?ue(s[a])?t:s[a]:n},Te=s=>typeof s=="boolean",ie=(s,a,t)=>{let n=-1;const r=bt(a)?[a]:la(a),i=r.length,l=i-1;for(;++n<i;){const o=r[n];let c=t;if(n!==l){const d=s[o];c=de(d)||Array.isArray(d)?d:isNaN(+r[n+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;s[o]=c,s=s[o]}};const Ea={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Re={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ze={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},xo=I.createContext(null);xo.displayName="HookFormContext";var go=(s,a,t,n=!0)=>{const r={defaultValues:a._defaultValues};for(const i in s)Object.defineProperty(r,i,{get:()=>{const l=i;return a._proxyFormState[l]!==Re.all&&(a._proxyFormState[l]=!n||Re.all),t&&(t[l]=!0),s[l]}});return r};const po=typeof window<"u"?I.useLayoutEffect:I.useEffect;var Le=s=>typeof s=="string",fo=(s,a,t,n,r)=>Le(s)?(n&&a.watch.add(s),V(t,s,r)):Array.isArray(s)?s.map(i=>(n&&a.watch.add(i),V(t,i))):(n&&(a.watchAll=!0),t),Jt=s=>be(s)||!Dn(s);function Ye(s,a,t=new WeakSet){if(Jt(s)||Jt(a))return s===a;if(is(s)&&is(a))return s.getTime()===a.getTime();const n=Object.keys(s),r=Object.keys(a);if(n.length!==r.length)return!1;if(t.has(s)||t.has(a))return!0;t.add(s),t.add(a);for(const i of n){const l=s[i];if(!r.includes(i))return!1;if(i!=="ref"){const o=a[i];if(is(l)&&is(o)||de(l)&&de(o)||Array.isArray(l)&&Array.isArray(o)?!Ye(l,o,t):l!==o)return!1}}return!0}var yo=(s,a,t,n,r)=>a?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[n]:r||!0}}:{},As=s=>Array.isArray(s)?s:[s],Ta=()=>{let s=[];return{get observers(){return s},next:r=>{for(const i of s)i.next&&i.next(r)},subscribe:r=>(s.push(r),{unsubscribe:()=>{s=s.filter(i=>i!==r)}}),unsubscribe:()=>{s=[]}}},Ne=s=>de(s)&&!Object.keys(s).length,oa=s=>s.type==="file",Me=s=>typeof s=="function",ct=s=>{if(!ia)return!1;const a=s?s.ownerDocument:0;return s instanceof(a&&a.defaultView?a.defaultView.HTMLElement:HTMLElement)},Cn=s=>s.type==="select-multiple",ca=s=>s.type==="radio",vo=s=>ca(s)||Vs(s),Ft=s=>ct(s)&&s.isConnected;function bo(s,a){const t=a.slice(0,-1).length;let n=0;for(;n<t;)s=ue(s)?n++:s[a[n++]];return s}function jo(s){for(const a in s)if(s.hasOwnProperty(a)&&!ue(s[a]))return!1;return!0}function me(s,a){const t=Array.isArray(a)?a:bt(a)?[a]:la(a),n=t.length===1?s:bo(s,t),r=t.length-1,i=t[r];return n&&delete n[i],r!==0&&(de(n)&&Ne(n)||Array.isArray(n)&&jo(n))&&me(s,t.slice(0,-1)),s}var Sn=s=>{for(const a in s)if(Me(s[a]))return!0;return!1};function dt(s,a={}){const t=Array.isArray(s);if(de(s)||t)for(const n in s)Array.isArray(s[n])||de(s[n])&&!Sn(s[n])?(a[n]=Array.isArray(s[n])?[]:{},dt(s[n],a[n])):be(s[n])||(a[n]=!0);return a}function Rn(s,a,t){const n=Array.isArray(s);if(de(s)||n)for(const r in s)Array.isArray(s[r])||de(s[r])&&!Sn(s[r])?ue(a)||Jt(t[r])?t[r]=Array.isArray(s[r])?dt(s[r],[]):{...dt(s[r])}:Rn(s[r],be(a)?{}:a[r],t[r]):t[r]=!Ye(s[r],a[r]);return t}var Ss=(s,a)=>Rn(s,a,dt(a));const Ia={value:!1,isValid:!1},Fa={value:!0,isValid:!0};var Mn=s=>{if(Array.isArray(s)){if(s.length>1){const a=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:a,isValid:!!a.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!ue(s[0].attributes.value)?ue(s[0].value)||s[0].value===""?Fa:{value:s[0].value,isValid:!0}:Fa:Ia}return Ia},Pn=(s,{valueAsNumber:a,valueAsDate:t,setValueAs:n})=>ue(s)?s:a?s===""?NaN:s&&+s:t&&Le(s)?new Date(s):n?n(s):s;const La={isValid:!1,value:null};var An=s=>Array.isArray(s)?s.reduce((a,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:a,La):La;function $a(s){const a=s.ref;return oa(a)?a.files:ca(a)?An(s.refs).value:Cn(a)?[...a.selectedOptions].map(({value:t})=>t):Vs(a)?Mn(s.refs).value:Pn(ue(a.value)?s.ref.value:a.value,s)}var No=(s,a,t,n)=>{const r={};for(const i of s){const l=V(a,i);l&&ie(r,i,l._f)}return{criteriaMode:t,names:[...s],fields:r,shouldUseNativeValidation:n}},mt=s=>s instanceof RegExp,Rs=s=>ue(s)?s:mt(s)?s.source:de(s)?mt(s.value)?s.value.source:s.value:s,qa=s=>({isOnSubmit:!s||s===Re.onSubmit,isOnBlur:s===Re.onBlur,isOnChange:s===Re.onChange,isOnAll:s===Re.all,isOnTouch:s===Re.onTouched});const Ua="AsyncFunction";var wo=s=>!!s&&!!s.validate&&!!(Me(s.validate)&&s.validate.constructor.name===Ua||de(s.validate)&&Object.values(s.validate).find(a=>a.constructor.name===Ua)),ko=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),za=(s,a,t)=>!t&&(a.watchAll||a.watch.has(s)||[...a.watch].some(n=>s.startsWith(n)&&/^\.\w+/.test(s.slice(n.length))));const Es=(s,a,t,n)=>{for(const r of t||Object.keys(s)){const i=V(s,r);if(i){const{_f:l,...o}=i;if(l){if(l.refs&&l.refs[0]&&a(l.refs[0],r)&&!n)return!0;if(l.ref&&a(l.ref,l.name)&&!n)return!0;if(Es(o,a))break}else if(de(o)&&Es(o,a))break}}};function Oa(s,a,t){const n=V(s,t);if(n||bt(t))return{error:n,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),l=V(a,i),o=V(s,i);if(l&&!Array.isArray(l)&&t!==i)return{name:t};if(o&&o.type)return{name:i,error:o};if(o&&o.root&&o.root.type)return{name:`${i}.root`,error:o.root};r.pop()}return{name:t}}var Do=(s,a,t,n)=>{t(s);const{name:r,...i}=s;return Ne(i)||Object.keys(i).length>=Object.keys(a).length||Object.keys(i).find(l=>a[l]===(!n||Re.all))},Co=(s,a,t)=>!s||!a||s===a||As(s).some(n=>n&&(t?n===a:n.startsWith(a)||a.startsWith(n))),So=(s,a,t,n,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(a||s):(t?n.isOnBlur:r.isOnBlur)?!s:(t?n.isOnChange:r.isOnChange)?s:!0,Ro=(s,a)=>!ra(V(s,a)).length&&me(s,a),Mo=(s,a,t)=>{const n=As(V(s,t));return ie(n,"root",a[t]),ie(s,t,n),s},et=s=>Le(s);function _a(s,a,t="validate"){if(et(s)||Array.isArray(s)&&s.every(et)||Te(s)&&!s)return{type:t,message:et(s)?s:"",ref:a}}var ms=s=>de(s)&&!mt(s)?s:{value:s,message:""},Va=async(s,a,t,n,r,i)=>{const{ref:l,refs:o,required:c,maxLength:d,minLength:m,min:x,max:y,pattern:R,validate:k,name:S,valueAsNumber:v,mount:g}=s._f,u=V(t,S);if(!g||a.has(S))return{};const f=o?o[0]:l,b=N=>{r&&f.reportValidity&&(f.setCustomValidity(Te(N)?"":N||""),f.reportValidity())},h={},j=ca(l),F=Vs(l),P=j||F,M=(v||oa(l))&&ue(l.value)&&ue(u)||ct(l)&&l.value===""||u===""||Array.isArray(u)&&!u.length,D=yo.bind(null,S,n,h),T=(N,C,p,E=ze.maxLength,U=ze.minLength)=>{const W=N?C:p;h[S]={type:N?E:U,message:W,ref:l,...D(N?E:U,W)}};if(i?!Array.isArray(u)||!u.length:c&&(!P&&(M||be(u))||Te(u)&&!u||F&&!Mn(o).isValid||j&&!An(o).isValid)){const{value:N,message:C}=et(c)?{value:!!c,message:c}:ms(c);if(N&&(h[S]={type:ze.required,message:C,ref:f,...D(ze.required,C)},!n))return b(C),h}if(!M&&(!be(x)||!be(y))){let N,C;const p=ms(y),E=ms(x);if(!be(u)&&!isNaN(u)){const U=l.valueAsNumber||u&&+u;be(p.value)||(N=U>p.value),be(E.value)||(C=U<E.value)}else{const U=l.valueAsDate||new Date(u),W=Z=>new Date(new Date().toDateString()+" "+Z),H=l.type=="time",K=l.type=="week";Le(p.value)&&u&&(N=H?W(u)>W(p.value):K?u>p.value:U>new Date(p.value)),Le(E.value)&&u&&(C=H?W(u)<W(E.value):K?u<E.value:U<new Date(E.value))}if((N||C)&&(T(!!N,p.message,E.message,ze.max,ze.min),!n))return b(h[S].message),h}if((d||m)&&!M&&(Le(u)||i&&Array.isArray(u))){const N=ms(d),C=ms(m),p=!be(N.value)&&u.length>+N.value,E=!be(C.value)&&u.length<+C.value;if((p||E)&&(T(p,N.message,C.message),!n))return b(h[S].message),h}if(R&&!M&&Le(u)){const{value:N,message:C}=ms(R);if(mt(N)&&!u.match(N)&&(h[S]={type:ze.pattern,message:C,ref:l,...D(ze.pattern,C)},!n))return b(C),h}if(k){if(Me(k)){const N=await k(u,t),C=_a(N,f);if(C&&(h[S]={...C,...D(ze.validate,C.message)},!n))return b(C.message),h}else if(de(k)){let N={};for(const C in k){if(!Ne(N)&&!n)break;const p=_a(await k[C](u,t),f,C);p&&(N={...p,...D(C,p.message)},b(p.message),n&&(h[S]=N))}if(!Ne(N)&&(h[S]={ref:f,...N},!n))return h}}return b(!0),h};const Po={mode:Re.onSubmit,reValidateMode:Re.onChange,shouldFocusError:!0};function Ao(s={}){let a={...Po,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Me(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1},n={},r=de(a.defaultValues)||de(a.values)?ge(a.defaultValues||a.values)||{}:{},i=a.shouldUnregister?{}:ge(r),l={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const m={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let x={...m};const y={array:Ta(),state:Ta()},R=a.criteriaMode===Re.all,k=w=>A=>{clearTimeout(d),d=setTimeout(w,A)},S=async w=>{if(!a.disabled&&(m.isValid||x.isValid||w)){const A=a.resolver?Ne((await F()).errors):await M(n,!0);A!==t.isValid&&y.state.next({isValid:A})}},v=(w,A)=>{!a.disabled&&(m.isValidating||m.validatingFields||x.isValidating||x.validatingFields)&&((w||Array.from(o.mount)).forEach($=>{$&&(A?ie(t.validatingFields,$,A):me(t.validatingFields,$))}),y.state.next({validatingFields:t.validatingFields,isValidating:!Ne(t.validatingFields)}))},g=(w,A=[],$,_,O=!0,z=!0)=>{if(_&&$&&!a.disabled){if(l.action=!0,z&&Array.isArray(V(n,w))){const B=$(V(n,w),_.argA,_.argB);O&&ie(n,w,B)}if(z&&Array.isArray(V(t.errors,w))){const B=$(V(t.errors,w),_.argA,_.argB);O&&ie(t.errors,w,B),Ro(t.errors,w)}if((m.touchedFields||x.touchedFields)&&z&&Array.isArray(V(t.touchedFields,w))){const B=$(V(t.touchedFields,w),_.argA,_.argB);O&&ie(t.touchedFields,w,B)}(m.dirtyFields||x.dirtyFields)&&(t.dirtyFields=Ss(r,i)),y.state.next({name:w,isDirty:T(w,A),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ie(i,w,A)},u=(w,A)=>{ie(t.errors,w,A),y.state.next({errors:t.errors})},f=w=>{t.errors=w,y.state.next({errors:t.errors,isValid:!1})},b=(w,A,$,_)=>{const O=V(n,w);if(O){const z=V(i,w,ue($)?V(r,w):$);ue(z)||_&&_.defaultChecked||A?ie(i,w,A?z:$a(O._f)):p(w,z),l.mount&&S()}},h=(w,A,$,_,O)=>{let z=!1,B=!1;const L={name:w};if(!a.disabled){if(!$||_){(m.isDirty||x.isDirty)&&(B=t.isDirty,t.isDirty=L.isDirty=T(),z=B!==L.isDirty);const se=Ye(V(r,w),A);B=!!V(t.dirtyFields,w),se?me(t.dirtyFields,w):ie(t.dirtyFields,w,!0),L.dirtyFields=t.dirtyFields,z=z||(m.dirtyFields||x.dirtyFields)&&B!==!se}if($){const se=V(t.touchedFields,w);se||(ie(t.touchedFields,w,$),L.touchedFields=t.touchedFields,z=z||(m.touchedFields||x.touchedFields)&&se!==$)}z&&O&&y.state.next(L)}return z?L:{}},j=(w,A,$,_)=>{const O=V(t.errors,w),z=(m.isValid||x.isValid)&&Te(A)&&t.isValid!==A;if(a.delayError&&$?(c=k(()=>u(w,$)),c(a.delayError)):(clearTimeout(d),c=null,$?ie(t.errors,w,$):me(t.errors,w)),($?!Ye(O,$):O)||!Ne(_)||z){const B={..._,...z&&Te(A)?{isValid:A}:{},errors:t.errors,name:w};t={...t,...B},y.state.next(B)}},F=async w=>{v(w,!0);const A=await a.resolver(i,a.context,No(w||o.mount,n,a.criteriaMode,a.shouldUseNativeValidation));return v(w),A},P=async w=>{const{errors:A}=await F(w);if(w)for(const $ of w){const _=V(A,$);_?ie(t.errors,$,_):me(t.errors,$)}else t.errors=A;return A},M=async(w,A,$={valid:!0})=>{for(const _ in w){const O=w[_];if(O){const{_f:z,...B}=O;if(z){const L=o.array.has(z.name),se=O._f&&wo(O._f);se&&m.validatingFields&&v([_],!0);const pe=await Va(O,o.disabled,i,R,a.shouldUseNativeValidation&&!A,L);if(se&&m.validatingFields&&v([_]),pe[z.name]&&($.valid=!1,A))break;!A&&(V(pe,z.name)?L?Mo(t.errors,pe,z.name):ie(t.errors,z.name,pe[z.name]):me(t.errors,z.name))}!Ne(B)&&await M(B,A,$)}}return $.valid},D=()=>{for(const w of o.unMount){const A=V(n,w);A&&(A._f.refs?A._f.refs.every($=>!Ft($)):!Ft(A._f.ref))&&fe(w)}o.unMount=new Set},T=(w,A)=>!a.disabled&&(w&&A&&ie(i,w,A),!Ye(Z(),r)),N=(w,A,$)=>fo(w,o,{...l.mount?i:ue(A)?r:Le(w)?{[w]:A}:A},$,A),C=w=>ra(V(l.mount?i:r,w,a.shouldUnregister?V(r,w,[]):[])),p=(w,A,$={})=>{const _=V(n,w);let O=A;if(_){const z=_._f;z&&(!z.disabled&&ie(i,w,Pn(A,z)),O=ct(z.ref)&&be(A)?"":A,Cn(z.ref)?[...z.ref.options].forEach(B=>B.selected=O.includes(B.value)):z.refs?Vs(z.ref)?z.refs.forEach(B=>{(!B.defaultChecked||!B.disabled)&&(Array.isArray(O)?B.checked=!!O.find(L=>L===B.value):B.checked=O===B.value||!!O)}):z.refs.forEach(B=>B.checked=B.value===O):oa(z.ref)?z.ref.value="":(z.ref.value=O,z.ref.type||y.state.next({name:w,values:ge(i)})))}($.shouldDirty||$.shouldTouch)&&h(w,O,$.shouldTouch,$.shouldDirty,!0),$.shouldValidate&&K(w)},E=(w,A,$)=>{for(const _ in A){if(!A.hasOwnProperty(_))return;const O=A[_],z=w+"."+_,B=V(n,z);(o.array.has(w)||de(O)||B&&!B._f)&&!is(O)?E(z,O,$):p(z,O,$)}},U=(w,A,$={})=>{const _=V(n,w),O=o.array.has(w),z=ge(A);ie(i,w,z),O?(y.array.next({name:w,values:ge(i)}),(m.isDirty||m.dirtyFields||x.isDirty||x.dirtyFields)&&$.shouldDirty&&y.state.next({name:w,dirtyFields:Ss(r,i),isDirty:T(w,z)})):_&&!_._f&&!be(z)?E(w,z,$):p(w,z,$),za(w,o)&&y.state.next({...t,name:w}),y.state.next({name:l.mount?w:void 0,values:ge(i)})},W=async w=>{l.mount=!0;const A=w.target;let $=A.name,_=!0;const O=V(n,$),z=se=>{_=Number.isNaN(se)||is(se)&&isNaN(se.getTime())||Ye(se,V(i,$,se))},B=qa(a.mode),L=qa(a.reValidateMode);if(O){let se,pe;const he=A.type?$a(O._f):co(w),je=w.type===Ea.BLUR||w.type===Ea.FOCUS_OUT,kt=!ko(O._f)&&!a.resolver&&!V(t.errors,$)&&!O._f.deps||So(je,V(t.touchedFields,$),t.isSubmitted,L,B),Ds=za($,o,je);ie(i,$,he),je?(!A||!A.readOnly)&&(O._f.onBlur&&O._f.onBlur(w),c&&c(0)):O._f.onChange&&O._f.onChange(w);const ye=h($,he,je),ss=!Ne(ye)||Ds;if(!je&&y.state.next({name:$,type:w.type,values:ge(i)}),kt)return(m.isValid||x.isValid)&&(a.mode==="onBlur"?je&&S():je||S()),ss&&y.state.next({name:$,...Ds?{}:ye});if(!je&&Ds&&y.state.next({...t}),a.resolver){const{errors:ts}=await F([$]);if(z(he),_){const Gs=Oa(t.errors,n,$),Cs=Oa(ts,n,Gs.name||$);se=Cs.error,$=Cs.name,pe=Ne(ts)}}else v([$],!0),se=(await Va(O,o.disabled,i,R,a.shouldUseNativeValidation))[$],v([$]),z(he),_&&(se?pe=!1:(m.isValid||x.isValid)&&(pe=await M(n,!0)));_&&(O._f.deps&&K(O._f.deps),j($,pe,se,ye))}},H=(w,A)=>{if(V(t.errors,A)&&w.focus)return w.focus(),1},K=async(w,A={})=>{let $,_;const O=As(w);if(a.resolver){const z=await P(ue(w)?w:O);$=Ne(z),_=w?!O.some(B=>V(z,B)):$}else w?(_=(await Promise.all(O.map(async z=>{const B=V(n,z);return await M(B&&B._f?{[z]:B}:B)}))).every(Boolean),!(!_&&!t.isValid)&&S()):_=$=await M(n);return y.state.next({...!Le(w)||(m.isValid||x.isValid)&&$!==t.isValid?{}:{name:w},...a.resolver||!w?{isValid:$}:{},errors:t.errors}),A.shouldFocus&&!_&&Es(n,H,w?O:o.mount),_},Z=w=>{const A={...l.mount?i:r};return ue(w)?A:Le(w)?V(A,w):w.map($=>V(A,$))},Q=(w,A)=>({invalid:!!V((A||t).errors,w),isDirty:!!V((A||t).dirtyFields,w),error:V((A||t).errors,w),isValidating:!!V(t.validatingFields,w),isTouched:!!V((A||t).touchedFields,w)}),le=w=>{w&&As(w).forEach(A=>me(t.errors,A)),y.state.next({errors:w?t.errors:{}})},ne=(w,A,$)=>{const _=(V(n,w,{_f:{}})._f||{}).ref,O=V(t.errors,w)||{},{ref:z,message:B,type:L,...se}=O;ie(t.errors,w,{...se,...A,ref:_}),y.state.next({name:w,errors:t.errors,isValid:!1}),$&&$.shouldFocus&&_&&_.focus&&_.focus()},G=(w,A)=>Me(w)?y.state.subscribe({next:$=>"values"in $&&w(N(void 0,A),$)}):N(w,A,!0),ve=w=>y.state.subscribe({next:A=>{Co(w.name,A.name,w.exact)&&Do(A,w.formState||m,Hs,w.reRenderRoot)&&w.callback({values:{...i},...t,...A,defaultValues:r})}}).unsubscribe,oe=w=>(l.mount=!0,x={...x,...w.formState},ve({...w,formState:x})),fe=(w,A={})=>{for(const $ of w?As(w):o.mount)o.mount.delete($),o.array.delete($),A.keepValue||(me(n,$),me(i,$)),!A.keepError&&me(t.errors,$),!A.keepDirty&&me(t.dirtyFields,$),!A.keepTouched&&me(t.touchedFields,$),!A.keepIsValidating&&me(t.validatingFields,$),!a.shouldUnregister&&!A.keepDefaultValue&&me(r,$);y.state.next({values:ge(i)}),y.state.next({...t,...A.keepDirty?{isDirty:T()}:{}}),!A.keepIsValid&&S()},qe=({disabled:w,name:A})=>{(Te(w)&&l.mount||w||o.disabled.has(A))&&(w?o.disabled.add(A):o.disabled.delete(A))},Ee=(w,A={})=>{let $=V(n,w);const _=Te(A.disabled)||Te(a.disabled);return ie(n,w,{...$||{},_f:{...$&&$._f?$._f:{ref:{name:w}},name:w,mount:!0,...A}}),o.mount.add(w),$?qe({disabled:Te(A.disabled)?A.disabled:a.disabled,name:w}):b(w,!0,A.value),{..._?{disabled:A.disabled||a.disabled}:{},...a.progressive?{required:!!A.required,min:Rs(A.min),max:Rs(A.max),minLength:Rs(A.minLength),maxLength:Rs(A.maxLength),pattern:Rs(A.pattern)}:{},name:w,onChange:W,onBlur:W,ref:O=>{if(O){Ee(w,A),$=V(n,w);const z=ue(O.value)&&O.querySelectorAll&&O.querySelectorAll("input,select,textarea")[0]||O,B=vo(z),L=$._f.refs||[];if(B?L.find(se=>se===z):z===$._f.ref)return;ie(n,w,{_f:{...$._f,...B?{refs:[...L.filter(Ft),z,...Array.isArray(V(r,w))?[{}]:[]],ref:{type:z.type,name:w}}:{ref:z}}}),b(w,!1,void 0,z)}else $=V(n,w,{}),$._f&&($._f.mount=!1),(a.shouldUnregister||A.shouldUnregister)&&!(uo(o.array,w)&&l.action)&&o.unMount.add(w)}}},Be=()=>a.shouldFocusError&&Es(n,H,o.mount),Nt=w=>{Te(w)&&(y.state.next({disabled:w}),Es(n,(A,$)=>{const _=V(n,$);_&&(A.disabled=_._f.disabled||w,Array.isArray(_._f.refs)&&_._f.refs.forEach(O=>{O.disabled=_._f.disabled||w}))},0,!1))},Ws=(w,A)=>async $=>{let _;$&&($.preventDefault&&$.preventDefault(),$.persist&&$.persist());let O=ge(i);if(y.state.next({isSubmitting:!0}),a.resolver){const{errors:z,values:B}=await F();t.errors=z,O=ge(B)}else await M(n);if(o.disabled.size)for(const z of o.disabled)me(O,z);if(me(t.errors,"root"),Ne(t.errors)){y.state.next({errors:{}});try{await w(O,$)}catch(z){_=z}}else A&&await A({...t.errors},$),Be(),setTimeout(Be);if(y.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ne(t.errors)&&!_,submitCount:t.submitCount+1,errors:t.errors}),_)throw _},wt=(w,A={})=>{V(n,w)&&(ue(A.defaultValue)?U(w,ge(V(r,w))):(U(w,A.defaultValue),ie(r,w,ge(A.defaultValue))),A.keepTouched||me(t.touchedFields,w),A.keepDirty||(me(t.dirtyFields,w),t.isDirty=A.defaultValue?T(w,ge(V(r,w))):T()),A.keepError||(me(t.errors,w),m.isValid&&S()),y.state.next({...t}))},ws=(w,A={})=>{const $=w?ge(w):r,_=ge($),O=Ne(w),z=O?r:_;if(A.keepDefaultValues||(r=$),!A.keepValues){if(A.keepDirtyValues){const B=new Set([...o.mount,...Object.keys(Ss(r,i))]);for(const L of Array.from(B))V(t.dirtyFields,L)?ie(z,L,V(i,L)):U(L,V(z,L))}else{if(ia&&ue(w))for(const B of o.mount){const L=V(n,B);if(L&&L._f){const se=Array.isArray(L._f.refs)?L._f.refs[0]:L._f.ref;if(ct(se)){const pe=se.closest("form");if(pe){pe.reset();break}}}}if(A.keepFieldsRef)for(const B of o.mount)U(B,V(z,B));else n={}}i=a.shouldUnregister?A.keepDefaultValues?ge(r):{}:ge(z),y.array.next({values:{...z}}),y.state.next({values:{...z}})}o={mount:A.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!m.isValid||!!A.keepIsValid||!!A.keepDirtyValues,l.watch=!!a.shouldUnregister,y.state.next({submitCount:A.keepSubmitCount?t.submitCount:0,isDirty:O?!1:A.keepDirty?t.isDirty:!!(A.keepDefaultValues&&!Ye(w,r)),isSubmitted:A.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:O?{}:A.keepDirtyValues?A.keepDefaultValues&&i?Ss(r,i):t.dirtyFields:A.keepDefaultValues&&w?Ss(r,w):A.keepDirty?t.dirtyFields:{},touchedFields:A.keepTouched?t.touchedFields:{},errors:A.keepErrors?t.errors:{},isSubmitSuccessful:A.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Bs=(w,A)=>ws(Me(w)?w(i):w,A),ks=(w,A={})=>{const $=V(n,w),_=$&&$._f;if(_){const O=_.refs?_.refs[0]:_.ref;O.focus&&(O.focus(),A.shouldSelect&&Me(O.select)&&O.select())}},Hs=w=>{t={...t,...w}},Ys={control:{register:Ee,unregister:fe,getFieldState:Q,handleSubmit:Ws,setError:ne,_subscribe:ve,_runSchema:F,_focusError:Be,_getWatch:N,_getDirty:T,_setValid:S,_setFieldArray:g,_setDisabledField:qe,_setErrors:f,_getFieldArray:C,_reset:ws,_resetDefaultValues:()=>Me(a.defaultValues)&&a.defaultValues().then(w=>{Bs(w,a.resetOptions),y.state.next({isLoading:!1})}),_removeUnmounted:D,_disableForm:Nt,_subjects:y,_proxyFormState:m,get _fields(){return n},get _formValues(){return i},get _state(){return l},set _state(w){l=w},get _defaultValues(){return r},get _names(){return o},set _names(w){o=w},get _formState(){return t},get _options(){return a},set _options(w){a={...a,...w}}},subscribe:oe,trigger:K,register:Ee,handleSubmit:Ws,watch:G,setValue:U,getValues:Z,reset:Bs,resetField:wt,clearErrors:le,unregister:fe,setError:ne,setFocus:ks,getFieldState:Q};return{...Ys,formControl:Ys}}function jt(s={}){const a=I.useRef(void 0),t=I.useRef(void 0),[n,r]=I.useState({isDirty:!1,isValidating:!1,isLoading:Me(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:Me(s.defaultValues)?void 0:s.defaultValues});if(!a.current)if(s.formControl)a.current={...s.formControl,formState:n},s.defaultValues&&!Me(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:l,...o}=Ao(s);a.current={...o,formState:n}}const i=a.current.control;return i._options=s,po(()=>{const l=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(o=>({...o,isReady:!0})),i._formState.isReady=!0,l},[i]),I.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),I.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),I.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),I.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),I.useEffect(()=>{if(i._proxyFormState.isDirty){const l=i._getDirty();l!==n.isDirty&&i._subjects.state.next({isDirty:l})}},[i,n.isDirty]),I.useEffect(()=>{s.values&&!Ye(s.values,t.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=s.values,r(l=>({...l}))):i._resetDefaultValues()},[i,s.values]),I.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),a.current.formState=go(n,i),a.current}const Eo=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1","#14b8a6","#f43f5e","#dc2626","#059669","#d97706"];function To({isOpen:s,onClose:a,medication:t}){const{addMedication:n,updateMedication:r}=ae(),i=!!t,[l,o]=I.useState([]),[c,d]=I.useState(!1),[m,x]=I.useState(null),[y,R]=I.useState(null),{register:k,handleSubmit:S,watch:v,setValue:g,reset:u,formState:{errors:f}}=jt({defaultValues:{name:"",dosage:"",unit:"mg",frequency:"once-daily",category:"prescription",notes:"",sideEffects:"",interactions:"",prescribedBy:"",pharmacy:"",pillsRemaining:0,totalPills:0,refillReminder:!0,color:Ca(),startDate:new Date().toISOString().split("T")[0],endDate:"",maxDailyDose:0,enableCyclicDosing:!1,enableTapering:!1}}),b=v("color"),h=v("name"),j=M=>{if(M.length>=2){const D=eo(M,8);o(D),d(!0)}else o([]),d(!1)},F=M=>{const D=_s(M);if(D)if(g("name",D.name),g("category",D.category),D.commonDosages.length>0&&g("dosage",D.commonDosages[0]),D.commonUnits.length>0&&g("unit",D.commonUnits[0]),D.commonFrequencies.length>0&&g("frequency",D.commonFrequencies[0]),D.commonSideEffects&&g("sideEffects",D.commonSideEffects.join(", ")),D.commonInteractions&&g("interactions",D.commonInteractions.join(", ")),x(D),d(!1),D.taperingRequired){const T=parseFloat(D.commonDosages[0]||"0"),N=wn(D.name,T,D.commonUnits[0]||"mg");R(N)}else R(null)};I.useEffect(()=>{h&&!i?j(h):h||(d(!1),x(null),R(null))},[h,i]),I.useEffect(()=>{var M,D;s&&u(t?{name:t.name,dosage:t.dosage,unit:t.unit,frequency:t.frequency,category:t.category,notes:t.notes||"",sideEffects:((M=t.sideEffects)==null?void 0:M.join(", "))||"",interactions:((D=t.interactions)==null?void 0:D.join(", "))||"",prescribedBy:t.prescribedBy||"",pharmacy:t.pharmacy||"",pillsRemaining:t.pillsRemaining||0,totalPills:t.totalPills||0,refillReminder:t.refillReminder||!1,color:t.color,startDate:t.startDate instanceof Date?t.startDate.toISOString().split("T")[0]:new Date(t.startDate).toISOString().split("T")[0],endDate:t.endDate?t.endDate instanceof Date?t.endDate.toISOString().split("T")[0]:new Date(t.endDate).toISOString().split("T")[0]:"",maxDailyDose:t.maxDailyDose||0,enableCyclicDosing:!!t.cyclicDosing,enableTapering:!!t.tapering}:{name:"",dosage:"",unit:"mg",frequency:"once-daily",category:"prescription",notes:"",sideEffects:"",interactions:"",prescribedBy:"",pharmacy:"",pillsRemaining:0,totalPills:0,refillReminder:!0,color:Ca(),startDate:new Date().toISOString().split("T")[0],endDate:"",maxDailyDose:0,enableCyclicDosing:!1,enableTapering:!1})},[s,t,u]);const P=M=>{var T,N,C;const D={name:M.name.trim(),dosage:M.dosage.trim(),unit:M.unit,frequency:M.frequency,category:M.category,color:M.color,notes:((T=M.notes)==null?void 0:T.trim())||void 0,sideEffects:M.sideEffects?M.sideEffects.split(",").map(p=>p.trim()).filter(Boolean):void 0,interactions:M.interactions?M.interactions.split(",").map(p=>p.trim()).filter(Boolean):void 0,prescribedBy:((N=M.prescribedBy)==null?void 0:N.trim())||void 0,pharmacy:((C=M.pharmacy)==null?void 0:C.trim())||void 0,pillsRemaining:M.pillsRemaining||void 0,totalPills:M.totalPills||void 0,refillReminder:M.refillReminder,isCustom:!0,isActive:!0,startDate:new Date(M.startDate),endDate:M.endDate?new Date(M.endDate):void 0,maxDailyDose:M.maxDailyDose||void 0};i&&t?(r(t.id,D),J.success("Medication updated successfully")):(n({...D,riskLevel:"low",dependencyRiskCategory:"low-risk"}),J.success("Medication added successfully")),a()};return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:a}),e.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:e.jsxs("form",{onSubmit:S(P),children:[e.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i?"Edit Medication":"Add New Medication"}),e.jsx("button",{type:"button",onClick:a,className:"rounded-md bg-white text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Medication Name *"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",...k("name",{required:"Medication name is required"}),className:"input mt-1 pl-10",placeholder:"Search medications, supplements, vitamins...",onFocus:()=>h&&h.length>=2&&d(!0),onBlur:()=>setTimeout(()=>d(!1),200)})]}),c&&l.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:l.map((M,D)=>e.jsx("button",{type:"button",onClick:()=>F(M.name),className:"w-full text-left px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:M.name}),e.jsx("div",{className:"text-sm text-gray-500",children:M.description})]}),e.jsxs("div",{className:"flex flex-col items-end ml-4",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${M.category==="prescription"?"bg-blue-100 text-blue-800":M.category==="over-the-counter"?"bg-green-100 text-green-800":M.category==="supplement"?"bg-yellow-100 text-yellow-800":M.category==="vitamin"?"bg-purple-100 text-purple-800":M.category==="herbal"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:M.category}),e.jsxs("span",{className:`mt-1 text-xs px-1 py-0.5 rounded ${M.riskLevel==="high"?"bg-red-100 text-red-600":M.riskLevel==="moderate"?"bg-orange-100 text-orange-600":M.riskLevel==="low"?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600"}`,children:[M.riskLevel," risk"]})]})]})},`${M.name}-${D}`))})]}),f.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.name.message}),m&&e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(sa,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Medication Auto-filled"})]}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:m.description}),m.withdrawalRisk!=="none"&&e.jsxs("p",{className:"text-sm text-orange-600 mt-1 font-medium",children:["⚠️ Withdrawal Risk: ",m.withdrawalRisk]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dosage *"}),e.jsx("input",{type:"text",...k("dosage",{required:"Dosage is required"}),className:"input mt-1",placeholder:"e.g., 50"}),f.dosage&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.dosage.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit *"}),e.jsxs("select",{...k("unit"),className:"input mt-1",children:[e.jsx("option",{value:"mg",children:"mg"}),e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"mcg",children:"mcg"}),e.jsx("option",{value:"ml",children:"ml"}),e.jsx("option",{value:"tablets",children:"tablets"}),e.jsx("option",{value:"capsules",children:"capsules"}),e.jsx("option",{value:"drops",children:"drops"}),e.jsx("option",{value:"sprays",children:"sprays"}),e.jsx("option",{value:"patches",children:"patches"}),e.jsx("option",{value:"iu",children:"IU"}),e.jsx("option",{value:"units",children:"units"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Frequency *"}),e.jsxs("select",{...k("frequency"),className:"input mt-1",children:[e.jsx("option",{value:"as-needed",children:"As needed"}),e.jsx("option",{value:"once-daily",children:"Once daily"}),e.jsx("option",{value:"twice-daily",children:"Twice daily"}),e.jsx("option",{value:"three-times-daily",children:"Three times daily"}),e.jsx("option",{value:"four-times-daily",children:"Four times daily"}),e.jsx("option",{value:"every-other-day",children:"Every other day"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category *"}),e.jsxs("select",{...k("category"),className:"input mt-1",children:[e.jsx("option",{value:"prescription",children:"Prescription"}),e.jsx("option",{value:"over-the-counter",children:"Over-the-counter"}),e.jsx("option",{value:"supplement",children:"Supplement"}),e.jsx("option",{value:"vitamin",children:"Vitamin"}),e.jsx("option",{value:"herbal",children:"Herbal"}),e.jsx("option",{value:"injection",children:"Injection"}),e.jsx("option",{value:"topical",children:"Topical"}),e.jsx("option",{value:"emergency",children:"Emergency"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundColor:b}}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Eo.map((M,D)=>e.jsx("button",{type:"button",onClick:()=>g("color",M),className:`w-6 h-6 rounded-full border-2 ${b===M?"border-gray-900":"border-gray-300"}`,style:{backgroundColor:M}},`color-${D}-${M}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date *"}),e.jsx("input",{type:"date",...k("startDate",{required:"Start date is required"}),className:"input mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date (Optional)"}),e.jsx("input",{type:"date",...k("endDate"),className:"input mt-1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Inventory Management"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pills Remaining"}),e.jsx("input",{type:"number",min:"0",...k("pillsRemaining",{valueAsNumber:!0}),className:"input mt-1",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Pills"}),e.jsx("input",{type:"number",min:"0",...k("totalPills",{valueAsNumber:!0}),className:"input mt-1",placeholder:"0"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...k("refillReminder"),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Enable refill reminders"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prescribed By"}),e.jsx("input",{type:"text",...k("prescribedBy"),className:"input mt-1",placeholder:"Doctor's name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pharmacy"}),e.jsx("input",{type:"text",...k("pharmacy"),className:"input mt-1",placeholder:"Pharmacy name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{...k("notes"),rows:3,className:"input mt-1",placeholder:"Any additional notes about this medication..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Side Effects (comma-separated)"}),e.jsx("input",{type:"text",...k("sideEffects"),className:"input mt-1",placeholder:"e.g., nausea, headache, dizziness"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Drug Interactions (comma-separated)"}),e.jsx("input",{type:"text",...k("interactions"),className:"input mt-1",placeholder:"e.g., aspirin, warfarin"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Advanced Features"}),y&&e.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-3",children:e.jsx("span",{className:"text-orange-600 font-medium",children:"⚠️ Tapering Plan Required"})}),e.jsx("p",{className:"text-sm text-orange-700 mb-3",children:"This medication requires gradual tapering to prevent withdrawal symptoms."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Method:"})," ",y.method]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Duration:"})," ",y.totalDuration," days"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Risk Level:"})," ",y.riskLevel]}),y.steps.length>0&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-sm font-medium text-orange-700 cursor-pointer",children:"View Tapering Schedule"}),e.jsxs("div",{className:"mt-2 space-y-1",children:[y.steps.slice(0,3).map((M,D)=>e.jsxs("div",{className:"text-xs text-orange-600 pl-4",children:["• ",M.notes]},D)),y.steps.length>3&&e.jsxs("div",{className:"text-xs text-orange-500 pl-4",children:["... and ",y.steps.length-3," more steps"]})]})]}),e.jsxs("div",{className:"mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800",children:[e.jsx("strong",{children:"Important:"})," Always consult your healthcare provider before starting any tapering schedule."]})]})]}),v("name")&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Risk Assessment:"}),e.jsxs("span",{className:`badge ${Ms(hs(v("name")))==="high"?"badge-danger":Ms(hs(v("name")))==="moderate"?"badge-warning":Ms(hs(v("name")))==="low"?"badge-success":"badge-secondary"}`,children:[Ms(hs(v("name")))," risk"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Category: ",hs(v("name")).replace("-"," ")]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Maximum Daily Dose (Safety Limit)"}),e.jsx("input",{type:"number",min:"0",step:"0.1",...k("maxDailyDose",{valueAsNumber:!0}),className:"input mt-1",placeholder:"Optional safety limit"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Set a maximum daily dose to prevent accidental overdosing"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...k("enableCyclicDosing"),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Enable cyclic dosing patterns"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Support for on/off cycles, tapering schedules, and variable dosing"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...k("enableTapering"),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Enable tapering schedule"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Gradual dose reduction to safely discontinue medication"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"submit",className:"btn-primary w-full sm:ml-3 sm:w-auto",children:i?"Update Medication":"Add Medication"}),e.jsx("button",{type:"button",onClick:a,className:"btn-secondary mt-3 w-full sm:mt-0 sm:w-auto",children:"Cancel"})]})]})})]})}):null}function Io({isOpen:s,onClose:a,medication:t}){const{updateMedication:n,addSmartMessage:r}=ae(),[i,l]=I.useState(null),[o,c]=I.useState(null),[d,m]=I.useState("intelligent"),[x,y]=I.useState(4),[R,k]=I.useState(25),[S,v]=I.useState("hyperbolic"),[g,u]=I.useState(!1);I.useState(!1);const[f,b]=I.useState(new Date().toISOString().split("T")[0]),[h,j]=I.useState(!1),[F,P]=I.useState(!1);I.useEffect(()=>{if(s&&t){const p=parseFloat(t.dosage),E=kn(t.name,p,t.unit,t);c(E);const U=Pa(t.name,p,t.unit,t);l(U),E!=null&&E.adjustedPlan&&(y(E.adjustedPlan.durationWeeks),k(E.adjustedPlan.reductionPercent),v(E.adjustedPlan.method))}},[s,t]);const M=()=>{const p=parseFloat(t.dosage);return Pa(t.name,p,t.unit,t,{preferredMethod:S,preferredDuration:x,preferredReduction:R,includeStabilizationPeriods:g})||{medicationName:t.name,method:S,totalDuration:x*7,steps:[],warnings:["Custom tapering plan - consult with your healthcare provider","Monitor for withdrawal symptoms and adjust pace if necessary","Never stop abruptly if experiencing severe withdrawal symptoms"],riskLevel:"moderate",canPause:!0,flexibilityNotes:"This custom schedule can be paused or slowed at any point."}},D=()=>d==="custom"||d==="advanced"?M():i,T=()=>{if(!h||!F){J.error("Please confirm doctor approval and understanding before starting");return}const p=D();if(!p)return;const E={id:`tapering-${Date.now()}`,startDate:new Date(f),endDate:new Date(new Date(f).getTime()+p.totalDuration*24*60*60*1e3),initialDose:parseFloat(t.dosage),finalDose:0,taperingMethod:p.method,customSteps:p.steps.map(U=>({day:U.day,dosageMultiplier:U.dose/parseFloat(t.dosage),notes:U.notes})),isActive:!0};n(t.id,{tapering:{...E,canPause:p.canPause||!1,flexibilityNotes:p.flexibilityNotes,intelligentRecommendations:p.intelligentRecommendations,customizationUsed:p.customizationUsed,includeStabilizationPeriods:p.includeStabilizationPeriods}}),r({medicationId:t.id,type:"risk-alert",priority:"high",title:"Tapering Schedule Started",message:`You've started a ${p.totalDuration}-day tapering schedule for ${t.name}. Remember to monitor for withdrawal symptoms and contact your healthcare provider if you experience any concerning effects.`,psychologicalApproach:"empathetic-support",scheduledTime:new Date,expiresAt:new Date(Date.now()+7*24*60*60*1e3)}),J.success(`Tapering plan started for ${t.name}`),a()},N=p=>{switch(p){case"severe":return"text-red-700 bg-red-100 border-red-300";case"high":return"text-red-600 bg-red-50 border-red-200";case"moderate":return"text-orange-600 bg-orange-50 border-orange-200";case"low":return"text-yellow-600 bg-yellow-50 border-yellow-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},C=D();return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:a}),e.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl",children:[e.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ls,{className:"h-6 w-6 text-orange-600"}),e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Tapering Plan for ",t.name]})]}),e.jsx("button",{type:"button",onClick:a,className:"rounded-md bg-white text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Important Safety Information"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Never stop this medication abruptly - serious withdrawal symptoms may occur"}),e.jsx("li",{children:"This tapering plan must be supervised by your healthcare provider"}),e.jsx("li",{children:"Monitor for withdrawal symptoms and contact your doctor if they become severe"}),e.jsx("li",{children:"Do not adjust the schedule without medical guidance"})]})})]})]})}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Dose:"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[t.dosage," ",t.unit]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Risk Level:"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded text-sm font-medium ${N((C==null?void 0:C.riskLevel)||"moderate")}`,children:[(C==null?void 0:C.riskLevel)||"moderate"," withdrawal risk"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Category:"}),e.jsx("p",{className:"text-sm text-gray-900",children:t.dependencyRiskCategory.replace("-"," ")})]})]})}),o&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Oe,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Intelligent Tapering Analysis"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Based on your ",o.monthsOnMedication," months of ",t.name," use"]}),o.adjustmentReasons.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:o.adjustmentReasons.map((p,E)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(mn,{className:"h-3 w-3 text-amber-500 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-blue-700",children:p})]},E))}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-blue-800",children:"Suggested Duration"}),e.jsxs("div",{className:"text-blue-600",children:[o.adjustedPlan.durationWeeks," weeks"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-blue-800",children:"Reduction Rate"}),e.jsxs("div",{className:"text-blue-600",children:[o.adjustedPlan.reductionPercent,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-blue-800",children:"Method"}),e.jsx("div",{className:"text-blue-600",children:o.adjustedPlan.method})]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Choose Tapering Approach"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:`border rounded-lg p-3 cursor-pointer transition-colors ${d==="intelligent"?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>m("intelligent"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"radio",checked:d==="intelligent",onChange:()=>m("intelligent"),className:"text-blue-600"}),e.jsx(Oe,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Smart Plan"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI-optimized schedule based on your medication history and risk factors"}),i&&e.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[e.jsx("strong",{children:"Duration:"})," ",i.totalDuration," days",e.jsx("br",{}),e.jsx("strong",{children:"Method:"})," ",i.method==="hyperbolic"?"Hyperbolic":i.method]})]}),e.jsxs("div",{className:`border rounded-lg p-3 cursor-pointer transition-colors ${d==="custom"?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>m("custom"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"radio",checked:d==="custom",onChange:()=>m("custom"),className:"text-blue-600"}),e.jsx(Fs,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Basic Custom"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Simple customization of duration and reduction rate"})]}),e.jsxs("div",{className:`border rounded-lg p-3 cursor-pointer transition-colors ${d==="advanced"?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>m("advanced"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"radio",checked:d==="advanced",onChange:()=>m("advanced"),className:"text-blue-600"}),e.jsx(Fs,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Advanced"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Full customization with method selection and stabilization periods"})]})]}),d==="custom"&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (weeks)"}),e.jsx("input",{type:"number",min:"1",max:"52",value:x,onChange:p=>y(parseInt(p.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}),o&&x<o.adjustedPlan.durationWeeks&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:["⚠️ Shorter than recommended (",o.adjustedPlan.durationWeeks," weeks)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reduction Rate (%)"}),e.jsx("input",{type:"number",min:"1",max:"50",value:R,onChange:p=>k(parseInt(p.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}),o&&R>o.adjustedPlan.reductionPercent&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:["⚠️ Faster than recommended (",o.adjustedPlan.reductionPercent,"%)"]})]})]})}),d==="advanced"&&e.jsx("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (weeks)"}),e.jsx("input",{type:"number",min:"1",max:"52",value:x,onChange:p=>y(parseInt(p.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reduction Rate (%)"}),e.jsx("input",{type:"number",min:"1",max:"50",value:R,onChange:p=>k(parseInt(p.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tapering Method"}),e.jsxs("select",{value:S,onChange:p=>v(p.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[e.jsx("option",{value:"hyperbolic",children:"Hyperbolic (Recommended)"}),e.jsx("option",{value:"linear",children:"Linear"}),e.jsx("option",{value:"exponential",children:"Exponential"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"stabilization",checked:g,onChange:p=>u(p.target.checked),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"stabilization",className:"text-sm text-gray-700",children:"Include stabilization periods between reductions"})]}),e.jsxs("div",{className:"text-xs text-gray-600 bg-white p-2 rounded border",children:[e.jsx("strong",{children:"Method Explanations:"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Hyperbolic:"})," Reduces by % of current dose (e.g., 10% of whatever you're taking now)",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Linear:"})," Reduces by fixed amount each step",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Exponential:"})," Larger reductions early, smaller reductions later"]})]})})]}),C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-md font-medium text-gray-900 flex items-center space-x-2",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{children:"Tapering Schedule"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:f,onChange:p=>b(p.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated End Date"}),e.jsx("p",{className:"text-sm text-gray-900 py-2",children:te(new Date(new Date(f).getTime()+C.totalDuration*24*60*60*1e3))})]})]}),e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:C.steps.map((p,E)=>e.jsx("div",{className:"bg-white p-3 rounded border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-800",children:E+1})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.notes}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Day ",p.day," • ",te(new Date(new Date(f).getTime()+p.day*24*60*60*1e3))]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.useMultiplePills?xl(hl(p.dose,t),t):`${p.dose} ${t.unit}`}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Math.round(p.dose/parseFloat(t.dosage)*100),"% of original"]})]})]})},E))})]})]}),C&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-800 mb-2",children:"Safety Warnings & Guidelines"}),e.jsx("div",{className:"space-y-2",children:C.warnings.map((p,E)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-orange-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-orange-700",children:p})]},E))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Required Confirmations"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:p=>j(p.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Doctor Approval"}),e.jsx("p",{className:"text-sm text-gray-600",children:"I have discussed this tapering plan with my healthcare provider and received their approval to proceed."})]})]}),e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:F,onChange:p=>P(p.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Understanding & Commitment"}),e.jsx("p",{className:"text-sm text-gray-600",children:"I understand the risks of withdrawal and commit to following this schedule exactly as planned, monitoring for symptoms, and contacting my healthcare provider if problems arise."})]})]})]})]}),(C==null?void 0:C.canPause)&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ke,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Flexible Tapering Schedule"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:C.flexibilityNotes||"This schedule can be paused or slowed at any point if withdrawal symptoms become problematic. Your comfort and safety always take priority over the timeline."})]})]})}),e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Qe,{className:"h-5 w-5 text-purple-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-purple-800",children:"You're Taking a Positive Step"}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"Safely tapering off medication shows responsibility and commitment to your health. This process requires patience and support. Remember that it's normal to feel anxious about reducing medication - you're not alone, and your healthcare team is here to help."})]})]})})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"button",onClick:T,disabled:!h||!F,className:"w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed sm:ml-3 sm:w-auto",children:"Start Tapering Plan"}),e.jsx("button",{type:"button",onClick:a,className:"mt-3 w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Cancel"})]})]})]})}):null}function da({isOpen:s,onClose:a,onConfirm:t,title:n,message:r,confirmText:i="Confirm",cancelText:l="Cancel",variant:o="danger"}){if(!s)return null;const c=()=>{t(),a()};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto mobile-safe-area",children:e.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:a}),e.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 w-full max-w-lg mx-4 sm:mx-0",children:[e.jsx("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:Ze("mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full sm:mx-0 sm:h-10 sm:w-10",o==="danger"&&"bg-red-100",o==="warning"&&"bg-yellow-100",o==="info"&&"bg-blue-100"),children:e.jsx(X,{className:Ze("h-6 w-6",o==="danger"&&"text-red-600",o==="warning"&&"text-yellow-600",o==="info"&&"text-blue-600")})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left flex-1",children:[e.jsx("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:n}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:r})})]}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("button",{onClick:a,className:"rounded-md bg-white text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-5 w-5"})})})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 flex flex-col-reverse space-y-2 space-y-reverse sm:flex-row sm:space-y-0 sm:space-x-2 sm:px-6",children:[e.jsx("button",{type:"button",onClick:a,className:"inline-flex w-full justify-center rounded-md bg-white px-4 py-3 sm:py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 touch-target sm:w-auto",children:l}),e.jsx("button",{type:"button",onClick:c,className:Ze("inline-flex w-full justify-center rounded-md px-4 py-3 sm:py-2 text-sm font-semibold text-white shadow-sm touch-target sm:w-auto",o==="danger"&&"bg-red-600 hover:bg-red-500 active:bg-red-700",o==="warning"&&"bg-yellow-600 hover:bg-yellow-500 active:bg-yellow-700",o==="info"&&"bg-blue-600 hover:bg-blue-500 active:bg-blue-700"),children:i})]})]})]})})}function Fo({medicationId:s,onClose:a}){const{medications:t,addPillConfiguration:n,addDoseConfiguration:r,enableMultiplePills:i,calculateTotalDoseFromPills:l,updateMedication:o}=ae(),c=t.find(b=>b.id===s),[d,m]=q.useState(()=>c!=null&&c.pillConfigurations&&c.pillConfigurations.length>0?c.pillConfigurations.map(b=>({strength:b.strength,unit:b.unit,color:b.color||"white",shape:b.shape||"round",isActive:b.isActive!==!1,markings:b.markings||""})):[{strength:parseFloat((c==null?void 0:c.dosage)||"1"),unit:(c==null?void 0:c.unit)||"mg",color:"white",shape:"round",isActive:!0,markings:""}]),[x,y]=q.useState(()=>{if(c!=null&&c.doseConfigurations&&c.doseConfigurations.length>0){const b=c.doseConfigurations.find(h=>h.id===c.defaultDoseConfigurationId)||c.doseConfigurations[0];if(b!=null&&b.pillComponents)return b.pillComponents.map(h=>({quantity:h.quantity,timing:"together"}))}return[{quantity:1,timing:"together"}]});if(!c)return null;const R=()=>{m([...d,{strength:1,unit:c.unit,color:"white",shape:"round",isActive:!0}])},k=b=>{d.length>1&&(m(d.filter((h,j)=>j!==b)),y(x.filter((h,j)=>j!==b)))},S=(b,h)=>{m(d.map((j,F)=>F===b?{...j,...h}:j))},v=(b,h)=>{y(x.map((j,F)=>F===b?{...j,...h}:j))},g=()=>{x.length<d.length&&y([...x,{quantity:1,timing:"together"}])},u=()=>{let b=0;return x.forEach((h,j)=>{d[j]&&(b+=d[j].strength*h.quantity)}),b},f=()=>{const b=d.map(F=>({...F,id:ee()})),h={id:ee(),name:"Standard Dose",pillComponents:x.map((F,P)=>{var M;return{...F,pillConfigurationId:((M=b[P])==null?void 0:M.id)||ee()}}),totalDoseAmount:u(),totalDoseUnit:c.unit,instructions:`Configured dose for ${c.name}`,isDefault:!0},j=b.map(F=>({pillConfigurationId:F.id,currentCount:c.pillsRemaining||30,lastUpdated:new Date}));o(s,{useMultiplePills:!0,pillConfigurations:b,doseConfigurations:[h],defaultDoseConfigurationId:h.id,pillInventory:j,updatedAt:new Date}),console.log("✅ Multiple Pills enabled for",c.name,{pillConfigurations:b,doseConfigurations:[h],pillInventory:j}),a()};return e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Pe,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[c.useMultiplePills?"Edit":"Setup"," Multiple Pills for ",c.name]}),e.jsx("p",{className:"text-sm text-gray-500",children:c.useMultiplePills?"Edit your existing pill configuration":"Configure different pill strengths and combinations"})]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Current Configuration"}),e.jsxs("p",{className:"text-sm text-blue-700",children:[c.dosage," ",c.unit," • ",c.frequency.replace("-"," ")]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Available Pill Strengths"}),e.jsxs("button",{onClick:R,className:"btn-secondary text-sm flex items-center space-x-1",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Strength"})]})]}),e.jsx("div",{className:"space-y-3",children:d.map((b,h)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Pill ",h+1]}),d.length>1&&e.jsx("button",{onClick:()=>k(h),className:"text-red-500 hover:text-red-600",children:e.jsx(un,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strength"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"number",step:"0.1",value:b.strength,onChange:j=>S(h,{strength:parseFloat(j.target.value)}),className:"input-field flex-1"}),e.jsxs("select",{value:b.unit,onChange:j=>S(h,{unit:j.target.value}),className:"input-field w-20",children:[e.jsx("option",{value:"mg",children:"mg"}),e.jsx("option",{value:"mcg",children:"mcg"}),e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"iu",children:"IU"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),e.jsxs("select",{value:b.color,onChange:j=>S(h,{color:j.target.value}),className:"input-field",children:[e.jsx("option",{value:"white",children:"White"}),e.jsx("option",{value:"blue",children:"Blue"}),e.jsx("option",{value:"red",children:"Red"}),e.jsx("option",{value:"yellow",children:"Yellow"}),e.jsx("option",{value:"green",children:"Green"}),e.jsx("option",{value:"pink",children:"Pink"}),e.jsx("option",{value:"orange",children:"Orange"})]})]})]})]},h))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Dose Combination"}),x.length<d.length&&e.jsxs("button",{onClick:g,className:"btn-secondary text-sm flex items-center space-x-1",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Component"})]})]}),e.jsx("div",{className:"space-y-3",children:x.map((b,h)=>{var j,F,P,M;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[(j=d[h])==null?void 0:j.strength," ",(F=d[h])==null?void 0:F.unit," pills"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[(P=d[h])==null?void 0:P.color," • ",(M=d[h])==null?void 0:M.shape]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",step:"0.5",min:"0.5",value:b.quantity,onChange:D=>v(h,{quantity:parseFloat(D.target.value)}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timing"}),e.jsxs("select",{value:b.timing,onChange:D=>v(h,{timing:D.target.value}),className:"input-field",children:[e.jsx("option",{value:"together",children:"Take together"}),e.jsx("option",{value:"split",children:"Split throughout day"})]})]})]})]},h)})})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-green-900 mb-2",children:"Total Dose Preview"}),e.jsxs("p",{className:"text-lg font-semibold text-green-800",children:[u()," ",c.unit]}),e.jsxs("p",{className:"text-sm text-green-700",children:[x.reduce((b,h)=>b+h.quantity,0)," total pills per dose"]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{onClick:f,className:"btn-primary flex items-center space-x-2",children:[e.jsx(aa,{className:"h-4 w-4"}),e.jsx("span",{children:c.useMultiplePills?"Update Configuration":"Enable Multiple Pills"})]})]})})]})})}function Lo({isOpen:s,onClose:a,medication:t}){var S;const{updateMedication:n}=ae(),[r,i]=I.useState({sideEffect:"",severity:"mild",onset:"gradual",frequency:"occasional",duration:24,interference:"none",bodySystem:"other",description:"",doctorNotified:!1,followUpRequired:!1,actionTaken:"continued",relatedMedications:[]}),[l,o]=I.useState(1),c=4,d={neurological:["Headache","Dizziness","Drowsiness","Confusion","Memory problems","Tremor"],gastrointestinal:["Nausea","Vomiting","Diarrhea","Constipation","Stomach pain","Loss of appetite"],cardiovascular:["Palpitations","Chest pain","Shortness of breath","Swelling","Changes in blood pressure"],psychological:["Anxiety","Depression","Mood changes","Irritability","Sleep problems","Cognitive issues"],dermatological:["Skin rash","Itching","Hives","Dry skin","Hair loss","Photosensitivity"],respiratory:["Cough","Difficulty breathing","Congestion","Wheezing","Throat irritation"],other:["Fatigue","Weight changes","Sexual dysfunction","Muscle pain","Joint pain","Vision changes"]},m=()=>{const v={id:ee(),medicationId:t.id,medicationName:t.name,...r,timestamp:new Date,resolved:!1,doctorNotified:!1,followUpRequired:!1,reportedDates:[new Date]},g=[...t.sideEffectReports||[],v];n(t.id,{sideEffectReports:g,enhancedMonitoring:!0}),r.severity==="severe"||r.severity==="life-threatening"?J.error("⚠️ Severe side effect reported. Consider consulting your doctor immediately.",{duration:8e3}):J.success("📝 Side effect report saved successfully",{duration:4e3}),a(),x()},x=()=>{i({sideEffect:"",severity:"mild",onset:"gradual",frequency:"occasional",duration:24,interference:"none",bodySystem:"other",description:"",doctorNotified:!1,followUpRequired:!1,actionTaken:"continued",relatedMedications:[]}),o(1)},y=()=>o(Math.min(l+1,c)),R=()=>o(Math.max(l-1,1)),k=v=>{switch(v){case"mild":return"text-green-600 bg-green-50 border-green-200";case"moderate":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"severe":return"text-orange-600 bg-orange-50 border-orange-200";case"life-threatening":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return s?e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(X,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Report Side Effect"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.name," • Step ",l," of ",c]})]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full transition-all duration-300",style:{width:`${l/c*100}%`}})})]}),e.jsxs("div",{className:"px-6 py-4",children:[l===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Body System Affected"}),e.jsxs("select",{value:r.bodySystem,onChange:v=>i(g=>({...g,bodySystem:v.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"neurological",children:"Neurological (Brain & Nervous System)"}),e.jsx("option",{value:"gastrointestinal",children:"Gastrointestinal (Digestive System)"}),e.jsx("option",{value:"cardiovascular",children:"Cardiovascular (Heart & Circulation)"}),e.jsx("option",{value:"psychological",children:"Psychological (Mental Health)"}),e.jsx("option",{value:"dermatological",children:"Dermatological (Skin)"}),e.jsx("option",{value:"respiratory",children:"Respiratory (Breathing)"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Side Effect (Select or type custom)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:r.sideEffect,onChange:v=>i(g=>({...g,sideEffect:v.target.value})),placeholder:"Type a custom side effect or select from below",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto",children:(S=d[r.bodySystem])==null?void 0:S.map(v=>e.jsx("button",{type:"button",onClick:()=>i(g=>({...g,sideEffect:v})),className:`text-left p-2 rounded border text-sm hover:bg-gray-50 ${r.sideEffect===v?"border-orange-500 bg-orange-50":"border-gray-200"}`,children:v},v))})]})]})]}),l===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Severity Level"}),e.jsx("div",{className:"space-y-2",children:[{value:"mild",label:"Mild",desc:"Noticeable but not bothersome"},{value:"moderate",label:"Moderate",desc:"Interferes with daily activities"},{value:"severe",label:"Severe",desc:"Significantly impacts quality of life"},{value:"life-threatening",label:"Life-threatening",desc:"Requires immediate medical attention"}].map(({value:v,label:g,desc:u})=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"severity",value:v,checked:r.severity===v,onChange:f=>i(b=>({...b,severity:f.target.value})),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${k(v)}`,children:g}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:u})]})]},v))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"When did it start?"}),e.jsxs("select",{value:r.onset,onChange:v=>i(g=>({...g,onset:v.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"immediate",children:"Immediately (within minutes)"}),e.jsx("option",{value:"within-hours",children:"Within hours"}),e.jsx("option",{value:"within-days",children:"Within days"}),e.jsx("option",{value:"gradual",children:"Gradual onset"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"How often?"}),e.jsxs("select",{value:r.frequency,onChange:v=>i(g=>({...g,frequency:v.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"once",children:"Happened once"}),e.jsx("option",{value:"occasional",children:"Occasional"}),e.jsx("option",{value:"frequent",children:"Frequent"}),e.jsx("option",{value:"constant",children:"Constant"})]})]})]})]}),l===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (hours)"}),e.jsx("input",{type:"number",min:"0.5",step:"0.5",value:r.duration,onChange:v=>i(g=>({...g,duration:parseFloat(v.target.value)})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Daily life interference"}),e.jsxs("select",{value:r.interference,onChange:v=>i(g=>({...g,interference:v.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"none",children:"No interference"}),e.jsx("option",{value:"mild",children:"Mild interference"}),e.jsx("option",{value:"moderate",children:"Moderate interference"}),e.jsx("option",{value:"severe",children:"Severe interference"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detailed Description"}),e.jsx("textarea",{value:r.description,onChange:v=>i(g=>({...g,description:v.target.value})),rows:4,placeholder:"Describe the side effect in detail, including any triggers, patterns, or additional context...",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})]}),l===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Action taken"}),e.jsxs("select",{value:r.actionTaken,onChange:v=>i(g=>({...g,actionTaken:v.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"continued",children:"Continued medication as prescribed"}),e.jsx("option",{value:"reduced-dose",children:"Reduced dose"}),e.jsx("option",{value:"stopped",children:"Stopped medication"}),e.jsx("option",{value:"consulted-doctor",children:"Consulted doctor"}),e.jsx("option",{value:"added-medication",children:"Added medication to manage side effect"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:r.doctorNotified,onChange:v=>i(g=>({...g,doctorNotified:v.target.checked})),className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Doctor has been notified"})]}),e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:r.followUpRequired,onChange:v=>i(g=>({...g,followUpRequired:v.target.checked})),className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Follow-up appointment needed"})]})]}),r.severity==="severe"||r.severity==="life-threatening"?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Medical Attention Recommended"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"The severity you've reported suggests this side effect may require immediate medical attention. Please contact your healthcare provider or seek emergency care if needed."})]})]})}):null]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:R,disabled:l===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),l===c?e.jsxs("button",{onClick:m,disabled:!r.sideEffect.trim(),className:"px-6 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-md hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:"Submit Report"})]}):e.jsx("button",{onClick:y,disabled:l===1&&!r.sideEffect.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-md hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})})]})}):null}function $o({isOpen:s,onClose:a,medication:t,event:n}){var P,M;const{updateMedication:r}=ae(),[i,l]=I.useState({startDate:new Date,severity:"mild",symptoms:[],interventions:[],medicalSupervision:!1,successfullyCompleted:!1,relapsePrevention:[]}),[o,c]=I.useState({symptom:"",severity:5,duration:1,peak:new Date,managementStrategies:[],resolved:!1}),[d,m]=I.useState(""),[x,y]=I.useState(""),R={benzodiazepine:["Anxiety","Panic attacks","Insomnia","Seizures","Tremor","Sweating","Nausea","Vomiting","Hallucinations","Confusion","Muscle pain","Light/sound sensitivity","Memory problems","Concentration difficulty"],opioid:["Muscle aches","Runny nose","Excessive tearing","Abdominal cramping","Diarrhea","Nausea","Vomiting","Dilated pupils","Goosebumps","Insomnia","Restlessness","Anxiety","Depression","Cravings"],antidepressant:["Brain zaps","Dizziness","Nausea","Headache","Fatigue","Irritability","Anxiety","Confusion","Vivid dreams","Flu-like symptoms","Emotional lability","Sleep disturbances"],stimulant:["Fatigue","Depression","Increased appetite","Sleep problems","Anxiety","Concentration problems","Cravings","Mood swings","Slow thinking","Lack of motivation"],"sleep-aid":["Rebound insomnia","Anxiety","Panic attacks","Sweating","Tremor","Nausea","Confusion","Memory problems","Seizures (rare)","Muscle tension","Nightmares"]},k=["Deep breathing exercises","Meditation","Progressive muscle relaxation","Light exercise","Hydration","Hot/cold therapy","Distraction techniques","Support group contact","Medical intervention","Rest","Nutritional support","Counseling session","Family support","Medication adjustment"];I.useEffect(()=>{n&&l(n)},[n]);const S=()=>{if(!o.symptom.trim())return;const D={...o,symptom:o.symptom.trim()};l(T=>({...T,symptoms:[...T.symptoms||[],D]})),c({symptom:"",severity:5,duration:1,peak:new Date,managementStrategies:[],resolved:!1})},v=D=>{l(T=>{var N;return{...T,symptoms:((N=T.symptoms)==null?void 0:N.filter((C,p)=>p!==D))||[]}})},g=(D,T)=>{l(N=>{var C;return{...N,symptoms:((C=N.symptoms)==null?void 0:C.map((p,E)=>E===D?{...p,...T}:p))||[]}})},u=()=>{d.trim()&&(l(D=>({...D,interventions:[...D.interventions||[],d.trim()]})),m(""))},f=()=>{x.trim()&&(l(D=>({...D,relapsePrevention:[...D.relapsePrevention||[],x.trim()]})),y(""))},b=()=>{const D={id:(n==null?void 0:n.id)||ee(),...i,startDate:i.startDate,severity:i.severity,symptoms:i.symptoms,interventions:i.interventions,medicalSupervision:i.medicalSupervision,successfullyCompleted:i.successfullyCompleted},T=t.dependencePrevention;if(T){const N=T.withdrawalHistory.findIndex(p=>p.id===D.id),C=N>=0?T.withdrawalHistory.map((p,E)=>E===N?D:p):[...T.withdrawalHistory,D];r(t.id,{dependencePrevention:{...T,withdrawalHistory:C}})}J.success(n?"Withdrawal event updated":"Withdrawal tracking started"),a()},h=D=>D<=3?"text-green-600":D<=6?"text-yellow-600":D<=8?"text-orange-600":"text-red-600";if(!s)return null;const j=t.dependencyRiskCategory,F=R[j]||R.benzodiazepine;return e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(we,{className:"h-6 w-6 text-purple-600"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[n?"Update":"Track"," Withdrawal Symptoms"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.name," • Monitor and manage withdrawal process"]})]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:(P=i.startDate)==null?void 0:P.toISOString().split("T")[0],onChange:D=>l(T=>({...T,startDate:new Date(D.target.value)})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date (if completed)"}),e.jsx("input",{type:"date",value:((M=i.endDate)==null?void 0:M.toISOString().split("T")[0])||"",onChange:D=>l(T=>({...T,endDate:D.target.value?new Date(D.target.value):void 0})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overall Severity"}),e.jsxs("select",{value:i.severity,onChange:D=>l(T=>({...T,severity:D.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[e.jsx("option",{value:"mild",children:"Mild"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"severe",children:"Severe"}),e.jsx("option",{value:"dangerous",children:"Dangerous"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i.medicalSupervision,onChange:D=>l(T=>({...T,medicalSupervision:D.target.checked})),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Under medical supervision"})]}),e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i.successfullyCompleted,onChange:D=>l(T=>({...T,successfullyCompleted:D.target.checked})),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Successfully completed"})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Add Withdrawal Symptom"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Symptom"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:o.symptom,onChange:D=>c(T=>({...T,symptom:D.target.value})),placeholder:"Enter custom symptom or select below",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto",children:F.map(D=>e.jsx("button",{type:"button",onClick:()=>c(T=>({...T,symptom:D})),className:`text-left p-2 rounded border text-sm hover:bg-gray-50 ${o.symptom===D?"border-purple-500 bg-purple-50":"border-gray-200"}`,children:D},D))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Severity (1-10): ",o.severity]}),e.jsx("input",{type:"range",min:"1",max:"10",value:o.severity,onChange:D=>c(T=>({...T,severity:parseInt(D.target.value)})),className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Mild"}),e.jsx("span",{children:"Severe"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (hours)"}),e.jsx("input",{type:"number",min:"0.5",step:"0.5",value:o.duration,onChange:D=>c(T=>({...T,duration:parseFloat(D.target.value)})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Management Strategies (select all that apply)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto",children:k.map(D=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:o.managementStrategies.includes(D),onChange:T=>{const N=T.target.checked?[...o.managementStrategies,D]:o.managementStrategies.filter(C=>C!==D);c(C=>({...C,managementStrategies:N}))},className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{children:D})]},D))})]}),e.jsx("button",{onClick:S,disabled:!o.symptom.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Symptom"})]}),i.symptoms&&i.symptoms.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Current Symptoms"}),e.jsx("div",{className:"space-y-3",children:i.symptoms.map((D,T)=>e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:D.symptom}),e.jsxs("span",{className:`text-sm font-medium ${h(D.severity)}`,children:["Severity: ",D.severity,"/10"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Duration: ",D.duration,"h"]})]}),D.managementStrategies.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Strategies: "}),e.jsx("span",{className:"text-sm text-gray-800",children:D.managementStrategies.join(", ")})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:D.resolved,onChange:N=>g(T,{resolved:N.target.checked}),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Resolved"})]})]}),e.jsx("button",{onClick:()=>v(T),className:"text-red-600 hover:text-red-800",children:e.jsx(ce,{className:"h-4 w-4"})})]})},T))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Interventions & Support"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:d,onChange:D=>m(D.target.value),placeholder:"Add intervention (e.g., doctor visit, support group)",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),e.jsx("button",{onClick:u,disabled:!d.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:opacity-50",children:"Add"})]}),i.interventions&&i.interventions.length>0&&e.jsx("div",{className:"space-y-2",children:i.interventions.map((D,T)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:[e.jsx("span",{className:"text-sm text-gray-800",children:D}),e.jsx("button",{onClick:()=>l(N=>{var C;return{...N,interventions:((C=N.interventions)==null?void 0:C.filter((p,E)=>E!==T))||[]}}),className:"text-red-600 hover:text-red-800",children:e.jsx(ce,{className:"h-4 w-4"})})]},T))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Relapse Prevention Strategies"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:x,onChange:D=>y(D.target.value),placeholder:"Add prevention strategy (e.g., stress management, therapy)",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),e.jsx("button",{onClick:f,disabled:!x.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:opacity-50",children:"Add"})]}),i.relapsePrevention&&i.relapsePrevention.length>0&&e.jsx("div",{className:"space-y-2",children:i.relapsePrevention.map((D,T)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:[e.jsx("span",{className:"text-sm text-gray-800",children:D}),e.jsx("button",{onClick:()=>l(N=>{var C;return{...N,relapsePrevention:((C=N.relapsePrevention)==null?void 0:C.filter((p,E)=>E!==T))||[]}}),className:"text-red-600 hover:text-red-800",children:e.jsx(ce,{className:"h-4 w-4"})})]},T))})]})]}),i.severity==="dangerous"&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Dangerous Withdrawal Warning"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Dangerous withdrawal symptoms require immediate medical attention. If experiencing seizures, severe confusion, or other life-threatening symptoms, seek emergency medical care immediately."})]})]})})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{onClick:b,className:"px-6 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 flex items-center space-x-2",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsxs("span",{children:[n?"Update":"Start"," Tracking"]})]})]})})]})})}function qo({isOpen:s,onClose:a,medication:t}){const{updateMedication:n,addSmartMessage:r,logs:i}=ae(),[l,o]=I.useState("overview");I.useMemo(()=>t.dependencePrevention?t.dependencePrevention:ls.initializePrevention(t),[t]);const c=I.useMemo(()=>i.filter(f=>f.medicationId===t.id).slice(-30).map(f=>{var b,h,j,F;return{date:f.timestamp,doseTaken:f.dosage||parseFloat(t.dosage),selfAdjustment:f.dosage!==parseFloat(t.dosage),cravingLevel:(b=f.adherenceDetails)==null?void 0:b.cravingLevel,anxietyBeforeDose:(h=f.adherenceDetails)==null?void 0:h.anxietyBeforeDose,effectivenessRating:(j=f.adherenceDetails)==null?void 0:j.effectivenessRating,sideEffects:((F=f.adherenceDetails)==null?void 0:F.sideEffects)||[]}}),[i,t.id,t.dosage]),d=I.useMemo(()=>ls.assessCurrentRisk(t,c),[t,c]),m=I.useMemo(()=>ls.generateTaperingRecommendation(t),[t]),x=d.alerts.filter(u=>!u.acknowledged),y=d.alerts.filter(u=>u.acknowledged),R=u=>{const f=d.alerts.map(b=>b.id===u?{...b,acknowledged:!0}:b);n(t.id,{dependencePrevention:{...d,alerts:f}}),J.success("Alert acknowledged")},k=()=>{n(t.id,{dependencePrevention:{...d,lastUpdated:new Date}}),r({medicationId:t.id,type:"risk-alert",priority:d.riskLevel==="very-high"?"urgent":"high",title:"Dependency Prevention Assessment Updated",message:`Risk level: ${d.riskLevel}. ${d.taperingRecommended?"Tapering is recommended.":"Continue monitoring usage patterns."}`,psychologicalApproach:"informative-support",scheduledTime:new Date}),J.success("Dependency prevention data updated")},S=u=>{switch(u){case"very-high":return"text-red-700 bg-red-100 border-red-300";case"high":return"text-red-600 bg-red-50 border-red-200";case"moderate":return"text-orange-600 bg-orange-50 border-orange-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},v=u=>{switch(u){case"critical":return"text-red-700 bg-red-100 border-red-300";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";default:return"text-blue-600 bg-blue-50 border-blue-200"}},g=()=>{const u=new Date,f=new Date(t.startDate);return Math.floor((u.getTime()-f.getTime())/(1e3*60*60*24))};return s?e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Dependency Prevention Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.name," • ",t.dependencyRiskCategory.replace("-"," ")," category"]})]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"mt-4 border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:we},{id:"alerts",label:"Alerts",icon:X,badge:x.length},{id:"timeline",label:"Timeline",icon:ke},{id:"recommendations",label:"Recommendations",icon:Oe}].map(({id:u,label:f,icon:b,badge:h})=>e.jsxs("button",{onClick:()=>o(u),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${l===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:f}),h&&h>0&&e.jsx("span",{className:"bg-red-100 text-red-800 text-xs rounded-full px-2 py-0.5",children:h})]},u))})})]}),e.jsxs("div",{className:"px-6 py-4",children:[l==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Current Risk Level"})]}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${S(d.riskLevel)}`,children:d.riskLevel.replace("-"," ").toUpperCase()})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx($e,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Duration"})]}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[g()," days"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Recommended max: ",d.recommendedMaxDuration," days"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Se,{className:"h-5 w-5 text-orange-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Tapering Status"})]}),e.jsx("div",{className:`text-sm font-medium ${d.taperingRecommended?"text-orange-600":"text-green-600"}`,children:d.taperingRecommended?`${d.taperingUrgency.replace("-"," ")} recommended`:"Not needed"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Risk Assessment Factors"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Medication Category:"}),e.jsx("p",{className:"text-sm text-gray-900",children:t.dependencyRiskCategory.replace("-"," ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Dependence Type:"}),e.jsx("p",{className:"text-sm text-gray-900",children:d.dependenceType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Usage Patterns Analyzed:"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[c.length," entries"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Doctor Review Required:"}),e.jsx("p",{className:`text-sm font-medium ${d.doctorReviewRequired?"text-orange-600":"text-green-600"}`,children:d.doctorReviewRequired?"Yes":"No"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"Educational Resources"}),e.jsx("div",{className:"space-y-2",children:d.educationalResources.map((u,f)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Oe,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-blue-800",children:u})]},f))})]})]}),l==="alerts"&&e.jsxs("div",{className:"space-y-6",children:[x.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(X,{className:"h-5 w-5 text-red-500"}),e.jsxs("span",{children:["Active Alerts (",x.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:x.map(u=>e.jsx("div",{className:`border rounded-lg p-4 ${v(u.priority)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-medium",children:u.type.replace("-"," ").toUpperCase()}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${v(u.priority)}`,children:u.priority})]}),e.jsx("p",{className:"text-sm mb-2",children:u.message}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("span",{children:["Triggered: ",te(u.timestamp)," at ",Os(u.timestamp)]}),e.jsxs("span",{className:"ml-4",children:["Source: ",u.trigger]})]})]}),e.jsx("button",{onClick:()=>R(u.id),className:"ml-4 px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",children:"Acknowledge"})]})},u.id))})]}),y.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(_e,{className:"h-5 w-5 text-green-500"}),e.jsxs("span",{children:["Acknowledged Alerts (",y.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:y.slice(0,5).map(u=>e.jsx("div",{className:"border border-gray-200 bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(_e,{className:"h-4 w-4 text-green-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:u.type.replace("-"," ")}),e.jsx("span",{className:"text-xs text-gray-500",children:u.priority})]}),e.jsx("p",{className:"text-sm text-gray-600",children:u.message}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:te(u.timestamp)})]})]})},u.id))})]}),d.alerts.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_e,{className:"mx-auto h-12 w-12 text-green-500"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No Alerts"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"All dependency prevention indicators are within normal ranges."})]})]}),l==="timeline"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Medication Timeline"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Started Medication"}),e.jsx("div",{className:"text-xs text-gray-500",children:te(t.startDate)})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Reached Review Period"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[g()," days (Review every ",d.reviewFrequency," days)"]})]})]}),g()>d.recommendedMaxDuration&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Exceeded Recommended Duration"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[g()-d.recommendedMaxDuration," days over recommended"]})]})]}),d.alerts.map(u=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${u.priority==="critical"?"bg-red-500":u.priority==="high"?"bg-orange-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Alert: ",u.type.replace("-"," ")]}),e.jsx("div",{className:"text-xs text-gray-500",children:te(u.timestamp)})]})]},u.id))]})]})}),l==="recommendations"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center space-x-2",children:[e.jsx(Se,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Tapering Assessment"})]}),m.recommended?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-orange-800 font-medium",children:"Tapering is recommended for this medication."}),m.schedule&&e.jsxs("div",{className:"mt-2 text-sm text-orange-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Duration:"})," ",m.schedule.totalDuration," weeks"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reduction Rate:"})," ",m.schedule.reductionRate,"% per step"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:"Warnings & Precautions:"}),m.warnings.map((u,f)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-orange-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:u})]},f))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:"Monitoring Requirements:"}),m.monitoring.map((u,f)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:u})]},f))]})]}):e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-green-800",children:"Tapering is not currently recommended for this medication."}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Continue regular monitoring and follow-up with your healthcare provider."})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"General Recommendations"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ke,{className:"h-4 w-4 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Regular Monitoring"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Review dependency risk every ",d.reviewFrequency," days with usage pattern analysis."]})]})]}),d.doctorReviewRequired&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"h-4 w-4 text-orange-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Doctor Review Required"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Schedule an appointment with your healthcare provider to discuss your medication plan."})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Oe,{className:"h-4 w-4 text-purple-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Educational Resources"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Review the educational materials in the Overview tab to better understand your medication."})]})]})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",te(d.lastUpdated)]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"}),e.jsx("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Update Assessment"})]})]})})]})}):null}function Uo(){const{medications:s,deleteMedication:a,toggleMedicationActive:t,getMedicationAdherence:n,getCurrentDose:r,pauseTaperingSchedule:i,resumeTaperingSchedule:l,adjustTaperingSchedule:o,updateRiskAssessment:c}=ae(),[d,m]=I.useState(!1),[x,y]=I.useState(null),[R,k]=I.useState(""),[S,v]=I.useState("all"),[g,u]=I.useState(null),[f,b]=I.useState(!1),[h,j]=I.useState(null),[F,P]=I.useState(!1),[M,D]=I.useState(null),[T,N]=I.useState(!1),[C,p]=I.useState(null),[E,U]=I.useState(!1),[W,H]=I.useState(null),[K,Z]=I.useState(!1),[Q,le]=I.useState(null),[ne,G]=I.useState(!1),[ve,oe]=I.useState(null),fe=I.useMemo(()=>{let L=s;return R&&(L=dl(L,R)),S!=="all"&&(L=L.filter(se=>se.category===S)),L.sort((se,pe)=>se.name.localeCompare(pe.name))},[s,R,S]),qe=fe.filter(L=>L.isActive),Ee=fe.filter(L=>!L.isActive),Be=()=>{y(null),m(!0)},Nt=L=>{y(L),m(!0)},Ws=L=>{a(L),u(null)},wt=L=>{t(L)},ws=L=>{j(L),b(!0)},Bs=L=>{D(L),P(!0)},ks=L=>{M&&(i(M.id,L),P(!1),D(null),J.success(`Tapering paused for ${M.name}. Take time to stabilize.`))},Hs=L=>{p(L),N(!0)},ma=()=>{N(!1),p(null)},Ys=L=>{H(L),U(!0)},w=()=>{U(!1),H(null)},A=L=>{le(L),Z(!0)},$=()=>{Z(!1),le(null)},_=L=>{oe(L),G(!0)},O=()=>{G(!1),oe(null)},z=L=>{l(L),J.success("Tapering schedule resumed")},B=({medication:L})=>{const se=n(L.id,7),[pe,he]=I.useState(!1),je=r(L.id),kt=ye=>{switch(ye){case"high":return e.jsx(lt,{className:"h-4 w-4 text-red-500"});case"moderate":return e.jsx(xs,{className:"h-4 w-4 text-yellow-500"});case"low":return e.jsx(Ce,{className:"h-4 w-4 text-blue-500"});default:return e.jsx(Ce,{className:"h-4 w-4 text-green-500"})}},Ds=ye=>{switch(ye){case"high":return"text-red-600 bg-red-50 border-red-200";case"moderate":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-green-600 bg-green-50 border-green-200"}};return e.jsx("div",{className:"card hover:shadow-md transition-shadow",children:e.jsx("div",{className:"card-content p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mt-1 flex-shrink-0",style:{backgroundColor:L.color}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-y-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 truncate",children:L.name}),!L.isActive&&e.jsx("span",{className:"badge bg-gray-100 text-gray-600",children:"Inactive"}),e.jsx("span",{className:Ze("badge",L.category==="prescription"?"badge-primary":L.category==="over-the-counter"?"badge-success":L.category==="supplement"?"badge-warning":"badge-secondary"),children:L.category.replace("-"," ")}),e.jsxs("div",{className:Ze("flex items-center space-x-1 px-2 py-1 rounded-md border text-xs font-medium",Ds(L.riskLevel)),children:[kt(L.riskLevel),e.jsxs("span",{children:[L.riskLevel," risk"]})]})]}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Dosage:"})," ",L.useMultiplePills?ol(L):gn(L.dosage,L.unit)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Frequency:"})," ",cl(L.frequency)]}),je.phase!=="maintenance"&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(we,{className:"h-3 w-3 text-blue-500"}),e.jsxs("span",{className:"text-blue-600 font-medium",children:["Current: ",je.dose," ",L.unit," (",je.phase,")"]}),je.message&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["• ",je.message]})]}),L.tapering&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(Ls,{className:"h-3 w-3 text-orange-500"}),e.jsx("span",{className:"text-orange-600 font-medium",children:"Tapering schedule active"})]}),L.notes&&e.jsxs("p",{className:"text-sm text-gray-500 line-clamp-2",children:[e.jsx("strong",{children:"Notes:"})," ",L.notes]})]}),L.isActive&&e.jsxs("div",{className:"mt-3 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ys,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[se,"% adherence (7 days)"]})]}),(()=>{let ye=0;return L.pillInventory&&L.pillInventory.length>0?ye=L.pillInventory.reduce((ss,ts)=>ss+ts.currentCount,0):L.pillsRemaining!==void 0&&(ye=L.pillsRemaining),ye>0?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ke,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[ye," pills left"]})]}):null})()]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>he(!pe),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(Qr,{className:"h-4 w-4"})}),pe&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{Nt(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(ta,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx("button",{onClick:()=>{wt(L.id),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:L.isActive?e.jsxs(e.Fragment,{children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Activate"]})}),(L.riskLevel==="high"||L.riskLevel==="moderate")&&e.jsxs("button",{onClick:()=>{c(L.id),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-orange-600 hover:bg-orange-50",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Assess Risk"]}),L.dependencyRiskCategory!=="low-risk"&&e.jsxs("button",{onClick:()=>{_(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-blue-600 hover:bg-blue-50",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Dependency Dashboard"]}),(()=>{var Gs,Cs;const ye=_s(L.name),ss=(Gs=L.tapering)==null?void 0:Gs.isActive,ts=(Cs=L.tapering)==null?void 0:Cs.isPaused;return!(ye!=null&&ye.taperingRequired)&&!ss?L.riskLevel==="high"||L.riskLevel==="moderate"?e.jsxs("button",{onClick:()=>{ws(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-blue-600 hover:bg-blue-50",children:[e.jsx(Et,{className:"h-4 w-4 mr-2"}),"Setup Break Option"]}):null:ss&&ts?e.jsxs("button",{onClick:()=>{z(L.id),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-green-600 hover:bg-green-50",children:[e.jsx(el,{className:"h-4 w-4 mr-2"}),"Resume Tapering"]}):ss&&!ts?e.jsxs("button",{onClick:()=>{Bs(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-orange-600 hover:bg-orange-50",children:[e.jsx(Et,{className:"h-4 w-4 mr-2"}),"Take a Break"]}):e.jsxs("button",{onClick:()=>{ws(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-purple-600 hover:bg-purple-50",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Create Tapering Plan"]})})(),!L.useMultiplePills&&e.jsxs("button",{onClick:()=>{Hs(L.id),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-indigo-600 hover:bg-indigo-50",children:[e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx(Pe,{className:"h-3 w-3"}),e.jsx(Pe,{className:"h-3 w-3 -ml-1"})]}),"Multiple Pills Setup"]}),L.useMultiplePills&&e.jsxs("button",{onClick:()=>{Hs(L.id),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-green-600 hover:bg-green-50",children:[e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx(Pe,{className:"h-3 w-3"}),e.jsx(Pe,{className:"h-3 w-3 -ml-1"})]}),"Edit Multiple Pills Setup",e.jsx("span",{className:"ml-auto text-xs text-green-500",children:"✓"})]}),e.jsxs("button",{onClick:()=>{Ys(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-orange-600 hover:bg-orange-50",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Report Side Effect"]}),L.dependencyRiskCategory!=="low-risk"&&e.jsxs("button",{onClick:()=>{A(L),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-purple-600 hover:bg-purple-50",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Track Withdrawal"]}),e.jsxs("button",{onClick:()=>{u(L.id),he(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Delete"]})]})})]})]})})})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Medications"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your medications and prescriptions"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs("button",{onClick:Be,className:"btn-primary inline-flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Medication"})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search medications...",value:R,onChange:L=>k(L.target.value),className:"input pl-10"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Br,{className:"h-4 w-4 text-gray-400"}),e.jsxs("select",{value:S,onChange:L=>v(L.target.value),className:"input w-auto",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"prescription",children:"Prescription"}),e.jsx("option",{value:"over-the-counter",children:"Over-the-counter"}),e.jsx("option",{value:"supplement",children:"Supplement"}),e.jsx("option",{value:"vitamin",children:"Vitamin"}),e.jsx("option",{value:"herbal",children:"Herbal"}),e.jsx("option",{value:"injection",children:"Injection"}),e.jsx("option",{value:"topical",children:"Topical"}),e.jsx("option",{value:"emergency",children:"Emergency"})]})]})]}),fe.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-24 w-24 text-gray-400",children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 7.172V5L8 4z"})})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:R||S!=="all"?"No medications found":"No medications yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:R||S!=="all"?"Try adjusting your search or filter criteria.":"Get started by adding your first medication."}),!R&&S==="all"&&e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:Be,className:"btn-primary",children:"Add Your First Medication"})})]}):e.jsxs("div",{className:"space-y-6",children:[qe.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:["Active Medications (",qe.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:qe.map(L=>e.jsx(B,{medication:L},L.id))})]}),Ee.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:["Inactive Medications (",Ee.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ee.map(L=>e.jsx(B,{medication:L},L.id))})]})]}),e.jsx(To,{isOpen:d,onClose:()=>m(!1),medication:x}),e.jsx(da,{isOpen:!!g,onClose:()=>u(null),onConfirm:()=>g&&Ws(g),title:"Delete Medication",message:"Are you sure you want to delete this medication? This action cannot be undone and will remove all associated logs and reminders.",confirmText:"Delete",cancelText:"Cancel",variant:"danger"}),h&&e.jsx(Io,{isOpen:f,onClose:()=>{b(!1),j(null)},medication:h}),F&&M&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>P(!1)}),e.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[e.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(Et,{className:"h-6 w-6 text-orange-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Take a Break from Tapering"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Pausing your tapering schedule for ",M.name," is completely normal and safe. How are you feeling with withdrawal symptoms?"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>ks("mild"),className:"w-full p-3 text-left border border-gray-200 rounded-lg hover:bg-green-50 hover:border-green-300",children:[e.jsx("div",{className:"font-medium text-green-800",children:"Mild symptoms"}),e.jsx("div",{className:"text-sm text-green-600",children:"Suggested break: 3-6 days"})]}),e.jsxs("button",{onClick:()=>ks("moderate"),className:"w-full p-3 text-left border border-gray-200 rounded-lg hover:bg-orange-50 hover:border-orange-300",children:[e.jsx("div",{className:"font-medium text-orange-800",children:"Moderate symptoms"}),e.jsx("div",{className:"text-sm text-orange-600",children:"Suggested break: 1-2 weeks"})]}),e.jsxs("button",{onClick:()=>ks("severe"),className:"w-full p-3 text-left border border-gray-200 rounded-lg hover:bg-red-50 hover:border-red-300",children:[e.jsx("div",{className:"font-medium text-red-800",children:"Severe symptoms"}),e.jsx("div",{className:"text-sm text-red-600",children:"Suggested break: 2-4 weeks"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Remember:"})," Taking breaks during tapering is encouraged and safe. Your schedule will automatically extend to account for the pause time."]})})]}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:e.jsx("button",{type:"button",onClick:()=>P(!1),className:"w-full justify-center rounded-md bg-gray-200 px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm hover:bg-gray-300 sm:ml-3 sm:w-auto",children:"Cancel"})})]})]})}),T&&C&&e.jsx(Fo,{medicationId:C,onClose:ma}),E&&W&&e.jsx(Lo,{isOpen:E,onClose:w,medication:W}),K&&Q&&e.jsx($o,{isOpen:K,onClose:$,medication:Q}),ne&&ve&&e.jsx(qo,{isOpen:ne,onClose:O,medication:ve})]})}class Lt{static analyzePersonalUsage(a,t,n=30){const r=new Date(Date.now()-n*24*60*60*1e3),i=t.filter(b=>b.medicationId===a.id&&new Date(b.timestamp)>=r&&b.adherence==="taken");if(i.length<3){const b=this.getScheduledFrequency(a);return{medicationId:a.id,averageDailyUse:b,usageConsistency:"unpredictable",recentTrend:"stable",adherenceRate:i.length>0?75:0,lastAnalyzed:new Date,typicalMonthlyUse:b*30}}const l=this.calculateDailyUsages(i,n),o=l.reduce((b,h)=>b+h,0)/l.length,c=l.reduce((b,h)=>b+Math.pow(h-o,2),0)/l.length,m=Math.sqrt(c)/o;let x;m<.1?x="very-consistent":m<.25?x="mostly-consistent":m<.5?x="variable":x="unpredictable";const y=l.slice(0,Math.floor(l.length/2)),R=l.slice(Math.floor(l.length/2)),k=y.reduce((b,h)=>b+h,0)/y.length,S=R.reduce((b,h)=>b+h,0)/R.length;let v="stable";const g=o*.15;S>k+g?v="increasing":S<k-g&&(v="decreasing");const u=this.calculateExpectedDoses(a,n),f=u>0?Math.min(100,i.length/u*100):100;return{medicationId:a.id,averageDailyUse:o,usageConsistency:x,recentTrend:v,adherenceRate:f,lastAnalyzed:new Date,typicalMonthlyUse:o*30}}static predictRefillNeeds(a,t,n,r){let o=n.averageDailyUse*(n.adherenceRate/100);n.recentTrend==="increasing"?o*=1.1:n.recentTrend==="decreasing"&&(o*=.9);const c=t/o,d=new Date(Date.now()+c*24*60*60*1e3),m=r.reminderDaysAdvance+r.typicalRefillDays,x=new Date(d.getTime()-m*24*60*60*1e3);let y;n.usageConsistency==="very-consistent"?y="high":n.usageConsistency==="mostly-consistent"?y="medium":y="low";let R=`Based on your ${n.usageConsistency.replace("-"," ")} usage`;n.recentTrend!=="stable"&&(R+=` and ${n.recentTrend} trend`);const k=o*.8,S=o*1.2,v=new Date(Date.now()+t/k*24*60*60*1e3),g=new Date(Date.now()+t/S*24*60*60*1e3),u=new Date(v.getTime()-m*24*60*60*1e3),f=new Date(g.getTime()-m*24*60*60*1e3);return{medicationId:a.id,currentPillCount:t,averageDailyUse:o,estimatedEmptyDate:d,suggestedRefillDate:x,confidence:y,reasoning:R,scenarios:{ifUsageIncreases:{emptyDate:g,refillDate:f},ifUsageDecreases:{emptyDate:v,refillDate:u}}}}static generateMedicationAlerts(a,t,n,r,i){const l=[],o=new Date,c=(n.estimatedEmptyDate.getTime()-o.getTime())/(24*60*60*1e3);if(t<=0||c>365)return l;const d=i.some(k=>k.medicationId===a.id&&["requested","processing","ready"].includes(k.status)),m=Math.max(2,r.emergencyDeliveryThreshold||2),x=Math.max(r.minimumDaysSupply,m+1),y=Math.max(x+r.reminderDaysAdvance,7);c<=m&&t<n.averageDailyUse*m&&!d?l.push({id:`almost-out-${a.id}-${Date.now()}`,medicationId:a.id,type:"almost_out",priority:"urgent",message:`You're almost out of ${a.name}! Only ${Math.ceil(c)} days left.`,daysRemaining:c,suggestion:"Contact your pharmacy immediately or visit urgent care",createdAt:o}):c<=x&&c>m&&!d?l.push({id:`running-low-${a.id}-${Date.now()}`,medicationId:a.id,type:"running_low",priority:"important",message:`Running low on ${a.name} - ${Math.ceil(c)} days remaining`,daysRemaining:c,suggestion:"Time to request a refill",createdAt:o}):c<=y&&c>x&&!d&&n.confidence!=="low"&&l.push({id:`time-to-refill-${a.id}-${Date.now()}`,medicationId:a.id,type:"time_to_refill",priority:"reminder",message:`Good time to refill ${a.name}`,daysRemaining:c,suggestion:`Request refill (you have about ${Math.ceil(c)} days left)`,createdAt:o});const R=i.filter(k=>k.medicationId===a.id&&k.expectedDate<o&&!k.actualDate&&k.status!=="ready");if(R.length>0){const k=R.sort((v,g)=>v.expectedDate.getTime()-g.expectedDate.getTime())[0],S=Math.ceil((o.getTime()-k.expectedDate.getTime())/(24*60*60*1e3));l.push({id:`overdue-${a.id}-${Date.now()}`,medicationId:a.id,type:"refill_overdue",priority:S>3?"important":"reminder",message:`Your ${a.name} refill is ${S} days overdue`,daysRemaining:c,suggestion:"Check with your pharmacy about the status",createdAt:o})}return l}static getPersonalStockRecommendation(a,t,n,r){const i=t.averageDailyUse,l=r/i;let o=Math.ceil(i*(n.minimumDaysSupply+n.typicalRefillDays));t.usageConsistency==="unpredictable"?o*=1.2:t.usageConsistency==="variable"&&(o*=1.1);let c;l<n.minimumDaysSupply?c="too_low":l<o/i?c="adequate":l<90?c="good":c="more_than_needed";const d=[];c==="too_low"?(d.push("Refill as soon as possible"),d.push("Consider asking for a larger supply next time")):c==="adequate"?d.push("You have enough for now, but plan your next refill"):c==="good"?d.push("Good supply level - you can refill when convenient"):(d.push("You have more than needed - no rush to refill"),d.push("Check expiration dates on older pills")),t.usageConsistency==="unpredictable"&&d.push("Consider keeping extra supply due to variable usage");let m=`Based on your ${t.usageConsistency.replace("-"," ")} usage pattern`;return t.recentTrend!=="stable"&&(m+=` and ${t.recentTrend} trend`),{medicationId:a.id,recommendedMinimumPills:Math.ceil(o),reasonForRecommendation:m,currentLevel:c,suggestions:d,lastCalculated:new Date}}static calculateDailyUsages(a,t){const n=new Map;return a.forEach(r=>{const i=new Date(r.timestamp).toDateString();n.set(i,(n.get(i)||0)+(r.dosageTaken||0))}),Array.from(n.values())}static calculateExpectedDoses(a,t){const n=a.timesPerDay||1;return t*n}static getScheduledFrequency(a){const t=a.timesPerDay||1;if(a.useMultiplePills&&a.doseConfigurations){const i=a.doseConfigurations.find(l=>l.isDefault)||a.doseConfigurations[0];if(i)return i.pillComponents.reduce((o,c)=>o+c.quantity,0)*t}return(parseFloat(a.dosage)||1)/1*t}}class Wa{static analyzePersonalMedicationNeeds(a,t,n){const r=[],i=[],l=[],o=[];for(const c of a.filter(d=>d.isActive)){const d=Lt.analyzePersonalUsage(c,t);r.push(d);const m=n.find(S=>S.medicationId===c.id)||this.createDefaultTracking(c),x=this.calculateCurrentPillCount(c),y=Lt.predictRefillNeeds(c,x,d,m);i.push(y);const R=Lt.generateMedicationAlerts(c,x,y,m,[]);l.push(...R);const k=this.generatePersonalRecommendations(c,d,y,m);o.push(...k)}return o.push(...this.generateGeneralRecommendations(r,i)),{usagePatterns:r,refillPredictions:i,alerts:l,recommendations:o}}static generatePersonalRefillSchedule(a,t){const n=[],r=[],i=[],l=new Date;for(const c of t){const d=a.find(x=>x.id===c.medicationId);if(!d)continue;const m=(c.suggestedRefillDate.getTime()-l.getTime())/(24*60*60*1e3);m<=0?n.push({medication:d,refillBy:c.suggestedRefillDate,reason:m<=-3?"Overdue for refill":"Should refill now"}):m<=14&&r.push({medication:d,suggestedDate:c.suggestedRefillDate,confidence:c.confidence})}const o=this.groupMedicationsByPharmacy(a,pharmacyPreferences);for(const[c,d]of o.entries())if(d.length>1){const m=d.filter(x=>{const y=t.find(R=>R.medicationId===x.id);return y&&(y.suggestedRefillDate.getTime()-l.getTime())/864e5<=30});if(m.length>1){const x=new Date(Math.max(...m.map(y=>{const R=t.find(k=>k.medicationId===y.id);return R?R.suggestedRefillDate.getTime():0})));i.push({medications:m,bestDate:x,reason:"Coordinate refills to save trips to pharmacy"})}}return{urgentRefills:n,upcomingRefills:r,coordinationOpportunities:i}}static predictOptimalRefillTiming(a,t,n,r){const i=t.filter(k=>k.medicationId===a.id&&new Date(k.timestamp).getTime()>Date.now()-2592e6),l=this.calculateAverageDailyConsumption(i),o=this.calculateConsumptionVariability(i),c=n/l,d=new Date(Date.now()+c*24*60*60*1e3),m=new Date(d.getTime()-r.preferredDaysOfAdvance*24*60*60*1e3),x=[{date:new Date(m.getTime()-7*24*60*60*1e3),pros:["Extra safety buffer","Avoid weekend delays"],cons:["Earlier expense","More inventory to manage"]},{date:new Date(m.getTime()+3*24*60*60*1e3),pros:["Delayed expense","Less inventory"],cons:["Higher stockout risk","Less flexibility"]}],y=[];o>.3&&y.push("High consumption variability detected"),a.frequency==="as-needed"&&y.push("PRN medication - unpredictable usage"),a.riskLevel==="high"&&y.push("High-risk medication - stockouts could be serious");const R=Math.max(30,Math.min(95,100-o*50-(i.length<10?20:0)));return{optimalOrderDate:m,alternatives:x,riskFactors:y,confidence:R}}static createDefaultTracking(a){return{medicationId:a.id,typicalRefillDays:2,reminderDaysAdvance:7,minimumDaysSupply:5,refillReminderEnabled:!0,preferredPharmacy:a.pharmacy,preferredDeliveryMethod:"pickup",allowBackupDeliveryMethods:!0,emergencyDeliveryThreshold:2}}static calculateCurrentPillCount(a){return a.pillInventory&&a.pillInventory.length>0?a.pillInventory.reduce((t,n)=>t+n.currentCount,0):a.pillsRemaining||30}static generatePersonalRecommendations(a,t,n,r){const i=[];t.adherenceRate<80&&i.push(`Consider setting more reminders for ${a.name} - you're taking it ${Math.round(t.adherenceRate)}% of the time`),t.usageConsistency==="unpredictable"&&i.push(`Your ${a.name} usage varies a lot - consider keeping extra supply on hand`);const l=(n.suggestedRefillDate.getTime()-Date.now())/(24*60*60*1e3);return l<=3&&l>=0&&i.push(`Good time to refill ${a.name} in the next ${Math.ceil(l)} days`),r.minimumDaysSupply<7&&i.push(`Consider keeping at least a week's supply of ${a.name} to avoid running out`),i}static generateGeneralRecommendations(a,t){const n=[];a.reduce((l,o)=>l+o.adherenceRate,0)/a.length<85&&n.push("Overall medication adherence could be improved - consider using more reminders or a pill organizer");const i=t.filter(l=>{const o=(l.suggestedRefillDate.getTime()-Date.now())/864e5;return o>=0&&o<=7});return i.length>2&&n.push(`You have ${i.length} refills due this week - consider getting them all at once`),n}static groupMedicationsByPharmacy(a,t){const n=new Map;for(const r of a){const i=r.pharmacy||"Unknown";n.has(i)||n.set(i,[]),n.get(i).push(r)}return n}static calculateAverageDailyConsumption(a){if(a.length===0)return 1;const n=a.filter(i=>i.adherence==="taken").reduce((i,l)=>i+(l.dosageTaken||0),0),r=Math.max(1,a.length/2);return n/r}static calculateConsumptionVariability(a){if(a.length<3)return 0;const t=this.getDailyConsumptions(a),n=t.reduce((i,l)=>i+l,0)/t.length,r=t.reduce((i,l)=>i+Math.pow(l-n,2),0)/t.length;return Math.sqrt(r)/n}static getDailyConsumptions(a){const t=new Map;return a.filter(n=>n.adherence==="taken").forEach(n=>{const r=new Date(n.timestamp).toDateString();t.set(r,(t.get(r)||0)+(n.dosageTaken||0))}),Array.from(t.values())}}function zo({isOpen:s,onClose:a,medications:t,onSave:n,existingPharmacies:r=[],existingTracking:i=[]}){const[l,o]=q.useState(r),[c,d]=q.useState(i),[m,x]=q.useState("pharmacies");q.useEffect(()=>{const u=t.filter(f=>f.isActive&&!c.find(b=>b.medicationId===f.id));if(u.length>0){const f=u.map(b=>y(b));d(b=>[...b,...f])}},[t,c]);const y=u=>{var f;return{medicationId:u.id,preferredPharmacy:(f=l.find(b=>b.isPreferred))==null?void 0:f.id,typicalRefillDays:2,reminderDaysAdvance:7,minimumDaysSupply:3,refillReminderEnabled:!0,preferredDeliveryMethod:"pickup",allowBackupDeliveryMethods:!0,emergencyDeliveryThreshold:2}},R=()=>{const u={id:ee(),name:"",typicalRefillTime:1,isPreferred:l.length===0,deliveryOptions:{pickup:{enabled:!0,avgTime:.5},standardDelivery:{enabled:!1,avgTime:2},expeditedDelivery:{enabled:!1,avgTime:1},sameDay:{enabled:!1,avgTime:.25,cutoffTime:"14:00"}},deliveryReliability:"good"};o([...l,u])},k=(u,f)=>{o(l.map(b=>b.id===u?{...b,...f}:b))},S=u=>{o(l.filter(f=>f.id!==u)),d(c.map(f=>({...f,preferredPharmacy:f.preferredPharmacy===u?void 0:f.preferredPharmacy,backupPharmacy:f.backupPharmacy===u?void 0:f.backupPharmacy})))},v=(u,f)=>{d(c.map(b=>b.medicationId===u?{...b,...f}:b))},g=()=>{n(l,c),a()};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Inventory Configuration"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ce,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex space-x-0",children:[e.jsx("button",{onClick:()=>x("pharmacies"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${m==="pharmacies"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kr,{className:"h-4 w-4"}),e.jsx("span",{children:"Pharmacies & Delivery"})]})}),e.jsx("button",{onClick:()=>x("medications"),className:`px-6 py-3 font-medium transition-colors border-b-2 ${m==="medications"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gs,{className:"h-4 w-4"}),e.jsx("span",{children:"Medication Settings"})]})})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[m==="pharmacies"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Your Pharmacies"}),e.jsxs("button",{onClick:R,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Pharmacy"})]})]}),l.map(u=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"text",placeholder:"Pharmacy name",value:u.name,onChange:f=>k(u.id,{name:f.target.value}),className:"font-medium text-lg border-0 bg-transparent focus:outline-none focus:ring-0 p-0"}),u.isPreferred&&e.jsx(Ht,{className:"h-5 w-5 text-yellow-500 fill-current"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>k(u.id,{isPreferred:!u.isPreferred}),className:`text-sm px-3 py-1 rounded ${u.isPreferred?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:u.isPreferred?"Preferred":"Set as Preferred"}),e.jsx("button",{onClick:()=>S(u.id),className:"text-red-600 hover:text-red-800",children:e.jsx(yt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:u.address||"",onChange:f=>k(u.id,{address:f.target.value}),className:"input",placeholder:"123 Main St, City, State"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:u.phone||"",onChange:f=>k(u.id,{phone:f.target.value}),className:"input",placeholder:"(555) 123-4567"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Options"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(u.deliveryOptions).map(([f,b])=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:b.enabled,onChange:h=>k(u.id,{deliveryOptions:{...u.deliveryOptions,[f]:{...b,enabled:h.target.checked}}}),className:"rounded text-blue-600"}),e.jsx("span",{className:"text-sm font-medium capitalize",children:f.replace(/([A-Z])/g," $1").toLowerCase()})]})}),b.enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-gray-500",children:["Avg Time (",f==="sameDay"?"hours":"days",")"]}),e.jsx("input",{type:"number",step:"0.25",min:"0",value:b.avgTime,onChange:h=>k(u.id,{deliveryOptions:{...u.deliveryOptions,[f]:{...b,avgTime:parseFloat(h.target.value)||0}}}),className:"input text-sm"})]}),"cost"in b&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500",children:"Cost ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:"cost"in b&&b.cost||"",onChange:h=>k(u.id,{deliveryOptions:{...u.deliveryOptions,[f]:{...b,cost:parseFloat(h.target.value)||0}}}),className:"input text-sm",placeholder:"0.00"})]})]})]},f))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Reliability"}),e.jsxs("select",{value:u.deliveryReliability,onChange:f=>k(u.id,{deliveryReliability:f.target.value}),className:"input",children:[e.jsx("option",{value:"excellent",children:"Excellent - Always on time"}),e.jsx("option",{value:"good",children:"Good - Usually on time"}),e.jsx("option",{value:"fair",children:"Fair - Sometimes delayed"}),e.jsx("option",{value:"poor",children:"Poor - Often delayed"})]})]})]},u.id)),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(gs,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No pharmacies configured yet."}),e.jsx("p",{className:"text-sm",children:"Add a pharmacy to start tracking deliveries."})]})]}),m==="medications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Medication Tracking Settings"}),t.filter(u=>u.isActive).map(u=>{const f=c.find(b=>b.medicationId===u.id);return f?e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:u.name}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Pharmacy"}),e.jsxs("select",{value:f.preferredPharmacy||"",onChange:b=>v(u.id,{preferredPharmacy:b.target.value||void 0}),className:"input",children:[e.jsx("option",{value:"",children:"No preference"}),l.map(b=>e.jsx("option",{value:b.id,children:b.name},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Delivery Method"}),e.jsxs("select",{value:f.preferredDeliveryMethod,onChange:b=>v(u.id,{preferredDeliveryMethod:b.target.value}),className:"input",children:[e.jsx("option",{value:"pickup",children:"Pickup"}),e.jsx("option",{value:"standardDelivery",children:"Standard Delivery"}),e.jsx("option",{value:"expeditedDelivery",children:"Expedited Delivery"}),e.jsx("option",{value:"sameDay",children:"Same Day"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reminder Days in Advance"}),e.jsx("input",{type:"number",min:"1",max:"30",value:f.reminderDaysAdvance,onChange:b=>v(u.id,{reminderDaysAdvance:parseInt(b.target.value)||7}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Days Supply"}),e.jsx("input",{type:"number",min:"1",max:"30",value:f.minimumDaysSupply,onChange:b=>v(u.id,{minimumDaysSupply:parseInt(b.target.value)||3}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Delivery Threshold"}),e.jsx("input",{type:"number",min:"0",max:"7",value:f.emergencyDeliveryThreshold,onChange:b=>v(u.id,{emergencyDeliveryThreshold:parseInt(b.target.value)||2}),className:"input"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Days remaining to trigger emergency delivery options"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:f.allowBackupDeliveryMethods,onChange:b=>v(u.id,{allowBackupDeliveryMethods:b.target.checked}),className:"rounded text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Allow backup delivery methods"})]})})]})]},u.id):null})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t bg-gray-50",children:[e.jsx("button",{onClick:a,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:g,className:"btn-primary",children:"Save Configuration"})]})]})}):null}function Oo(){const{medications:s,logs:a}=ae(),[t,n]=q.useState([]),[r,i]=q.useState(!1),[l,o]=q.useState(!1),[c,d]=q.useState([]),[m,x]=q.useState([]);q.useEffect(()=>{try{const g=localStorage.getItem("medication-pharmacies"),u=localStorage.getItem("medication-tracking");g&&d(JSON.parse(g)),u&&x(JSON.parse(u))}catch(g){console.error("Error loading inventory config:",g)}y()},[s,a]);const y=async()=>{i(!0);try{const g=s.filter(P=>{const M=P.pillInventory&&P.pillInventory.length>0||P.pillsRemaining!==void 0&&P.pillsRemaining>0;return P.isActive&&M});if(g.length===0){n([{type:"info",title:"No Trackable Medications",message:'Enable "Multiple Pills" on your medications to start tracking inventory.',action:"Go to Medications page"}]),i(!1);return}const u=Wa.analyzePersonalMedicationNeeds(g,a.filter(P=>g.some(M=>M.id===P.medicationId)),m),f=[];u.alerts.filter(P=>P.daysRemaining>=0).forEach(P=>{f.push({type:P.priority==="urgent"?"error":P.priority==="important"?"warning":"info",title:P.type.replace("_"," ").replace(/\b\w/g,M=>M.toUpperCase()),message:P.message,action:P.suggestion})}),u.recommendations.filter(P=>!P.includes("No medications")&&!P.includes("error")).slice(0,3).forEach(P=>{f.push({type:"info",title:"Personal Insight",message:P})});const h=u.refillPredictions.filter(P=>P.confidence!=="low"&&P.currentPillCount>0);if(h.length>0){const P=Wa.generatePersonalRefillSchedule(g,h);P.urgentRefills.forEach(M=>{f.push({type:"error",title:"Urgent Refill Needed",message:`${M.medication.name} - ${M.reason}`,action:"Get refill by "+te(M.refillBy)})}),P.coordinationOpportunities.forEach(M=>{f.push({type:"success",title:"Coordination Opportunity",message:`${M.reason} for ${M.medications.map(D=>D.name).join(", ")}`,action:"Plan refills for "+te(M.bestDate)})})}const j=g.length,F=g.filter(P=>{var D;return(((D=P.pillInventory)==null?void 0:D.reduce((T,N)=>T+N.currentCount,0))||P.pillsRemaining||0)<=7}).length;F>0?f.unshift({type:"warning",title:"Inventory Summary",message:`${F} of ${j} medications running low (≤7 days supply)`,action:"Review inventory below"}):f.unshift({type:"success",title:"Inventory Status",message:`All ${j} tracked medications have adequate supply`,action:"View details below"}),n(f)}catch(g){console.error("Error analyzing inventory:",g),n([{type:"error",title:"Analysis Error",message:"Unable to analyze inventory status. Please try again."}])}finally{i(!1)}},R=g=>{switch(g){case"error":return e.jsx(X,{className:"h-4 w-4 text-red-500"});case"warning":return e.jsx(X,{className:"h-4 w-4 text-orange-500"});case"success":return e.jsx(Se,{className:"h-4 w-4 text-green-500"});default:return e.jsx(gs,{className:"h-4 w-4 text-blue-500"})}},k=g=>{switch(g){case"error":return"border-red-200 bg-red-50";case"warning":return"border-orange-200 bg-orange-50";case"success":return"border-green-200 bg-green-50";default:return"border-blue-200 bg-blue-50"}},S=g=>{var u,f,b,h,j;if(console.log("🔄 Handling insight action:",g),(u=g.action)!=null&&u.includes("Go to Medications"))window.location.href="/medications";else if((f=g.action)!=null&&f.includes("Get refill"))alert(`📋 Reminder: ${g.message}

Action: ${g.action}`);else if((b=g.action)!=null&&b.includes("Plan refills"))alert(`🎯 Coordination Opportunity: ${g.message}

Action: ${g.action}`);else if((h=g.action)!=null&&h.includes("Review inventory")){const F=document.querySelector('[data-testid="medication-details"]');F&&F.scrollIntoView({behavior:"smooth"})}else(j=g.action)!=null&&j.includes("View details")?alert(`📊 Inventory Status: ${g.message}

Your medications have adequate supply. Keep up the good work!`):alert(`ℹ️ ${g.title}: ${g.message}`)};if(r)return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"h-5 w-5 bg-gray-300 rounded"}),e.jsx("div",{className:"h-4 w-32 bg-gray-300 rounded"})]}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(g=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},g))})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fs,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Personal Medication Tracker"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Smart insights for your medication supply"})]})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(Fs,{className:"h-4 w-4"}),e.jsx("span",{children:"Configure"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(gs,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Medications"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(g=>g.isActive).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(X,{className:"h-8 w-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Alerts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(g=>g.type==="error"||g.type==="warning").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(tl,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Refills Due"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(g=>g.title==="Urgent Refill").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Se,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tips"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(g=>g.type==="success").length})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Personal Insights & Recommendations"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Based on your usage patterns and current supply"})]}),e.jsx("div",{className:"p-6",children:t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(gs,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No insights yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start tracking your medications to get helpful insights about your supply."})]}):e.jsx("div",{className:"space-y-4",children:t.map((g,u)=>e.jsx("div",{className:`border rounded-lg p-4 ${k(g.type)}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[R(g.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.title}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:g.message}),g.action&&e.jsxs("button",{onClick:()=>S(g),className:"mt-2 text-sm font-medium text-blue-600 hover:text-blue-500 transition-colors",children:[g.action," →"]})]})]})},u))})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Your Refill Calendar"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"When you'll likely need refills based on your usage"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx($e,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Refill calendar coming soon"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"We're building a calendar to help you plan your refills ahead of time."})]})})]}),e.jsx(zo,{isOpen:l,onClose:()=>o(!1),medications:s,onSave:v,existingPharmacies:c,existingTracking:m})]});function v(g,u){d(g),x(u),localStorage.setItem("medication-pharmacies",JSON.stringify(g)),localStorage.setItem("medication-tracking",JSON.stringify(u)),y()}}function _o(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Medication Inventory"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track your medication supply and get intelligent refill recommendations"})]}),e.jsx(Oo,{})]})}function Vo(){const{medications:s,logs:a,reminders:t,markMedicationTaken:n,markMedicationMissed:r}=ae(),[i,l]=I.useState(new Date),[o,c]=I.useState("week"),[d,m]=I.useState("all"),y=I.useCallback(()=>{const j=[],F=s.filter(D=>D.isActive);a.forEach(D=>{const T=s.find(N=>N.id===D.medicationId);T&&j.push({id:D.id,medicationId:D.medicationId,medicationName:T.name,dosageInfo:T.useMultiplePills?qs(T):`${T.dosage} ${T.unit}`,time:Os(new Date(D.timestamp)),type:D.adherence==="taken"?"taken":"missed",status:D.adherence,date:new Date(D.timestamp)})});const P=new Date,M=o==="week"?Ks(P,7):Ks(P,30);for(let D=P;D<=M;D=Ks(D,1)){const T=Ie(D,"EEEE").toLowerCase();t.forEach(N=>{const C=F.find(p=>p.id===N.medicationId);C&&N.isActive&&N.days.includes(T)&&(a.find(E=>E.medicationId===N.medicationId&&Zs(new Date(E.timestamp),D))||j.push({id:`${N.id}-${Ie(D,"yyyy-MM-dd")}`,medicationId:N.medicationId,medicationName:C.name,dosageInfo:C.useMultiplePills?qs(C):`${C.dosage} ${C.unit}`,time:N.time,type:"reminder",status:"upcoming",date:D}))})}return j.sort((D,T)=>D.date.getTime()-T.date.getTime())},[s,a,t,o])(),R=d==="all"?y:y.filter(j=>j.medicationId===d),k=R.filter(j=>Zs(j.date,i)),S=I.useMemo(()=>{const j=ha(new Date(i.getFullYear(),i.getMonth(),1)),F=xa(new Date(i.getFullYear(),i.getMonth()+1,0));return st({start:j,end:F})},[i]),v=I.useMemo(()=>{const j=ha(i),F=xa(i);return st({start:j,end:F})},[i]),g=j=>{l(j)},u=(j,F)=>{F==="taken"?n(j):r(j)},f=j=>{l(o==="week"?F=>Ks(F,j==="next"?7:-7):F=>new Date(F.getFullYear(),F.getMonth()+(j==="next"?1:-1),1))},b=({status:j})=>{switch(j){case"taken":return e.jsx(ys,{className:"h-4 w-4 text-green-500"});case"missed":return e.jsx($s,{className:"h-4 w-4 text-red-500"});case"upcoming":return e.jsx(ke,{className:"h-4 w-4 text-blue-500"});default:return e.jsx(X,{className:"h-4 w-4 text-yellow-500"})}},h=({date:j,isCurrentMonth:F=!0})=>{const P=R.filter(T=>Zs(T.date,j)),M=Zs(j,i),D=qt(j);return e.jsxs("button",{onClick:()=>g(j),className:`
          p-2 h-20 w-full border border-gray-200 text-left hover:bg-gray-50 transition-colors
          ${M?"bg-blue-50 border-blue-200":""}
          ${D?"bg-yellow-50":""}
          ${F?"":"text-gray-400 bg-gray-50"}
        `,children:[e.jsx("div",{className:"font-medium text-sm mb-1",children:Ie(j,"d")}),e.jsxs("div",{className:"space-y-1",children:[P.slice(0,2).map(T=>e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(b,{status:T.status}),e.jsx("span",{className:"truncate",children:T.medicationName})]},T.id)),P.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",P.length-2," more"]})]})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Calendar"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"View and manage your medication schedule"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[e.jsxs("select",{value:d,onChange:j=>m(j.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Medications"}),s.filter(j=>j.isActive).map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]}),e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsx("button",{onClick:()=>c("week"),className:`px-3 py-2 text-sm font-medium rounded-l-md border ${o==="week"?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Week"}),e.jsx("button",{onClick:()=>c("month"),className:`px-3 py-2 text-sm font-medium rounded-r-md border-t border-r border-b ${o==="month"?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Month"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:Ie(i,"MMMM yyyy")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f("prev"),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(_r,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>l(new Date),className:"px-3 py-1 text-sm font-medium text-primary-600 hover:text-primary-700",children:"Today"}),e.jsx("button",{onClick:()=>f("next"),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(Vr,{className:"h-5 w-5"})})]})]})}),e.jsx("div",{className:"card-content p-0",children:o==="month"?e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(j=>e.jsx("div",{className:"p-3 text-center text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0",children:j},j))}),e.jsx("div",{className:"grid grid-cols-7",children:S.map((j,F)=>e.jsx(h,{date:j,isCurrentMonth:Un(j,i)},F))})]}):e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:v.map(j=>e.jsxs("div",{className:"p-3 text-center border-r border-gray-200 last:border-r-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:Ie(j,"EEE")}),e.jsx("div",{className:`text-lg font-semibold mt-1 ${qt(j)?"text-primary-600":"text-gray-900"}`,children:Ie(j,"d")})]},j.toISOString()))}),e.jsx("div",{className:"grid grid-cols-7 min-h-[300px]",children:v.map(j=>e.jsx(h,{date:j},j.toISOString()))})]})})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:te(i,"EEEE, MMM d")})}),e.jsx("div",{className:"card-content",children:k.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($e,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No events"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No medications scheduled for this day."})]}):e.jsx("div",{className:"space-y-3",children:k.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(b,{status:j.status}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:j.medicationName}),e.jsxs("p",{className:"text-xs text-gray-500",children:[j.dosageInfo," • ",j.time]})]})]}),j.status==="upcoming"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>u(j.medicationId,"taken"),className:"btn-success text-xs px-2 py-1",children:"Take"}),e.jsx("button",{onClick:()=>u(j.medicationId,"missed"),className:"btn-secondary text-xs px-2 py-1",children:"Skip"})]})]},j.id))})})]}),e.jsxs("div",{className:"card mt-4",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Legend"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ys,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Taken"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($s,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Missed"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Upcoming"})]})]})})]})]})]})]})}class Wo extends I.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,t){console.error("ErrorBoundary caught an error:",a,t),this.props.onError&&this.props.onError(a,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center bg-red-50 rounded-lg border border-red-200",children:[e.jsx(X,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-red-600 mb-4",children:"We encountered an error while displaying this content."}),e.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0}),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Try Again"})]}):this.props.children}}function us({children:s}){return e.jsx(Wo,{fallback:e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"Unable to display chart"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Chart data may be invalid"})]})}),onError:a=>{console.error("Chart error:",a)},children:s})}function Bo(){var u,f,b;const{medications:s,logs:a}=ae(),[t,n]=I.useState("30d"),[r,i]=I.useState("all"),[l,o]=I.useState("adherence"),c=s.filter(h=>h.isActive),d=I.useMemo(()=>{const h=t==="7d"?7:t==="30d"?30:90,j=new Date,F=as(j,h-1);return st({start:F,end:j}).map(P=>{const M=a.filter(W=>{try{const H=new Date(W.timestamp);return H instanceof Date&&!isNaN(H.getTime())&&Ut(H,P)}catch{return!1}}),D=M.filter(W=>W.adherence==="taken").length,T=M.filter(W=>W.adherence==="missed").length,N=D+T,C=N>0?Math.round(D/N*100):0,p=Number.isFinite(C)&&C>=0&&C<=100?C:0,E=Number.isFinite(D)&&D>=0?D:0,U=Number.isFinite(T)&&T>=0?T:0;return{date:Ie(P,"MMM dd"),fullDate:P,taken:E,missed:U,adherence:p}})},[a,t]),m=I.useMemo(()=>{const h=t==="7d"?7:t==="30d"?30:90;return c.map(j=>{const F=a.filter(U=>{try{const W=new Date(U.timestamp);return U.medicationId===j.id&&W instanceof Date&&!isNaN(W.getTime())&&W>=as(new Date,h)}catch{return!1}}),P=F.filter(U=>U.adherence==="taken").length,M=F.length,D=Math.max(0,M-P),T=Tt(P,M),N=Number.isFinite(M)?M:0,C=Number.isFinite(P)?P:0,p=Number.isFinite(D)?D:0,E=Number.isFinite(T)?T:0;return{medicationId:j.id,medicationName:j.name,totalDoses:N,takenDoses:C,missedDoses:p,adherencePercentage:E,period:{start:as(new Date,h),end:new Date}}}).sort((j,F)=>(F.adherencePercentage||0)-(j.adherencePercentage||0))},[c,a,t]),x=I.useMemo(()=>{const h=t==="7d"?7:t==="30d"?30:90,j=a.filter(ne=>{try{const G=new Date(ne.timestamp);return G instanceof Date&&!isNaN(G.getTime())&&G>=as(new Date,h)}catch{return!1}}),F=j.filter(ne=>ne.adherence==="taken").length,P=j.filter(ne=>ne.adherence==="missed").length,M=F+P,D=Tt(F,M),T=h>0?Math.round(M/h*10)/10:0,N=a.filter(ne=>{try{const G=new Date(ne.timestamp),ve=as(new Date,h*2),oe=as(new Date,h);return G instanceof Date&&!isNaN(G.getTime())&&G>=ve&&G<oe}catch{return!1}}),C=N.filter(ne=>ne.adherence==="taken").length,p=N.length,E=Tt(C,p),U=D-E,W=Number.isFinite(D)?D:0,H=Number.isFinite(M)?M:0,K=Number.isFinite(F)?F:0,Z=Number.isFinite(P)?P:0,Q=Number.isFinite(T)?T:0,le=Number.isFinite(U)?U:0;return{overallAdherence:W,totalDoses:H,takenDoses:K,missedDoses:Z,avgDailyMeds:Q,trend:le}},[a,t]),y=m.slice(0,10).map(h=>{const j=Number.isFinite(h.adherencePercentage)&&!isNaN(h.adherencePercentage)?h.adherencePercentage:0,F=Number.isFinite(h.takenDoses)&&!isNaN(h.takenDoses)?h.takenDoses:0,P=Number.isFinite(h.missedDoses)&&!isNaN(h.missedDoses)?h.missedDoses:0;return{name:h.medicationName&&h.medicationName.length>15?h.medicationName.substring(0,15)+"...":h.medicationName||"Unknown",adherence:Math.max(0,Math.min(100,j)),taken:Math.max(0,F),missed:Math.max(0,P)}}).filter(h=>h.name&&h.name!=="Unknown"),R=[{name:"Taken",value:Number.isFinite(x.takenDoses)&&!isNaN(x.takenDoses)?Math.max(0,x.takenDoses):0,color:"#10b981"},{name:"Missed",value:Number.isFinite(x.missedDoses)&&!isNaN(x.missedDoses)?Math.max(0,x.missedDoses):0,color:"#ef4444"}].filter(h=>Number.isFinite(h.value)&&h.value>0),k=I.useMemo(()=>s.filter(j=>{var F;return((F=j.dependencePrevention)==null?void 0:F.withdrawalHistory)&&j.dependencePrevention.withdrawalHistory.length>0}).map(j=>{const F=j.dependencePrevention.withdrawalHistory,P=F.filter(T=>!T.successfullyCompleted),M=F.filter(T=>T.successfullyCompleted);let D=null;if(P.length>0){const T=P[P.length-1],N=Math.floor((new Date().getTime()-new Date(T.startDate).getTime())/(1e3*60*60*24)),C=T.symptoms.filter(U=>U.resolved).length,p=T.symptoms.length,E=p>0?Math.round(C/p*100):0;D={daysSinceStart:N,progressPercent:E,severity:T.severity,symptomCount:p,resolvedCount:C}}return{medicationName:j.name,medicationId:j.id,activeWithdrawals:P.length,completedWithdrawals:M.length,currentProgress:D,totalEvents:F.length}}),[s]),S=I.useMemo(()=>{const h=t==="7d"?7:t==="30d"?30:90,j=new Date,F=as(j,h-1),P=s.flatMap(p=>(p.sideEffectReports||[]).filter(E=>{const U=new Date(E.timestamp);return U>=F&&U<=j}).map(E=>({...E,medicationName:p.name,medicationId:p.id}))),M=P.reduce((p,E)=>(p[E.severity]=(p[E.severity]||0)+1,p),{}),D=P.reduce((p,E)=>(p[E.bodySystem]=(p[E.bodySystem]||0)+1,p),{}),T=st({start:F,end:j}).map(p=>{const E=P.filter(U=>Ut(new Date(U.timestamp),p));return{date:Ie(p,"MMM dd"),fullDate:p,total:E.length,mild:E.filter(U=>U.severity==="mild").length,moderate:E.filter(U=>U.severity==="moderate").length,severe:E.filter(U=>U.severity==="severe").length,lifeThreatening:E.filter(U=>U.severity==="life-threatening").length}}),N=P.reduce((p,E)=>(p[E.sideEffect]=(p[E.sideEffect]||0)+1,p),{}),C=Object.entries(N).sort(([,p],[,E])=>E-p).slice(0,10).map(([p,E])=>({name:p,count:E}));return{totalReports:P.length,severityDistribution:Object.entries(M).map(([p,E])=>({severity:p,count:E,percentage:Math.round(E/P.length*100)})),bodySystemDistribution:Object.entries(D).map(([p,E])=>({system:p,count:E,percentage:Math.round(E/P.length*100)})),dailyTrends:T,topSideEffects:C,recentReports:P.slice(-5).reverse()}},[s,t]),v=I.useMemo(()=>{const h=s.reduce((M,D)=>(D.isActive&&(M[D.riskLevel]=(M[D.riskLevel]||0)+1),M),{}),j=s.filter(M=>M.dependencePrevention&&M.isActive),F=j.reduce((M,D)=>{var p;const T=((p=D.dependencePrevention)==null?void 0:p.alerts)||[],N=T.filter(E=>!E.acknowledged).length,C=T.length;return{total:M.total+C,unacknowledged:M.unacknowledged+N,acknowledged:M.acknowledged+(C-N)}},{total:0,unacknowledged:0,acknowledged:0}),P=j.filter(M=>{var D;return(D=M.dependencePrevention)==null?void 0:D.taperingRecommended}).length;return{riskDistribution:Object.entries(h).map(([M,D])=>({risk:M,count:D,percentage:Math.round(D/c.length*100)})),alertCounts:F,taperingRecommendations:P,totalMonitored:j.length}},[s,c.length]),g=()=>{console.log("Exporting analytics data...")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Track your medication adherence and progress"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[e.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Medications"}),c.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]}),e.jsxs("select",{value:t,onChange:h=>n(h.target.value),className:"input",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"})]}),e.jsxs("button",{onClick:g,className:"btn-secondary inline-flex items-center space-x-2",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"adherence",label:"Adherence",icon:Se},{id:"withdrawal",label:"Withdrawal Progress",icon:we},{id:"side-effects",label:"Side Effects",icon:X},{id:"risk",label:"Risk Assessment",icon:Ce}].map(({id:h,label:j,icon:F})=>e.jsxs("button",{onClick:()=>o(h),className:`flex items-center space-x-2 py-3 px-1 border-b-2 font-medium text-sm ${l===h?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:j})]},h))})}),l==="adherence"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-md flex items-center justify-center",children:e.jsx(Se,{className:"h-5 w-5 text-green-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Overall Adherence"}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsxs("div",{className:`text-2xl font-semibold ${Gt(x.overallAdherence)}`,children:[Number.isFinite(x.overallAdherence)?x.overallAdherence:0,"%"]}),Number.isFinite(x.trend)&&x.trend!==0&&e.jsxs("div",{className:`ml-2 flex items-baseline text-sm font-semibold ${x.trend>0?"text-green-600":"text-red-600"}`,children:[x.trend>0?e.jsx(Se,{className:"self-center flex-shrink-0 h-4 w-4"}):e.jsx(Ls,{className:"self-center flex-shrink-0 h-4 w-4"}),e.jsxs("span",{className:"sr-only",children:[x.trend>0?"Increased":"Decreased"," by"]}),Math.abs(x.trend),"%"]})]})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center",children:e.jsx($e,{className:"h-5 w-5 text-blue-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Doses"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:Number.isFinite(x.totalDoses)?x.totalDoses:0})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-md flex items-center justify-center",children:e.jsx(ke,{className:"h-5 w-5 text-green-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Doses Taken"}),e.jsx("dd",{className:"text-2xl font-semibold text-green-600",children:Number.isFinite(x.takenDoses)?x.takenDoses:0})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-md flex items-center justify-center",children:e.jsx(sl,{className:"h-5 w-5 text-red-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Doses Missed"}),e.jsx("dd",{className:"text-2xl font-semibold text-red-600",children:Number.isFinite(x.missedDoses)?x.missedDoses:0})]})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Adherence Trend"})}),e.jsx("div",{className:"card-content",children:d.length>0&&d.some(h=>Number.isFinite(h.adherence))?e.jsx(us,{children:e.jsx(cs,{width:"100%",height:300,children:e.jsxs(ga,{data:d.filter(h=>Number.isFinite(h.adherence)&&Number.isFinite(h.taken)&&Number.isFinite(h.missed)),children:[e.jsx(Dt,{strokeDasharray:"3 3"}),e.jsx(Ct,{dataKey:"date"}),e.jsx(St,{domain:[0,100]}),e.jsx(ds,{formatter:(h,j)=>[`${h}${j==="adherence"?"%":""}`,j==="adherence"?"Adherence":j==="taken"?"Taken":"Missed"]}),e.jsx(Rt,{type:"monotone",dataKey:"adherence",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:4}})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:"No data available for the selected time period"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Adherence Distribution"})}),e.jsx("div",{className:"card-content",children:R.length>0?e.jsx(us,{children:e.jsx(cs,{width:"100%",height:300,children:e.jsxs(Mt,{children:[e.jsx(Pt,{data:R,cx:"50%",cy:"50%",labelLine:!1,label:({name:h,percent:j})=>`${h} ${(j*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:R.map((h,j)=>e.jsx(zn,{fill:h.color},`cell-${j}`))}),e.jsx(ds,{})]})})}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:"No medication data available"})})]})]}),y.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Adherence by Medication"})}),e.jsx("div",{className:"card-content",children:e.jsx(us,{children:e.jsx(cs,{width:"100%",height:400,children:e.jsxs(On,{data:y,layout:"horizontal",children:[e.jsx(Dt,{strokeDasharray:"3 3"}),e.jsx(Ct,{type:"number",domain:[0,100],tickFormatter:h=>Number.isFinite(h)&&!isNaN(h)?`${Math.round(h)}%`:"0%"}),e.jsx(St,{dataKey:"name",type:"category",width:120,tickFormatter:h=>h||"Unknown"}),e.jsx(ds,{formatter:(h,j)=>[`${Number.isFinite(h)&&!isNaN(h)?Math.round(Number(h)):0}${j==="adherence"?"%":""}`,j==="adherence"?"Adherence":j==="taken"?"Taken":"Missed"]}),e.jsx(_n,{dataKey:"adherence",fill:"#3b82f6",isAnimationActive:!1})]})})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Medication Reports"})}),e.jsx("div",{className:"card-content",children:m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(fs,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No data available"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start logging your medications to see analytics."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Medication"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Adherence"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taken"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Missed"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:h.medicationName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:`text-sm font-medium ${Gt(h.adherencePercentage)}`,children:[Number.isFinite(h.adherencePercentage)?h.adherencePercentage:0,"%"]}),e.jsx("div",{className:"ml-2 w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${h.adherencePercentage>=90?"bg-green-600":h.adherencePercentage>=75?"bg-yellow-600":h.adherencePercentage>=50?"bg-orange-600":"bg-red-600"}`,style:{width:`${Number.isFinite(h.adherencePercentage)?Math.max(0,Math.min(100,h.adherencePercentage)):0}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:Number.isFinite(h.takenDoses)?h.takenDoses:0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:Number.isFinite(h.missedDoses)?h.missedDoses:0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Number.isFinite(h.totalDoses)?h.totalDoses:0})]},h.medicationId))})]})})})]})]}),l==="withdrawal"&&e.jsx("div",{className:"space-y-6",children:k.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No Withdrawal Tracking Data"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start tracking withdrawal symptoms to see progress analytics here."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-md flex items-center justify-center",children:e.jsx(we,{className:"h-5 w-5 text-purple-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Withdrawals"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:k.reduce((h,j)=>h+j.activeWithdrawals,0)})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-md flex items-center justify-center",children:e.jsx(we,{className:"h-5 w-5 text-green-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed Withdrawals"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:k.reduce((h,j)=>h+j.completedWithdrawals,0)})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center",children:e.jsx(Qe,{className:"h-5 w-5 text-blue-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Medications Tracked"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:k.length})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-md flex items-center justify-center",children:e.jsx(ke,{className:"h-5 w-5 text-orange-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Progress"}),e.jsxs("dd",{className:"text-lg font-medium text-gray-900",children:[k.filter(h=>h.currentProgress).length>0?Math.round(k.filter(h=>h.currentProgress).reduce((h,j)=>h+j.currentProgress.progressPercent,0)/k.filter(h=>h.currentProgress).length):0,"%"]})]})})]})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Withdrawal Progress by Medication"})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-4",children:k.map(h=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:h.medicationName}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Active: ",h.activeWithdrawals]}),e.jsxs("span",{children:["Completed: ",h.completedWithdrawals]})]})]}),h.currentProgress&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Withdrawal Progress"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[h.currentProgress.daysSinceStart," days"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:`h-2 rounded-full ${h.currentProgress.progressPercent>=75?"bg-green-500":h.currentProgress.progressPercent>=50?"bg-yellow-500":h.currentProgress.progressPercent>=25?"bg-orange-500":"bg-red-500"}`,style:{width:`${h.currentProgress.progressPercent}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[e.jsxs("span",{children:[h.currentProgress.resolvedCount,"/",h.currentProgress.symptomCount," symptoms resolved"]}),e.jsxs("span",{children:[h.currentProgress.progressPercent,"% complete"]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${h.currentProgress.severity==="mild"?"bg-green-100 text-green-800":h.currentProgress.severity==="moderate"?"bg-yellow-100 text-yellow-800":h.currentProgress.severity==="severe"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:[h.currentProgress.severity," severity"]})})]}),!h.currentProgress&&h.completedWithdrawals>0&&e.jsx("div",{className:"bg-green-50 p-3 rounded",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-800",children:[h.completedWithdrawals," successful withdrawal",h.completedWithdrawals!==1?"s":""," completed"]})]})})]},h.medicationId))})})]})]})}),l==="side-effects"&&e.jsx("div",{className:"space-y-6",children:S.totalReports===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(X,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No Side Effect Reports"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Report side effects to see trend analysis here."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-md flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-orange-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Reports"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:S.totalReports})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-md flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-red-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Severe Reports"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:((u=S.severityDistribution.find(h=>h.severity==="severe"))==null?void 0:u.count)||0})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center",children:e.jsx(fs,{className:"h-5 w-5 text-blue-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Most Common"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:((f=S.topSideEffects[0])==null?void 0:f.name)||"None"})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-md flex items-center justify-center",children:e.jsx(Qe,{className:"h-5 w-5 text-purple-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Daily"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:Math.round(S.totalReports/(t==="7d"?7:t==="30d"?30:90)*10)/10})]})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Daily Side Effect Reports"})}),e.jsx("div",{className:"card-content",children:e.jsx(us,{children:e.jsx(cs,{width:"100%",height:300,children:e.jsxs(ga,{data:S.dailyTrends,children:[e.jsx(Dt,{strokeDasharray:"3 3"}),e.jsx(Ct,{dataKey:"date"}),e.jsx(St,{}),e.jsx(ds,{}),e.jsx(Rt,{type:"monotone",dataKey:"total",stroke:"#f59e0b",strokeWidth:2}),e.jsx(Rt,{type:"monotone",dataKey:"severe",stroke:"#ef4444",strokeWidth:2})]})})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Severity Distribution"})}),e.jsx("div",{className:"card-content",children:e.jsx(us,{children:e.jsx(cs,{width:"100%",height:300,children:e.jsxs(Mt,{children:[e.jsx(Pt,{data:S.severityDistribution.map(h=>({name:h.severity,value:h.count,fill:h.severity==="mild"?"#10b981":h.severity==="moderate"?"#f59e0b":h.severity==="severe"?"#ef4444":"#dc2626"})),cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:h,value:j})=>`${h}: ${j}`}),e.jsx(ds,{})]})})})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Most Common Side Effects"})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-3",children:S.topSideEffects.map((h,j)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"w-6 h-6 bg-orange-100 text-orange-800 rounded-full flex items-center justify-center text-xs font-medium",children:j+1}),e.jsx("span",{className:"font-medium text-gray-900",children:h.name})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[h.count," reports"]})]},h.name))})})]})]})}),l==="risk"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center",children:e.jsx(Ce,{className:"h-5 w-5 text-blue-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Monitored Meds"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:v.totalMonitored})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-md flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-orange-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Alerts"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:v.alertCounts.unacknowledged})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-md flex items-center justify-center",children:e.jsx(Ls,{className:"h-5 w-5 text-purple-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Tapering Recommended"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:v.taperingRecommendations})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-md flex items-center justify-center",children:e.jsx(Ce,{className:"h-5 w-5 text-red-600"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"High Risk Meds"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:((b=v.riskDistribution.find(h=>h.risk==="high"))==null?void 0:b.count)||0})]})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Risk Level Distribution"})}),e.jsx("div",{className:"card-content",children:e.jsx(us,{children:e.jsx(cs,{width:"100%",height:300,children:e.jsxs(Mt,{children:[e.jsx(Pt,{data:v.riskDistribution.map(h=>({name:h.risk,value:h.count,fill:h.risk==="low"?"#10b981":h.risk==="moderate"?"#f59e0b":h.risk==="high"?"#ef4444":"#dc2626"})),cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:h,value:j})=>`${h}: ${j}`}),e.jsx(ds,{})]})})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Alert Status"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-red-800",children:"Unacknowledged Alerts"}),e.jsx("span",{className:"text-lg font-bold text-red-900",children:v.alertCounts.unacknowledged})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Acknowledged Alerts"}),e.jsx("span",{className:"text-lg font-bold text-green-900",children:v.alertCounts.acknowledged})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-gray-800",children:"Total Alerts"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:v.alertCounts.total})]})]})})]})]})]})]})}function Ho({isOpen:s,onClose:a}){const{exportDataWithOptions:t,exportToCSV:n,exportToPDF:r}=ae(),[i,l]=I.useState({format:"json",includeMedications:!0,includeLogs:!0,includeReminders:!0,includeProfile:!0,includePersonalInfo:!0,includeAdvancedFeatures:!1,dateRange:{enabled:!1,start:new Date(Date.now()-30*24*60*60*1e3),end:new Date}}),[o,c]=I.useState(!1),d=async()=>{c(!0);try{let m,x,y;const R=new Date().toISOString().split("T")[0];switch(i.format){case"json":m=await t({...i,dateRange:i.dateRange.enabled?i.dateRange:void 0}),x=`medtrack-export-${R}.json`,y="application/json";break;case"csv":m=n("all",i.dateRange.enabled?i.dateRange:void 0),x=`medtrack-export-${R}.csv`,y="text/csv";break;case"pdf":m=await r(i),x=`medtrack-export-${R}.json`,y="application/json";break;default:throw new Error("Invalid export format")}Xs(m,x,y),J.success(`Data exported as ${i.format.toUpperCase()} successfully`),a()}catch(m){J.error("Failed to export data"),console.error("Export error:",m)}finally{c(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 mobile-safe-area",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full mobile-modal overflow-y-auto mobile-scroll",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Je,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Export Data"})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"json",label:"JSON",icon:Wr,description:"Complete data with metadata"},{value:"csv",label:"CSV",icon:vs,description:"Spreadsheet compatible"},{value:"pdf",label:"PDF",icon:vs,description:"Formatted report (Coming soon)"}].map(m=>e.jsxs("button",{onClick:()=>l(x=>({...x,format:m.value})),className:`p-4 rounded-lg border-2 transition-all ${i.format===m.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,disabled:m.value==="pdf",children:[e.jsx(m.icon,{className:`h-6 w-6 mx-auto mb-2 ${i.format===m.value?"text-blue-600":"text-gray-400"}`}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:m.description})]},m.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Data to Include"}),e.jsx("div",{className:"space-y-3",children:[{key:"includeMedications",label:"Medications",description:"All medication records and details"},{key:"includeLogs",label:"Medication Logs",description:"Dosage history and adherence data"},{key:"includeReminders",label:"Reminders",description:"Notification schedules and settings"},{key:"includeProfile",label:"Health Profile",description:"Personal health information"},{key:"includeAdvancedFeatures",label:"Advanced Features",description:"Smart messages, risk assessments, etc."}].map(m=>e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i[m.key],onChange:x=>l(y=>({...y,[m.key]:x.target.checked})),className:"mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.label}),e.jsx("div",{className:"text-xs text-gray-500",children:m.description})]})]},m.key))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("input",{type:"checkbox",checked:i.dateRange.enabled,onChange:m=>l(x=>({...x,dateRange:{...x.dateRange,enabled:m.target.checked}})),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter by Date Range"})]}),i.dateRange.enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 ml-7",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:i.dateRange.start.toISOString().split("T")[0],onChange:m=>l(x=>({...x,dateRange:{...x.dateRange,start:new Date(m.target.value)}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:i.dateRange.end.toISOString().split("T")[0],onChange:m=>l(x=>({...x,dateRange:{...x.dateRange,end:new Date(m.target.value)}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500"})]})]})]}),i.includeProfile&&i.includePersonalInfo&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Fs,{className:"h-5 w-5 text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-amber-800",children:"Privacy Notice"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Your export will include personal health information. Please handle the exported file securely."})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[e.jsx("button",{onClick:a,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:d,disabled:o,className:"btn-primary inline-flex items-center space-x-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Export Data"})]})})]})]})}):null}function Yo({isOpen:s,onClose:a}){const{importDataWithValidation:t,validateImportData:n}=ae(),[r,i]=I.useState(null),[l,o]=I.useState(null),[c,d]=I.useState(null),[m,x]=I.useState(!1),[y,R]=I.useState(!1),[k,S]=I.useState(null),v=I.useRef(null),g=async h=>{var P;const j=(P=h.target.files)==null?void 0:P[0];if(!j)return;if(i(j),o(null),d(null),S(null),!j.name.endsWith(".json")){d({isValid:!1,errors:["Only JSON files are supported for import"],warnings:[]});return}R(!0);const F=new FileReader;F.onload=async M=>{var D;try{const T=JSON.parse((D=M.target)==null?void 0:D.result);o(T);const N=n(T);d(N)}catch{d({isValid:!1,errors:["Invalid JSON file format"],warnings:[]})}finally{R(!1)}},F.onerror=()=>{d({isValid:!1,errors:["Failed to read file"],warnings:[]}),R(!1)},F.readAsText(j)},u=async()=>{if(!(!l||!(c!=null&&c.isValid))){x(!0);try{const h=await t(l,"json");S(h),h.success?(J.success("Data imported successfully"),setTimeout(()=>{a()},2e3)):J.error("Import failed with errors")}catch{S({success:!1,errors:["Unexpected error during import"],warnings:[]}),J.error("Import failed")}finally{x(!1)}}},f=()=>{i(null),o(null),d(null),S(null),x(!1),R(!1),v.current&&(v.current.value=""),a()},b=()=>{var j,F,P,M;return l?{medications:((j=l.medications)==null?void 0:j.length)||0,logs:((F=l.logs)==null?void 0:F.length)||0,reminders:((P=l.reminders)==null?void 0:P.length)||0,hasProfile:!!l.userProfile,version:((M=l.exportMetadata)==null?void 0:M.version)||"Unknown"}:null};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 mobile-safe-area",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full mobile-modal overflow-y-auto mobile-scroll",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Yt,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Import Data"})]}),e.jsx("button",{onClick:f,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Data File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{ref:v,type:"file",accept:".json",onChange:g,className:"hidden",id:"import-file"}),e.jsxs("label",{htmlFor:"import-file",className:"cursor-pointer flex flex-col items-center space-y-2",children:[e.jsx(vs,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:r?r.name:"Click to select a JSON file"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Only MedTrack JSON export files are supported"})]})]})]}),y&&e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-blue-50 rounded-lg",children:[e.jsx(Yr,{className:"h-5 w-5 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Validating file..."})]}),c&&!y&&e.jsx("div",{className:`p-4 rounded-lg ${c.isValid?"bg-green-50":"bg-red-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[c.isValid?e.jsx(_e,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(X,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`text-sm font-medium ${c.isValid?"text-green-800":"text-red-800"}`,children:c.isValid?"File is valid and ready to import":"File validation failed"}),c.errors.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Errors:"}),e.jsx("ul",{className:"text-sm text-red-600 list-disc list-inside mt-1",children:c.errors.map((h,j)=>e.jsx("li",{children:h},j))})]}),c.warnings.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-amber-700 font-medium",children:"Warnings:"}),e.jsx("ul",{className:"text-sm text-amber-600 list-disc list-inside mt-1",children:c.warnings.map((h,j)=>e.jsx("li",{children:h},j))})]})]})]})}),(c==null?void 0:c.isValid)&&!y&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Import Summary"}),(()=>{const h=b();return h?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Medications:"}),e.jsx("span",{className:"font-medium",children:h.medications})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Medication Logs:"}),e.jsx("span",{className:"font-medium",children:h.logs})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Reminders:"}),e.jsx("span",{className:"font-medium",children:h.reminders})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Health Profile:"}),e.jsx("span",{className:"font-medium",children:h.hasProfile?"Yes":"No"})]})]})]}):null})()]}),k&&e.jsx("div",{className:`p-4 rounded-lg ${k.success?"bg-green-50":"bg-red-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[k.success?e.jsx(_e,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(xs,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`text-sm font-medium ${k.success?"text-green-800":"text-red-800"}`,children:k.success?"Data imported successfully!":"Import failed"}),k.errors.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx("ul",{className:"text-sm text-red-600 list-disc list-inside",children:k.errors.map((h,j)=>e.jsx("li",{children:h},j))})}),k.warnings.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx("ul",{className:"text-sm text-amber-600 list-disc list-inside",children:k.warnings.map((h,j)=>e.jsx("li",{children:h},j))})})]})]})}),!k&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(X,{className:"h-5 w-5 text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-amber-800",children:"Important"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Importing data will add to your existing records. A backup of your current data will be created automatically before import."})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[e.jsx("button",{onClick:f,className:"btn-secondary",children:k!=null&&k.success?"Close":"Cancel"}),!k&&e.jsx("button",{onClick:u,disabled:!(c!=null&&c.isValid)||m,className:"btn-primary inline-flex items-center space-x-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Importing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{children:"Import Data"})]})})]})]})}):null}function Go(){var u,f,b,h,j,F,P,M,D,T,N,C,p,E,U,W,H,K,Z,Q,le,ne;const{userProfile:s,updateProfile:a,createProfile:t,clearAllData:n}=ae(),[r,i]=I.useState("profile"),[l,o]=I.useState(!1),[c,d]=I.useState(!1),[m,x]=I.useState(!1),{register:y,handleSubmit:R,formState:{errors:k}}=jt({defaultValues:{name:(s==null?void 0:s.name)||"",dateOfBirth:((u=s==null?void 0:s.dateOfBirth)==null?void 0:u.toISOString().split("T")[0])||"",allergies:((f=s==null?void 0:s.allergies)==null?void 0:f.join(", "))||"",conditions:((b=s==null?void 0:s.conditions)==null?void 0:b.join(", "))||"",emergencyContactName:((h=s==null?void 0:s.emergencyContact)==null?void 0:h.name)||"",emergencyContactRelationship:((j=s==null?void 0:s.emergencyContact)==null?void 0:j.relationship)||"",emergencyContactPhone:((F=s==null?void 0:s.emergencyContact)==null?void 0:F.phone)||"",emergencyContactEmail:((P=s==null?void 0:s.emergencyContact)==null?void 0:P.email)||"",theme:((M=s==null?void 0:s.preferences)==null?void 0:M.theme)||"system",pushNotifications:((T=(D=s==null?void 0:s.preferences)==null?void 0:D.notifications)==null?void 0:T.push)??!0,soundNotifications:((C=(N=s==null?void 0:s.preferences)==null?void 0:N.notifications)==null?void 0:C.sound)??!0,vibrationNotifications:((E=(p=s==null?void 0:s.preferences)==null?void 0:p.notifications)==null?void 0:E.vibration)??!0,reminderAdvance:((W=(U=s==null?void 0:s.preferences)==null?void 0:U.notifications)==null?void 0:W.reminderAdvance)??15,timeFormat:((K=(H=s==null?void 0:s.preferences)==null?void 0:H.display)==null?void 0:K.timeFormat)||"12h",dateFormat:((Q=(Z=s==null?void 0:s.preferences)==null?void 0:Z.display)==null?void 0:Q.dateFormat)||"MM/DD/YYYY",defaultView:((ne=(le=s==null?void 0:s.preferences)==null?void 0:le.display)==null?void 0:ne.defaultView)||"dashboard"}}),S=G=>{const ve={name:G.name.trim(),dateOfBirth:G.dateOfBirth?new Date(G.dateOfBirth):void 0,allergies:G.allergies?G.allergies.split(",").map(oe=>oe.trim()).filter(Boolean):void 0,conditions:G.conditions?G.conditions.split(",").map(oe=>oe.trim()).filter(Boolean):void 0,emergencyContact:G.emergencyContactName||G.emergencyContactPhone?{name:G.emergencyContactName,relationship:G.emergencyContactRelationship,phone:G.emergencyContactPhone,email:G.emergencyContactEmail||void 0}:void 0,preferences:{theme:G.theme,notifications:{push:G.pushNotifications,sound:G.soundNotifications,vibration:G.vibrationNotifications,reminderAdvance:G.reminderAdvance},display:{timeFormat:G.timeFormat,dateFormat:G.dateFormat,defaultView:G.defaultView}}};s?a(ve):t({...ve,name:ve.name,preferences:ve.preferences}),J.success("Settings updated successfully")},v=()=>{n(),o(!1),J.success("All data cleared")},g=[{id:"profile",label:"Profile",icon:ot},{id:"notifications",label:"Notifications",icon:rs},{id:"data",label:"Data",icon:Je}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account and application preferences"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:g.map(G=>e.jsxs("button",{onClick:()=>i(G.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${r===G.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(G.icon,{className:"w-4 h-4"}),e.jsx("span",{children:G.label})]},G.id))})}),e.jsxs("form",{onSubmit:R(S),className:"p-6",children:[r==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",...y("name",{required:"Name is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),k.name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:k.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",...y("dateOfBirth"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allergies"}),e.jsx("input",{type:"text",placeholder:"Separate with commas",...y("allergies"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medical Conditions"}),e.jsx("input",{type:"text",placeholder:"Separate with commas",...y("conditions"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Emergency Contact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name"}),e.jsx("input",{type:"text",...y("emergencyContactName"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Relationship"}),e.jsx("input",{type:"text",...y("emergencyContactRelationship"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",...y("emergencyContactPhone"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",...y("emergencyContactEmail"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})]}),r==="notifications"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Notification Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"pushNotifications",...y("pushNotifications"),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"pushNotifications",className:"text-sm text-gray-700",children:"Enable push notifications"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"soundNotifications",...y("soundNotifications"),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"soundNotifications",className:"text-sm text-gray-700",children:"Play sound for notifications"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"vibrationNotifications",...y("vibrationNotifications"),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"vibrationNotifications",className:"text-sm text-gray-700",children:"Enable vibration for notifications"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reminder advance time (minutes)"}),e.jsxs("select",{...y("reminderAdvance"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:5,children:"5 minutes"}),e.jsx("option",{value:10,children:"10 minutes"}),e.jsx("option",{value:15,children:"15 minutes"}),e.jsx("option",{value:30,children:"30 minutes"}),e.jsx("option",{value:60,children:"1 hour"})]})]})]})]})}),r==="data"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Data Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>d(!0),className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 transition-colors",children:[e.jsx(Je,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{children:"Export Data"})]}),e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 transition-colors",children:[e.jsx(Yt,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{children:"Import Data"})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900 mb-2",children:"Danger Zone"}),e.jsx("p",{className:"text-sm text-red-700 mb-3",children:"This will permanently delete all your data including medications, logs, and settings."}),e.jsxs("button",{type:"button",onClick:()=>o(!0),className:"flex items-center space-x-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(yt,{className:"w-4 h-4"}),e.jsx("span",{children:"Clear All Data"})]})]})]})})]})}),e.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:e.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(aa,{className:"w-4 h-4"}),e.jsx("span",{children:"Save Settings"})]})})]})]})}),e.jsx(da,{isOpen:l,onClose:()=>o(!1),onConfirm:v,title:"Clear All Data",message:"Are you sure you want to delete all your data? This action cannot be undone.",confirmText:"Clear All Data"}),e.jsx(Ho,{isOpen:c,onClose:()=>d(!1)}),e.jsx(Yo,{isOpen:m,onClose:()=>x(!1)})]})}const Ko=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}];function Jo({isOpen:s,onClose:a,reminder:t}){const{medications:n,addReminder:r,updateReminder:i,generateContextualMessage:l}=ae(),o=!!t,c=n.filter(P=>P.isActive),{register:d,handleSubmit:m,watch:x,setValue:y,reset:R,formState:{errors:k}}=jt({defaultValues:{medicationId:"",time:"08:00",days:[],isActive:!0,customMessage:"",notificationSound:!0}}),S=x("days")||[],v=x("medicationId"),g=n.find(P=>P.id===v);I.useEffect(()=>{s&&R(t?{medicationId:t.medicationId,time:t.time,days:t.days,isActive:t.isActive,customMessage:t.customMessage||"",notificationSound:t.notificationSound||!0}:{medicationId:"",time:"08:00",days:[],isActive:!0,customMessage:"",notificationSound:!0})},[s,t,R]);const u=P=>{const M=S,D=M.includes(P)?M.filter(T=>T!==P):[...M,P];y("days",D)},f=P=>{switch(P){case"daily":y("days",["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]);break;case"weekdays":y("days",["monday","tuesday","wednesday","thursday","friday"]);break;case"weekends":y("days",["saturday","sunday"]);break}},b=P=>{var D;if(P.days.length===0){J.error("Please select at least one day");return}const M={medicationId:P.medicationId,time:P.time,days:P.days,isActive:P.isActive,customMessage:((D=P.customMessage)==null?void 0:D.trim())||void 0,notificationSound:P.notificationSound};o&&t?(i(t.id,M),J.success("Reminder updated successfully"),l(P.medicationId,"motivation")):(r(M),J.success("Reminder created successfully"),n.find(N=>N.id===P.medicationId)&&l(P.medicationId,"celebration")),a()},h=()=>S.length===0?"No days selected":S.length===7?"Daily":S.length===5&&!S.includes("saturday")&&!S.includes("sunday")?"Weekdays only":S.length===2&&S.includes("saturday")&&S.includes("sunday")?"Weekends only":`${S.length} days per week`,F=(()=>g?g.riskLevel==="high"?{message:"Setting reminders for high-priority medications helps ensure consistent treatment and prevents complications.",color:"bg-red-50 border-red-200 text-red-700"}:g.category==="vitamin"||g.category==="supplement"?{message:"Regular reminders help build healthy habits and maximize the benefits of your wellness routine.",color:"bg-green-50 border-green-200 text-green-700"}:{message:"Consistent medication timing improves effectiveness and helps you build a healthy routine.",color:"bg-blue-50 border-blue-200 text-blue-700"}:null)();return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:a}),e.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:e.jsxs("form",{onSubmit:m(b),children:[e.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(rs,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o?"Edit Reminder":"Create New Reminder"})]}),e.jsx("button",{type:"button",onClick:a,className:"rounded-md bg-white text-gray-400 hover:text-gray-500",children:e.jsx(ce,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medication *"}),e.jsxs("select",{...d("medicationId",{required:"Please select a medication"}),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select a medication..."}),c.map(P=>e.jsxs("option",{value:P.id,children:[P.name," - ",P.dosage," ",P.unit]},P.id))]}),k.medicationId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.medicationId.message})]}),F&&e.jsx("div",{className:`p-3 rounded-lg border ${F.color}`,children:e.jsx("p",{className:"text-sm font-medium",children:F.message})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reminder Time *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"time",...d("time",{required:"Please select a time"}),className:"input pl-10 w-full"})]}),k.time&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.time.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Schedule"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>f("daily"),className:"btn-secondary text-sm py-2",children:"Daily"}),e.jsx("button",{type:"button",onClick:()=>f("weekdays"),className:"btn-secondary text-sm py-2",children:"Weekdays"}),e.jsx("button",{type:"button",onClick:()=>f("weekends"),className:"btn-secondary text-sm py-2",children:"Weekends"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Days of Week *"}),e.jsx("div",{className:"space-y-2",children:Ko.map(P=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:S.includes(P.value),onChange:()=>u(P.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:P.label})]},P.value))}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Selected: ",h()]}),S.length===0&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Please select at least one day"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Message (Optional)"}),e.jsx("textarea",{...d("customMessage"),rows:3,className:"input w-full",placeholder:"Add a personal reminder message..."}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This message will be shown with your reminder notification"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...d("notificationSound"),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Play notification sound"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...d("isActive"),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Reminder is active"})]})]}),g&&S.length>0&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Reminder Preview"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:g.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[x("time")," • ",h()]})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"submit",className:"w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 sm:ml-3 sm:w-auto",children:o?"Update Reminder":"Create Reminder"}),e.jsx("button",{type:"button",onClick:a,className:"mt-3 w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Cancel"})]})]})})]})}):null}class $t{static analyzeAdherencePatterns(a,t,n=30){const r=new Date;return r.setDate(r.getDate()-n),a.filter(i=>i.isActive).map(i=>{const l=t.filter(o=>o.medicationId===i.id&&new Date(o.timestamp)>=r);return this.analyzeMedicationPattern(i,l)}).filter(i=>i.adherencePercentage<100||i.riskLevel!=="low")}static analyzeMedicationPattern(a,t){const n=t.filter(y=>y.adherence==="taken"),r=t.filter(y=>y.adherence==="missed"),i=t.length>0?Math.round(n.length/t.length*100):100,l=this.calculateConsecutiveMissedDoses(t),o=this.detectMissedDosePattern(r),c=this.getFrequentMissTimeSlots(r),d=this.calculateAdherenceRiskLevel(i,l,r.length,a.riskLevel),m=this.predictMissRisk(t,a),x=this.generateRecommendations(i,o,l,c,a);return{medicationId:a.id,medicationName:a.name,adherencePercentage:i,consecutiveMissedDoses:l,frequentMissTimeSlots:c,missedDosePattern:o,riskLevel:d,predictedMissRisk:m,recommendations:x}}static calculateConsecutiveMissedDoses(a){if(a.length===0)return 0;const t=a.sort((r,i)=>new Date(i.timestamp).getTime()-new Date(r.timestamp).getTime());let n=0;for(const r of t)if(r.adherence==="missed")n++;else break;return n}static detectMissedDosePattern(a){if(a.length===0)return"random";const t={morning:0,evening:0,weekend:0,weekday:0};a.forEach(r=>{const i=new Date(r.timestamp),l=i.getHours(),o=i.getDay();l>=6&&l<12&&t.morning++,l>=18&&l<24&&t.evening++,o===0||o===6?t.weekend++:t.weekday++});const n=a.length;return t.morning/n>=.7?"morning":t.evening/n>=.7?"evening":t.weekend/n>=.7?"weekend":t.weekday/n>=.7?"weekday":n>=3?"daily":"random"}static getFrequentMissTimeSlots(a){const t={};a.forEach(r=>{const i=new Date(r.timestamp).getHours(),l=i>=6&&i<12?"Morning (6AM-12PM)":i>=12&&i<18?"Afternoon (12PM-6PM)":i>=18&&i<24?"Evening (6PM-12AM)":"Night (12AM-6AM)";t[l]=(t[l]||0)+1});const n=Math.max(1,Math.ceil(a.length*.3));return Object.entries(t).filter(([,r])=>r>=n).map(([r])=>r)}static calculateAdherenceRiskLevel(a,t,n,r){let i=0;return a<50?i+=40:a<70?i+=25:a<85&&(i+=15),t>=5?i+=30:t>=3?i+=20:t>=2&&(i+=10),n>=10?i+=20:n>=5&&(i+=10),r==="high"?i*=1.5:r==="moderate"&&(i*=1.2),i>=70?"critical":i>=45?"high":i>=20?"moderate":"low"}static predictMissRisk(a,t){if(a.length===0)return 10;const n=a.slice(-14),r=n.filter(c=>c.adherence==="missed").length;let l=(1-(n.length>0?(n.length-r)/n.length:1))*100;const o=this.calculateConsecutiveMissedDoses(a);if(o>0&&(l+=o*15),t.riskLevel==="high"?l*=1.3:t.riskLevel==="moderate"&&(l*=1.1),a.length>0){const c=a[a.length-1],d=(Date.now()-new Date(c.timestamp).getTime())/(1e3*60*60);d>48?l+=20:d>24&&(l+=10)}return Math.min(95,Math.max(5,Math.round(l)))}static generateRecommendations(a,t,n,r,i){const l=[];switch(a<50&&l.push({type:"medical-review",priority:"urgent",message:"Urgent: Schedule immediate appointment with healthcare provider",actionable:!0,details:"Adherence below 50% significantly reduces medication effectiveness and may pose health risks."}),n>=3&&l.push({type:"behavioral-intervention",priority:"high",message:"Consider using a pill organizer or medication app with alarms",actionable:!0,details:`You've missed ${n} consecutive doses. Breaking this pattern is crucial.`}),t){case"morning":l.push({type:"reminder-adjustment",priority:"medium",message:"Move morning reminders earlier or add an evening dose if approved by doctor",actionable:!0,details:"Morning doses are frequently missed. Consider adjusting your schedule."});break;case"evening":l.push({type:"reminder-adjustment",priority:"medium",message:"Set multiple evening reminders or take with dinner",actionable:!0,details:"Evening doses are often forgotten. Link to a consistent evening routine."});break;case"weekend":l.push({type:"scheduling-change",priority:"medium",message:"Set stronger weekend reminders and maintain weekday schedule",actionable:!0,details:"Weekend routine disruption affects medication adherence."});break;case"weekday":l.push({type:"scheduling-change",priority:"medium",message:"Consider taking medication at home before work or during lunch",actionable:!0,details:"Weekday schedule may be interfering with medication timing."});break}return r.length>0&&l.push({type:"reminder-adjustment",priority:"medium",message:`Add extra reminders during ${r.join(" and ")}`,actionable:!0,details:"These time periods show frequent missed doses."}),i.riskLevel==="high"&&a<90&&l.push({type:"education",priority:"high",message:"Review importance of consistent dosing for this high-risk medication",actionable:!0,details:"This medication requires high adherence to prevent serious complications."}),a<80&&a>=50&&l.push({type:"behavioral-intervention",priority:"medium",message:"Consider habit stacking - link medication to an existing daily routine",actionable:!0,details:"Connecting medication to established habits improves consistency."}),l}static generateSmartNotifications(a,t,n){const r=[],i=new Date;return a.forEach(l=>{t.find(c=>c.id===l.medicationId)&&(l.predictedMissRisk>70&&r.push({id:ee(),medicationId:l.medicationId,type:"predictive-reminder",title:"High Risk of Missing Dose",message:`${l.medicationName}: ${l.predictedMissRisk}% chance of missing next dose. Extra attention needed!`,priority:"high",scheduledTime:new Date(i.getTime()+30*60*1e3),triggered:!1,context:{riskScore:l.predictedMissRisk,pattern:l.missedDosePattern}}),l.consecutiveMissedDoses>=2&&r.push({id:ee(),medicationId:l.medicationId,type:"adherence-support",title:"Missed Dose Pattern Detected",message:`You've missed ${l.consecutiveMissedDoses} doses of ${l.medicationName} in a row. Let's get back on track!`,priority:l.consecutiveMissedDoses>=3?"high":"medium",scheduledTime:i,triggered:!1,context:{missedCount:l.consecutiveMissedDoses}}),l.missedDosePattern!=="random"&&r.push({id:ee(),medicationId:l.medicationId,type:"pattern-alert",title:"Medication Pattern Identified",message:`You tend to miss ${l.medicationName} doses in the ${l.missedDosePattern}. Would you like to adjust your reminders?`,priority:"medium",scheduledTime:new Date(i.getTime()+60*60*1e3),triggered:!1,context:{pattern:l.missedDosePattern}}),l.adherencePercentage>=90&&l.adherencePercentage<100&&r.push({id:ee(),medicationId:l.medicationId,type:"encouragement",title:"Great Adherence!",message:`${l.adherencePercentage}% adherence for ${l.medicationName}. You're doing excellent - keep it up!`,priority:"low",scheduledTime:new Date(i.getTime()+4*60*60*1e3),triggered:!1}))}),r}static getAdherenceInsights(a){if(a.length===0)return{overallRisk:"low",totalMedications:0,medicationsAtRisk:0,avgAdherence:100,topRecommendations:[],urgentActions:0};const t=Math.round(a.reduce((d,m)=>d+m.adherencePercentage,0)/a.length),n=a.filter(d=>d.riskLevel!=="low").length,r=a.reduce((d,m)=>(d[m.riskLevel]++,d),{low:0,moderate:0,high:0,critical:0});let i="low";r.critical>0?i="critical":r.high>0?i="high":r.moderate>0&&(i="moderate");const l=a.flatMap(d=>d.recommendations),o=l.filter(d=>d.priority==="urgent"||d.priority==="high").slice(0,5),c=l.filter(d=>d.priority==="urgent").length;return{overallRisk:i,totalMedications:a.length,medicationsAtRisk:n,avgAdherence:t,topRecommendations:o,urgentActions:c}}}function Zo(){const{reminders:s,medications:a,logs:t,deleteReminder:n,toggleReminderActive:r,snoozeReminder:i}=ae(),[l,o]=I.useState(!1),[c,d]=I.useState(null),[m,x]=I.useState(null),[y,R]=I.useState(!0),k=a.filter(N=>N.isActive),S=s.filter(N=>N.isActive),v=s.filter(N=>!N.isActive),g=I.useMemo(()=>$t.analyzeAdherencePatterns(a,t,30),[a,t]),u=I.useMemo(()=>$t.getAdherenceInsights(g),[g]),f=I.useMemo(()=>$t.generateSmartNotifications(g,a,s),[g,a,s]),b=N=>a.find(C=>C.id===N),h=()=>{d(null),o(!0)},j=N=>{d(N),o(!0)},F=N=>{n(N),x(null),J.success("Reminder deleted successfully")},P=N=>{r(N),J.success("Reminder status updated")},M=(N,C)=>{i(N,C),J.success(`Reminder snoozed for ${C} minutes`)},D=N=>{const C={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return N.length===7?"Daily":N.length===5&&!N.includes("saturday")&&!N.includes("sunday")?"Weekdays":N.length===2&&N.includes("saturday")&&N.includes("sunday")?"Weekends":N.map(p=>C[p]).join(", ")},T=({reminder:N})=>{const C=b(N.medicationId);return C?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${N.isActive?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(rs,{className:`h-6 w-6 ${N.isActive?"text-blue-600":"text-gray-400"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:C.name}),e.jsx("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:C.color}})]}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{children:N.time})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{children:D(N.days)})]}),N.customMessage&&e.jsxs("p",{className:"text-sm text-gray-500 italic",children:['"',N.customMessage,'"']}),N.snoozeUntil&&new Date(N.snoozeUntil)>new Date&&e.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:["Snoozed until ",Os(new Date(N.snoozeUntil))]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>P(N.id),className:Ze("p-2 rounded-lg transition-colors",N.isActive?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"),title:N.isActive?"Disable reminder":"Enable reminder",children:N.isActive?e.jsx(nl,{className:"h-5 w-5"}):e.jsx(al,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>j(N),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Edit reminder",children:e.jsx(ta,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x(N.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete reminder",children:e.jsx(yt,{className:"h-4 w-4"})})]})]}),N.isActive&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Quick snooze:"}),e.jsx("button",{onClick:()=>M(N.id,15),className:"px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"15m"}),e.jsx("button",{onClick:()=>M(N.id,30),className:"px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"30m"}),e.jsx("button",{onClick:()=>M(N.id,60),className:"px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"1h"})]})})]})}):null};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reminders"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your medication reminders and notifications"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs("button",{onClick:h,disabled:k.length===0,className:"btn-primary inline-flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Reminder"})]})})]}),g.length>0&&y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-8 h-8 rounded-md flex items-center justify-center ${u.overallRisk==="critical"?"bg-red-100":u.overallRisk==="high"?"bg-orange-100":u.overallRisk==="moderate"?"bg-yellow-100":"bg-green-100"}`,children:e.jsx(Ce,{className:`h-5 w-5 ${u.overallRisk==="critical"?"text-red-600":u.overallRisk==="high"?"text-orange-600":u.overallRisk==="moderate"?"text-yellow-600":"text-green-600"}`})})}),e.jsx("div",{className:"ml-4 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Adherence Risk"}),e.jsx("dd",{className:`text-lg font-medium ${u.overallRisk==="critical"?"text-red-600":u.overallRisk==="high"?"text-orange-600":u.overallRisk==="moderate"?"text-yellow-600":"text-green-600"}`,children:u.overallRisk.charAt(0).toUpperCase()+u.overallRisk.slice(1)})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center",children:e.jsx(hn,{className:"h-5 w-5 text-blue-600"})})}),e.jsx("div",{className:"ml-4 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Adherence"}),e.jsxs("dd",{className:"text-lg font-medium text-gray-900",children:[u.avgAdherence,"%"]})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-md flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-orange-600"})})}),e.jsx("div",{className:"ml-4 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"At Risk Meds"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:u.medicationsAtRisk})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-md flex items-center justify-center",children:e.jsx($s,{className:"h-5 w-5 text-red-600"})})}),e.jsx("div",{className:"ml-4 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Urgent Actions"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:u.urgentActions})]})})]})})})]}),f.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center space-x-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{children:"Smart Adherence Insights"})]}),e.jsx("button",{onClick:()=>R(!1),className:"text-sm text-gray-500 hover:text-gray-700",children:"Hide"})]})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-3",children:[f.slice(0,3).map(N=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${N.priority==="high"?"border-red-500 bg-red-50":N.priority==="medium"?"border-orange-500 bg-orange-50":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[N.type==="predictive-reminder"&&e.jsx(X,{className:"h-5 w-5 text-red-500 mt-0.5"}),N.type==="adherence-support"&&e.jsx(Se,{className:"h-5 w-5 text-orange-500 mt-0.5"}),N.type==="pattern-alert"&&e.jsx(Oe,{className:"h-5 w-5 text-blue-500 mt-0.5"}),N.type==="encouragement"&&e.jsx(_e,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`text-sm font-medium ${N.priority==="high"?"text-red-800":N.priority==="medium"?"text-orange-800":"text-blue-800"}`,children:N.title}),e.jsx("p",{className:`mt-1 text-sm ${N.priority==="high"?"text-red-700":N.priority==="medium"?"text-orange-700":"text-blue-700"}`,children:N.message}),N.context&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[N.context.riskScore&&`Risk Score: ${N.context.riskScore}%`,N.context.missedCount&&`Consecutive Missed: ${N.context.missedCount}`,N.context.pattern&&`Pattern: ${N.context.pattern}`]})]})]})},N.id)),f.length>3&&e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-500",children:[f.length-3," more insights available"]})})]})})]}),u.topRecommendations.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center space-x-2",children:[e.jsx(mn,{className:"h-5 w-5 text-yellow-600"}),e.jsx("span",{children:"Personalized Recommendations"})]})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-3",children:u.topRecommendations.map((N,C)=>e.jsx("div",{className:`p-3 rounded border-l-4 ${N.priority==="urgent"?"border-red-500 bg-red-50":N.priority==="high"?"border-orange-500 bg-orange-50":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${N.priority==="urgent"?"bg-red-100 text-red-800":N.priority==="high"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:N.type.replace("-"," ")}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${N.priority==="urgent"?"bg-red-200 text-red-900":N.priority==="high"?"bg-orange-200 text-orange-900":"bg-blue-200 text-blue-900"}`,children:N.priority})]}),e.jsx("p",{className:`mt-2 text-sm font-medium ${N.priority==="urgent"?"text-red-800":N.priority==="high"?"text-orange-800":"text-blue-800"}`,children:N.message}),N.details&&e.jsx("p",{className:`mt-1 text-xs ${N.priority==="urgent"?"text-red-600":N.priority==="high"?"text-orange-600":"text-blue-600"}`,children:N.details})]}),N.actionable&&e.jsx(_e,{className:"h-4 w-4 text-green-500 mt-1"})]})},C))})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Medication Adherence Patterns"})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"space-y-4",children:g.map(N=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:N.medicationName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${N.adherencePercentage>=95?"bg-green-100 text-green-800":N.adherencePercentage>=85?"bg-yellow-100 text-yellow-800":N.adherencePercentage>=70?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:[N.adherencePercentage,"% adherence"]}),e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${N.riskLevel==="critical"?"bg-red-100 text-red-800":N.riskLevel==="high"?"bg-orange-100 text-orange-800":N.riskLevel==="moderate"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[N.riskLevel," risk"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Miss Pattern:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:N.missedDosePattern})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Miss Risk:"}),e.jsxs("span",{className:`ml-2 font-medium ${N.predictedMissRisk>=70?"text-red-600":N.predictedMissRisk>=40?"text-orange-600":"text-green-600"}`,children:[N.predictedMissRisk,"%"]})]}),N.consecutiveMissedDoses>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Consecutive Missed:"}),e.jsx("span",{className:"ml-2 text-red-600 font-medium",children:N.consecutiveMissedDoses})]}),N.frequentMissTimeSlots.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Problem Times:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:N.frequentMissTimeSlots.join(", ")})]})]})]},N.medicationId))})})]})]}),g.length>0&&!y&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Smart Adherence Insights Available"})]}),e.jsx("button",{onClick:()=>R(!0),className:"px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Show Insights"})]})})}),k.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rs,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No active medications"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add some medications first to create reminders."})]}),s.length===0&&k.length>0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rs,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No reminders yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create your first reminder to stay on track with your medications."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:h,className:"btn-primary inline-flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Add First Reminder"})]})})]}),S.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:["Active Reminders (",S.length,")"]}),e.jsx("div",{className:"space-y-4",children:S.map(N=>e.jsx(T,{reminder:N},N.id))})]}),v.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:["Inactive Reminders (",v.length,")"]}),e.jsx("div",{className:"space-y-4",children:v.map(N=>e.jsx(T,{reminder:N},N.id))})]}),e.jsx(Jo,{isOpen:l,onClose:()=>{o(!1),d(null)},reminder:c}),e.jsx(da,{isOpen:!!m,onClose:()=>x(null),onConfirm:()=>m&&F(m),title:"Delete Reminder",message:"Are you sure you want to delete this reminder? This action cannot be undone.",confirmText:"Delete"})]})}function Qo(){const{medications:s,logs:a,getMissedDoses:t}=ae(),[n,r]=I.useState("adherence"),[i,l]=I.useState({start:new Date(Date.now()-30*24*60*60*1e3),end:new Date}),o=()=>s.map(f=>{const b=a.filter(P=>P.medicationId===f.id&&new Date(P.timestamp)>=i.start&&new Date(P.timestamp)<=i.end),h=b.length,j=b.filter(P=>P.adherence==="taken").length,F=b.filter(P=>P.adherence==="missed").length;return{medicationId:f.id,medicationName:f.name,totalDoses:h,takenDoses:j,missedDoses:F,adherencePercentage:h>0?Math.round(j/h*100):0,period:{start:i.start,end:i.end}}}).filter(f=>f.totalDoses>0),c=()=>{const f=new Map;return a.forEach(b=>{const h=s.find(j=>j.id===b.medicationId);!h||!b.sideEffectsReported||b.sideEffectsReported.forEach(j=>{const F=`${h.name}-${j}`;f.has(F)||f.set(F,{medication:h.name,effect:j,dates:[]}),f.get(F).dates.push(new Date(b.timestamp))})}),Array.from(f.entries()).map(([,b])=>{var h;return{medicationId:((h=s.find(j=>j.name===b.medication))==null?void 0:h.id)||"",medicationName:b.medication,sideEffect:b.effect,frequency:b.dates.length,severity:"mild",reportedDates:b.dates}})},d=o(),m=c(),x=s.filter(f=>f.isActive).length,y=d.length>0?Math.round(d.reduce((f,b)=>f+b.adherencePercentage,0)/d.length):0,R=t(30).length,k=m.reduce((f,b)=>f+b.frequency,0),S=()=>{if(d.length===0){J.error("No adherence data available for the selected period");return}const f=Ps(d.map(b=>({medication:b.medicationName,total_doses:b.totalDoses,taken_doses:b.takenDoses,missed_doses:b.missedDoses,adherence_percentage:b.adherencePercentage,period_start:te(b.period.start),period_end:te(b.period.end)})));Xs(f,`adherence-report-${te(new Date,"yyyy-MM-dd")}.csv`,"text/csv"),J.success("Adherence report exported successfully")},v=()=>{if(m.length===0){J.error("No side effects data available");return}const f=Ps(m.map(b=>({medication:b.medicationName,side_effect:b.sideEffect,frequency:b.frequency,severity:b.severity,first_reported:te(b.reportedDates[0]),last_reported:te(b.reportedDates[b.reportedDates.length-1])})));Xs(f,`side-effects-report-${te(new Date,"yyyy-MM-dd")}.csv`,"text/csv"),J.success("Side effects report exported successfully")},g=()=>{Xs(JSON.stringify({generatedDate:new Date,dateRange:i,summary:{totalMedications:x,overallAdherence:y,missedDoses:R,totalSideEffects:k},adherenceData:d,sideEffectsData:m},null,2),`summary-report-${te(new Date,"yyyy-MM-dd")}.json`,"application/json"),J.success("Summary report exported as JSON")},u=({name:f,icon:b,isActive:h,onClick:j})=>e.jsxs("button",{onClick:j,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${h?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:f})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reports"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Generate and export detailed medication reports"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[e.jsx("input",{type:"date",value:i.start.toISOString().split("T")[0],onChange:f=>l(b=>({...b,start:new Date(f.target.value)})),className:"px-3 py-2 border border-gray-300 rounded-md text-sm"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:i.end.toISOString().split("T")[0],onChange:f=>l(b=>({...b,end:new Date(f.target.value)})),className:"px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-blue-500 rounded-md p-3",children:e.jsx(Pe,{className:"h-6 w-6 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Medications"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:x})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-green-500 rounded-md p-3",children:e.jsx(_e,{className:"h-6 w-6 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Overall Adherence"}),e.jsxs("dd",{className:"text-lg font-medium text-gray-900",children:[y,"%"]})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-red-500 rounded-md p-3",children:e.jsx($s,{className:"h-6 w-6 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Missed Doses (30d)"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:R})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-orange-500 rounded-md p-3",children:e.jsx(X,{className:"h-6 w-6 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Side Effects"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:k})]})})]})})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{name:"Adherence",icon:fs,isActive:n==="adherence",onClick:()=>r("adherence")}),e.jsx(u,{name:"Side Effects",icon:X,isActive:n==="side-effects",onClick:()=>r("side-effects")}),e.jsx(u,{name:"Summary",icon:vs,isActive:n==="summary",onClick:()=>r("summary")})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[n==="adherence"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Adherence Report"}),e.jsxs("button",{onClick:S,className:"btn-secondary inline-flex items-center space-x-2",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Export CSV"})]})]}),d.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(fs,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No data available"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No medication logs found for the selected date range."})]}):e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Medication"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Doses"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taken"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Missed"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Adherence"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(f=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:f.medicationName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.totalDoses}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:f.takenDoses}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:f.missedDoses}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.adherencePercentage>=90?"bg-green-100 text-green-800":f.adherencePercentage>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[f.adherencePercentage,"%"]})})]},f.medicationId))})]})})]}),n==="side-effects"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Side Effects Report"}),e.jsxs("button",{onClick:v,className:"btn-secondary inline-flex items-center space-x-2",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Export CSV"})]})]}),m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(X,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No side effects reported"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No side effects have been logged for your medications."})]}):e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Medication"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Side Effect"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Frequency"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"First Reported"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Reported"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((f,b)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:f.medicationName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.sideEffect}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.frequency}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te(f.reportedDates[0])}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te(f.reportedDates[f.reportedDates.length-1])})]},b))})]})})]}),n==="summary"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Summary Report"}),e.jsxs("button",{onClick:g,className:"btn-secondary inline-flex items-center space-x-2",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Export Summary"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Report Period"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsxs("span",{children:[te(i.start)," - ",te(i.end)]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Key Insights"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Best Adherence:"}),e.jsx("span",{className:"font-medium",children:d.length>0?d.reduce((f,b)=>b.adherencePercentage>f.adherencePercentage?b:f).medicationName:"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Most Common Side Effect:"}),e.jsx("span",{className:"font-medium",children:m.length>0?m.reduce((f,b)=>b.frequency>f.frequency?b:f).sideEffect:"None reported"})]})]})]})]})]})]})})]})}function Xo(){var D,T,N;const{userProfile:s,updateProfile:a,createProfile:t,medications:n}=ae(),[r,i]=I.useState(!s),[l,o]=I.useState(""),[c,d]=I.useState(""),{register:m,handleSubmit:x,formState:{errors:y},setValue:R,watch:k,reset:S}=jt({defaultValues:s||{name:"",dateOfBirth:void 0,allergies:[],conditions:[],emergencyContact:{name:"",relationship:"",phone:"",email:""},preferences:{theme:"system",notifications:{push:!0,sound:!0,vibration:!0,reminderAdvance:15},privacy:{shareData:!1,analytics:!0},display:{timeFormat:"12h",dateFormat:"MM/DD/YYYY",defaultView:"dashboard"}}}}),v=k("allergies")||[],g=k("conditions")||[],u=n.filter(C=>C.isActive&&(C.riskLevel==="high"||C.riskLevel==="moderate")),f=n.reduce((C,p)=>(C[p.category]=(C[p.category]||0)+1,C),{});I.useEffect(()=>{s&&S(s)},[s,S]);const b=C=>{s?(a(C),J.success("Profile updated successfully")):(t(C),J.success("Profile created successfully")),i(!1)},h=()=>{l.trim()&&(R("allergies",[...v||[],l.trim()]),o(""))},j=C=>{R("allergies",(v||[]).filter((E,U)=>U!==C))},F=()=>{c.trim()&&(R("conditions",[...g||[],c.trim()]),d(""))},P=C=>{R("conditions",(g||[]).filter((E,U)=>U!==C))},M=()=>{s&&(S(s),i(!1))};return!r&&s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Health Profile"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Your personal health information and emergency contacts"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs("button",{onClick:()=>i(!0),className:"btn-primary inline-flex items-center space-x-2",children:[e.jsx(ta,{className:"h-4 w-4"}),e.jsx("span",{children:"Edit Profile"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ot,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Personal Information"})]})}),e.jsxs("div",{className:"card-content p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:te(s.dateOfBirth)!=="N/A"?te(s.dateOfBirth):"Not provided"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allergies"}),s.allergies&&s.allergies.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.allergies.map((C,p)=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-red-100 text-red-800",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),C]},p))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No allergies reported"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medical Conditions"}),s.conditions&&s.conditions.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.conditions.map((C,p)=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),C]},p))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No medical conditions reported"})]})]})]}),e.jsxs("div",{className:"card mt-6",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Emergency Contact"})]})}),e.jsx("div",{className:"card-content p-6",children:s.emergencyContact&&s.emergencyContact.name?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.emergencyContact.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Relationship"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.emergencyContact.relationship})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[e.jsx(Xr,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.emergencyContact.phone})]})]}),s.emergencyContact.email&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[e.jsx(Gr,{className:"h-4 w-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.emergencyContact.email})]})]})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"No emergency contact information provided"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Medication Summary"})}),e.jsx("div",{className:"card-content p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Active"}),e.jsx("span",{className:"text-sm font-medium",children:n.filter(C=>C.isActive).length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"High Risk"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:u.length})]}),Object.entries(f).length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"By Category"}),e.jsx("div",{className:"space-y-2",children:Object.entries(f).map(([C,p])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600 capitalize",children:C.replace("-"," ")}),e.jsx("span",{className:"text-xs font-medium",children:p})]},C))})]})]})})]}),(((D=s.allergies)==null?void 0:D.length)||u.length)&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Health Alerts"})}),e.jsx("div",{className:"card-content p-6",children:e.jsxs("div",{className:"space-y-3",children:[s.allergies&&s.allergies.length>0&&e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-50 rounded-lg",children:[e.jsx(X,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Known Allergies"}),e.jsxs("p",{className:"text-xs text-red-600",children:[s.allergies.length," allergy(ies) on file"]})]})]}),u.length>0&&e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-orange-50 rounded-lg",children:[e.jsx(Ce,{className:"h-5 w-5 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-800",children:"High-Risk Medications"}),e.jsxs("p",{className:"text-xs text-orange-600",children:[u.length," medication(s) require monitoring"]})]})]})]})})]})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[s?"Edit":"Create"," Health Profile"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s?"Update your personal health information":"Set up your personal health information and emergency contacts"})]})}),e.jsxs("form",{onSubmit:x(b),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ot,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Personal Information"})]})}),e.jsxs("div",{className:"card-content p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name *"}),e.jsx("input",{type:"text",...m("name",{required:"Name is required"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"Your full name"}),y.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),e.jsx("input",{type:"date",...m("dateOfBirth"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allergies"}),e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("input",{type:"text",value:l,onChange:C=>o(C.target.value),placeholder:"Add an allergy",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",onKeyPress:C=>C.key==="Enter"&&(C.preventDefault(),h())}),e.jsx("button",{type:"button",onClick:h,className:"btn-secondary inline-flex items-center",children:e.jsx(Ae,{className:"h-4 w-4"})})]}),v&&v.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:v.map((C,p)=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-red-100 text-red-800",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),C,e.jsx("button",{type:"button",onClick:()=>j(p),className:"ml-1 text-red-600 hover:text-red-800",children:e.jsx(ce,{className:"h-3 w-3"})})]},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medical Conditions"}),e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("input",{type:"text",value:c,onChange:C=>d(C.target.value),placeholder:"Add a medical condition",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",onKeyPress:C=>C.key==="Enter"&&(C.preventDefault(),F())}),e.jsx("button",{type:"button",onClick:F,className:"btn-secondary inline-flex items-center",children:e.jsx(Ae,{className:"h-4 w-4"})})]}),g&&g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((C,p)=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),C,e.jsx("button",{type:"button",onClick:()=>P(p),className:"ml-1 text-blue-600 hover:text-blue-800",children:e.jsx(ce,{className:"h-3 w-3"})})]},p))})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Emergency Contact"})]})}),e.jsxs("div",{className:"card-content p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Name"}),e.jsx("input",{type:"text",...m("emergencyContact.name"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"Emergency contact's name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Relationship"}),e.jsx("input",{type:"text",...m("emergencyContact.relationship"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"e.g., Spouse, Parent, Sibling"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),e.jsx("input",{type:"tel",...m("emergencyContact.phone",{validate:C=>!C||ll(C)||"Please enter a valid phone number"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"Phone number"}),((T=y.emergencyContact)==null?void 0:T.phone)&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.emergencyContact.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email (Optional)"}),e.jsx("input",{type:"email",...m("emergencyContact.email",{validate:C=>!C||rl(C)||"Please enter a valid email address"}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"email@example.com"}),((N=y.emergencyContact)==null?void 0:N.email)&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.emergencyContact.email.message})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[s&&e.jsx("button",{type:"button",onClick:M,className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary inline-flex items-center space-x-2",children:[e.jsx(aa,{className:"h-4 w-4"}),e.jsxs("span",{children:[s?"Update":"Create"," Profile"]})]})]})]})]})}function ec(){const{userProfile:s}=ae();return I.useEffect(()=>{},[s]),e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx(ao,{children:e.jsxs($i,{children:[e.jsx(De,{path:"/",element:e.jsx(Na,{to:"/dashboard",replace:!0})}),e.jsx(De,{path:"/dashboard",element:e.jsx(oo,{})}),e.jsx(De,{path:"/medications",element:e.jsx(Uo,{})}),e.jsx(De,{path:"/inventory",element:e.jsx(_o,{})}),e.jsx(De,{path:"/calendar",element:e.jsx(Vo,{})}),e.jsx(De,{path:"/analytics",element:e.jsx(Bo,{})}),e.jsx(De,{path:"/settings",element:e.jsx(Go,{})}),e.jsx(De,{path:"/reminders",element:e.jsx(Zo,{})}),e.jsx(De,{path:"/reports",element:e.jsx(Qo,{})}),e.jsx(De,{path:"/profile",element:e.jsx(Xo,{})}),e.jsx(De,{path:"*",element:e.jsx(Na,{to:"/dashboard",replace:!0})})]})})})}zt.createRoot(document.getElementById("root")).render(e.jsx(I.StrictMode,{children:e.jsxs(Bi,{children:[e.jsx(ec,{}),e.jsx(Ur,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#22c55e",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})}));
//# sourceMappingURL=index-67eb2acf.js.map
